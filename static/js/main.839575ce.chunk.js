(this["webpackJsonpsisl-gui-ui"]=this["webpackJsonpsisl-gui-ui"]||[]).push([[0],{1238:function(e,t,n){"use strict";n.r(t);var s=n(1),i=n.n(s),o=n(25),a=n.n(o),c=(n(521),n(522),n(523),n(118)),r=n(255),l=n(254),u="ADD_PLOTS",d="REMOVE_PLOT",p="SET_STRUCTURES",b="SET_PLOTABLES",j="SET_ACTIVE_PLOT",h="SET_ACTIVE_TAB",f="SET_SESSION",O="CLEAR_SESSION",g="START_LOADING_PLOT",v="END_LOADING_PLOT",m="SET_ACTIVE_PAGE",y={},x=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return t.session;case O:return y;default:return e}},S=n(7),C=n(21),P=n.n(C),T={},k=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:T,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case u:return console.log("REDUX: Storing a new plot..."),e=Object(S.a)(Object(S.a)({},t),n.newPlots),console.log(e),e;case d:return P.a.omit(t,[n.plotID]);case O:return T;default:return t}},w={plot:void 0,tab:void 0,structs:[],plotables:[],page:"plots"},_=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:w,n=arguments.length>1?arguments[1]:void 0;switch(n.type){case j:return console.log("REDUX: Setting active plot..."),e=Object(S.a)(Object(S.a)({},t),{},{plot:n.plotID}),console.log(e),e;case h:return console.log("REDUX: Setting active tab..."),e=Object(S.a)(Object(S.a)({},t),{},{tab:n.activeTab}),console.log(e),e;case f:var s=P.a.find(n.session.tabs,["id",t.tab]),i=n.session.tabs.length>0;return s?t:i?Object(S.a)(Object(S.a)({},t),{},{tab:n.session.tabs[0].id}):Object(S.a)(Object(S.a)({},t),{},{tab:null});case p:return Object(S.a)(Object(S.a)({},t),{},{structs:[]});case m:return e=Object(S.a)(Object(S.a)({},t),{},{page:n.pageName});case b:return Object(S.a)(Object(S.a)({},t),{},{plotables:[]});case O:return w;default:return t}},E=n(15),A=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{plots:{}},n=arguments.length>1?arguments[1]:void 0;switch(n.type){case g:return console.log("REDUX: Setting active plot..."),e=Object(S.a)(Object(S.a)({},t),{},{plots:Object(S.a)(Object(S.a)({},t.plots),{},Object(E.a)({},n.plot.id,Object(S.a)(Object(S.a)({},n.plot),{},{from:new Date})))}),console.log(e),e;case v:return console.log("REDUX: Changing plot settings (not submitting yet)..."),e=Object(S.a)(Object(S.a)({},t),{},{plots:P.a.omit(t.plots,[n.plotID])}),console.log(e),e;default:return t}},I=n(469),N=n.n(I);function L(e,t,n){return Object(l.a)({key:e,storage:N.a,whitelist:t},n)}var D=Object(c.a)({session:x,plots:k,loading:L("loading",["plots"],A),active:L("active",["tab","plot"],_),browser:Object(r.a)({small:600,medium:992})}),R=function(e){return e.plots[e.active.plot]},M=function(){var e=Object(c.b)(D,r.b);return{store:e,persistor:Object(l.b)(e)}},G=n(31),F=n(471),z=n(22),B=n(498),U=n(1313),W=n(1310),H=n(1312),V=n(19),q=n(5),K=n(6),Y=n(8),X=n(9),J=n(472),Z=n.n(J),$=n(1300),Q=n(79),ee=n(135),te=n(35),ne=n(0),se=n(114),ie=function(e,t){return{type:u,newPlots:e,tabsIDs:t}},oe=function(e){return{type:"SET_SESSION_TABS",tabs:e}},ae=function(e){return{type:j,plotID:e?"string"==typeof e?e:e.id:void 0}},ce=function(e){return{type:h,activeTab:e}},re=function(e){return{type:m,pageName:e}},le=n(473),ue=n.n(le),de=n(102),pe=n(1315),be=n(1311),je=n(3),he=function(e){var t=e.value||"";return Object(je.jsx)(be.a,Object(S.a)({variant:"outlined",value:t,onChange:function(t){return e.onChange(t.target.value)},label:e.label,style:Object(S.a)({width:"100%"},e.style)},e.inputField?e.inputField.params:{}))},fe=n(1299),Oe=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;return Object(q.a)(this,n),(s=t.call(this,e)).state={value:""},e.controlClose&&e.controlClose(e.closeToast),s}return Object(K.a)(n,[{key:"componentWillUnmount",value:function(){this.props.callback(this.state.value)}},{key:"render",value:function(){var e=this;return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:this.props.content}),Object(je.jsx)(he,{value:this.state.value,onChange:function(t){e.setState({value:t})},label:this.props.inputProps.label}),Object(je.jsx)(fe.a,{onClick:this.props.closeToast,children:"Submit"})]})}}]),n}(s.Component),ge=function(e,t,n){Object(de.b)(Object(je.jsx)(Oe,Object(S.a)({content:e,callback:t},n)),{autoClose:!1,closeOnClick:!1,onClose:function(e){console.warn(e)}})},ve=ge,me=new function e(){var t=this;Object(q.a)(this,e),this.connect=function(e){e&&(t.apiAddress=e),t.externalListeners={},t.socket=ue()(t.apiAddress),t.listeners.forEach((function(e){var n;return(n=t.socket).on.apply(n,Object(V.a)(e))})),t.connectionTimeOut=setTimeout((function(){var e,n,s;e=t.apiAddress,n=function(e){e&&(t.apiAddress=e.trim()),t.socket.connected||(t.disconnect(),t.connect())},s={controlClose:function(e){return t.onConnect(e)}},ge(Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{children:"Couldn't connect to "+e}),Object(je.jsx)("div",{children:"Do you want to specify a different address for the API?"}),Object(je.jsx)("div",{children:" (http(s)://host:port)"})]}),n,Object(S.a)({inputProps:{label:"New address"}},s))}),3e3),t.socket.connect()},this.disconnect=function(){t.socket.disconnect()},this.on=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];var i;t.socket&&(i=t.socket).on.apply(i,n);t.listeners.push(n)},this.onConnect=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];t.on.apply(t,["connect"].concat(n))},this.onDisconnect=function(){for(var e=arguments.length,n=new Array(e),s=0;s<e;s++)n[s]=arguments[s];t.on.apply(t,["disconnect"].concat(n))},this.setupListeners=function(){t.on("connect",(function(){clearTimeout(t.connectionTimeOut),t.requestSession()})),t.on("disconnect",(function(e){console.warn(e),t.disconnect(),t.connect()})),t.on("auth_required",t.askForAuth),t.on("logged_in",t.requestSession),t.on("error",(function(e){return t.handleError(e,"socket")})),t.on("server_error",(function(e){return t.handleError(e,"server")})),t.on("current_session",(function(e){console.error(e),document.dispatchEvent(new CustomEvent("syncWithSession",{detail:{session:e}}))})),t.on("loading_plot",(function(e){document.dispatchEvent(new CustomEvent("loadingPlot",{detail:e}))})),t.on("plot",(function(e){document.dispatchEvent(new CustomEvent("plot",{detail:{plot:e}}))}))},this.handleError=function(e,t){"server"===t?de.b.error("THERE WAS A PYTHON ERROR:\n"+e):de.b.error(e)},this.askForAuth=function(){t.authenticating||(t.authenticating=!0,ve((function(e){t.socket.emit("login",e),t.authenticating=!1})))},this.requestSession=function(e){t.socket.emit("request_session",e)},this.loadSession=function(e){t.requestSession(e)},this.loadSessionFromFile=function(e){t.socket.emit("load_session_from_file",e,e.name)},this.getSessionFile=function(e){t.socket.once("session_file",(function(t){e(t)})),t.socket.emit("get_session_file")},this.newProcessId=pe.a,this._sessionMethod=function(e,n,s){for(var i,o=arguments.length,a=new Array(o>3?o-3:0),c=3;c<o;c++)a[c-3]=arguments[c];(i=t.socket).emit.apply(i,["apply_method_on_session",e,n].concat(a))},this.callSessionShortcut=function(e){t._sessionMethod("call_shortcut",null,null,e)},this.updateSessionSettings=function(e){t._sessionMethod("update_settings",e)},this.undoSessionSettings=function(){t._sessionMethod("undo_settings")},this.addTab=function(e){t._sessionMethod("add_tab",{name:e})},this.removeTab=function(e){t._sessionMethod("remove_tab",{tabID:e})},this.updateTab=function(e,n){t._sessionMethod("update_tab",{tabID:e,newParams:n})},this.setTabLayouts=function(e,n){t.updateTab(e,{layouts:n})},this.saveSession=function(e){t._sessionMethod("save",{path:e})},this.getPlot=function(e){document.dispatchEvent(new CustomEvent("updatingPlot",{detail:{plot_id:e}})),t.socket.emit("get_plot",e)},this.newPlot=function(e){t._sessionMethod("new_plot",e)},this.removePlot=function(e){t._sessionMethod("remove_plot",null,null,e)},this.movePlot=function(e,n){t._sessionMethod("move_plot",null,null,e,n)},this.mergePlots=function(e,n){t._sessionMethod("merge_plots",{to:n},null,e)},this._plotMethod=function(e,n,s,i){for(var o=arguments.length,a=new Array(o>4?o-4:0),c=4;c<o;c++)a[c-4]=arguments[c];t._sessionMethod.apply(t,["_run_plot_method",s,i,e,n].concat(a))},this.showPlotFullScreen=function(e){t._plotMethod(e,"show")},this.updatePlotSettings=function(e,n){t._plotMethod(e,"update_settings",n)},this.undoPlotSettings=function(e){t._plotMethod(e,"undo_settings")},this.updatePlotLayout=function(e,n){t._plotMethod(e,"update_layout",n)},this.updateFigure=function(e,n){var s=n.layout,i=n.data,o=n.frames,a=n.overwrite;t._plotMethod(e,"update",{layout:s,data:i,frames:o,overwrite:a})},this.callPlotShortcut=function(e,n){t._plotMethod(e,"call_shortcut",null,null,n)},this.dispatchPlotEvent=function(e,n,s){t._plotMethod(e,"dispatch_event",s,null,n)},this.savePlot=function(e,n){t._plotMethod(e,"save",{path:n})},this.plotFile=function(e){t.socket.emit("plot_file",e,e.name)},this.apiAddress="http://localhost:4000",this.user=void 0,this.listeners=[],this.setupListeners(),this.connect(),document.api=this},ye=n(97),xe={SHOW_AVAIL_HOTKEYS:{name:"Show available hotkeys",sequence:"shift+?"},GO_TO_SETTINGS:{name:"Go to settings",sequence:"shift+s"},GO_TO_DASHBOARD:{name:"Go to the plot's dashboard",sequence:"shift+d"},GO_TO_MOLECULEVIEWER:{name:"Go to the molecule viewer",sequence:"shift+m"},SAVE_SESSION:{name:"Save session",sequences:["ctrl+shift+s","ctrl+alt+s"]},LOAD_SESSION:{name:"Load session",sequences:["ctrl+shift+l","ctrl+alt+l"]}},Se={global:{MOVE_TO_NEXT_TAB:{name:"Move to next tab",sequence:"shift+t+right"},MOVE_TO_PREVIOUS_TAB:{name:"Move to previous tab",sequence:"shift+t+left"},NEW_TAB:{name:"New tab",sequence:"shift+t",action:"keyup"},TRY:"shift+t+r"}},Ce={GO_TO_PLOT_SETTINGSEDITING:{name:"Edit current plot's settings",sequence:"s"},GO_TO_PLOT_LAYOUTEDITING:{name:"Edit current plot's layout",sequence:"e"},GO_TO_PLOT_METHODS:{name:"Go to current plot methods",sequence:"m"},FULL_SCREEN:{name:"See current plot in full screen in a different browser's tab",sequence:"f"},REMOVE_PLOT:{name:"Remove current plot",sequences:["del","backspace"]},UNDO_PLOT_SETTINGS:{name:"Undo current plot settings",sequence:"ctrl+z"}},Pe=n(1245),Te=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;return Object(q.a)(this,n),(s=t.call(this,e)).hotKeys=function(){return document.querySelectorAll(".plotCardHotKeys")},s.hotKeysHandlers={GO_TO_PLOT_LAYOUTEDITING:function(){return s.goToPlotLayoutEditing()},GO_TO_PLOT_SETTINGSEDITING:function(){return s.goToPlotSettingsEditing()},GO_TO_PLOT_METHODS:function(){return s.goToPlotMethods()},FULL_SCREEN:function(){return s.showPlotFullScreen()},UNDO_PLOT_SETTINGS:function(){return s.undoSettings()},REMOVE_PLOT:function(){return s.removePlot()}},s.callPlotShortcut=function(e){de.b.warn("Applying "+s.props.plot.shortcuts[e].name+" shortcut"),me.callPlotShortcut(s.props.plot.id,e)},s.handlePlotClick=function(e){var t=e.points,n=P.a.omit(t[0],["data","fullData","xaxis","yaxis"]);console.warn(n),me.dispatchPlotEvent(s.props.plot.id,"click",n)},s.handlePlotRelayout=function(e){if(!e["scene.camera"]){var t=Object.keys(e);t.includes("autosize")||0!==t.length&&me.updatePlotLayout(s.props.plot.id,e)}},s.undoSettings=function(){me.undoPlotSettings(s.props.plot.id)},s.removePlot=function(){me.removePlot(s.props.plot.id)},s.goToPlotSettingsEditing=function(){s.setPlotAsActive(),s.props.setActivePage("plotTweaking")},s.goToPlotLayoutEditing=function(){s.setPlotAsActive(),s.props.setActivePage("plotLayoutEditor")},s.goToPlotMethods=function(){s.setPlotAsActive(),s.props.setActivePage("plotMethods")},s.setPlotAsActive=function(){s.props.setActivePlot(s.props.plot)},s.togglePlotAsActive=function(){s.isActivePlot?s.props.setActivePlot(void 0):s.setPlotAsActive()},s.savePlot=function(){var e=prompt("Please provide the path to save the plot.\n\nRoot directory:\n"+s.props.session.settings.rootDir);e&&me.savePlot(s.props.plot.id,e)},s.showPlotFullScreen=function(){me.showPlotFullScreen(s.props.plot.id)},s.state={isLoading:!1,editable:!1},s}return Object(K.a)(n,[{key:"componentDidMount",value:function(){var e=this;document.addEventListener("plotResize",(function(t){t.detail.id!==e.props.plot.id&&"all"!==t.detail.id||e.setState({cou:Math.random()})}))}},{key:"isActivePlot",get:function(){return this.props.plot.id===this.props.active.plot}},{key:"render",value:function(){var e=this;if(this.state.isLoading||!this.props.plot)return Object(je.jsx)($.a,{className:"plotcard",style:{borderRadius:15},children:Object(je.jsx)("div",{children:"We are working hard to load your plot."})});if(!this.props.plot.figure)return Object(je.jsx)($.a,{className:"plotcard",style:{borderRadius:15},children:Object(je.jsx)("div",{children:"A figure could not be generated for this plot."})});var t=this.props.plot.figure.layout,n=t.paper_bgcolor||"white",s=Object(S.a)(Object(S.a)({},Ce),{},{TESTING:"shift+r"},Object.keys(this.props.plot.shortcuts).reduce((function(t,n){var s=e.props.plot.shortcuts[n];return["ctrl+z","ctrl+alt+l"].includes(n)||(t[s.name.replace(/ /g,"_")]=Object(S.a)({sequence:n},s)),t}),{})),i=Object(S.a)(Object(S.a)({},this.hotKeysHandlers),Object.keys(this.props.plot.shortcuts).reduce((function(t,n){var s=e.props.plot.shortcuts[n];return["ctrl+z","ctrl+alt+l"].includes(n)||(t[s.name.replace(/ /g,"_")]=function(){return e.callPlotShortcut(n)}),t}),{})),o=(this.isActivePlot,{});return Object(je.jsxs)(ye.HotKeys,{className:"plotCardHotKeys",component:$.a,elevation:this.props.elevation||1,keyMap:s,handlers:i,allowChanges:!0,style:Object(S.a)(Object(S.a)({width:"100%",height:"100%",display:"flex",flexDirection:"column",borderRadius:3,overflow:"hidden",background:n,paddingTop:5},o),this.props.style),children:[Object(je.jsx)("div",{style:{flex:1},children:Object(je.jsx)(Z.a,{ref:function(t){e.plotlyRef=t},useResizeHandler:!0,style:{width:"100%",height:"100%"},data:this.props.plot.figure.data,layout:Object(S.a)({autosize:!0,title:""},t),frames:this.props.plot.figure.frames,onClick:this.handlePlotClick,onRelayout:this.handlePlotRelayout,onUpdate:function(e){},config:{editable:this.state.editable,responsive:!0}})}),Object(je.jsxs)("div",{style:{display:"flex",paddingLeft:10,paddingRight:20,background:n,marginBottom:5},className:"card-action",children:[Object(je.jsxs)(ne.b.Provider,{value:{size:25,style:{margin:5},color:"#6eb6ff"},children:[Object(je.jsx)("div",{style:{flex:1,textAlign:"left"},children:Object(je.jsx)(Pe.a,{size:"small","data-tip":"Full screen (f)",onClick:this.showPlotFullScreen,children:Object(je.jsx)(Q.d,{})})}),Object(je.jsxs)("div",{children:[Object(je.jsx)(Pe.a,{size:"small","data-tip":"Settings (s)",onClick:this.goToPlotSettingsEditing,children:Object(je.jsx)(te.l,{})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Methods (m)",onClick:this.goToPlotMethods,children:Object(je.jsx)(ee.b,{})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Editable",onClick:function(){return e.setState({editable:!e.state.editable})},children:Object(je.jsx)(te.l,{})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Edit layout (e)",onClick:this.goToPlotLayoutEditing,children:Object(je.jsx)(Q.b,{})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Save plot (coming soon)",children:Object(je.jsx)(ee.c,{color:"#ccc"})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Export data (coming soon)",children:Object(je.jsx)(Q.c,{color:"#ccc"})}),Object(je.jsx)(Pe.a,{size:"small","data-tip":"Remove (supr)",onClick:this.removePlot,children:Object(je.jsx)(Q.a,{color:"red"})})]})]}),Object(je.jsx)(se.a,{effect:"solid",place:"bottom",disable:!!this.props.session.settings&&!this.props.session.settings.showTooltips})]})]})}}]),n}(s.Component),ke={setSessionTabs:oe,setActivePlot:ae,removePlot:function(e,t){return{type:d,plotID:e,tabID:t}},setActivePage:re,addPlots:ie},we=Object(G.b)((function(e){return{plots:e.plots,active:e.active,session:e.session}}),ke)(Te),_e=n(320),Ee=n(1244),Ae=(n(574),n(575),n(319)),Ie=function(e){var t=e.placeholder,n=e.onChange,i=e.style,o=Object(s.useCallback)((function(e){return n(e)}),[n]),a=Object(Ae.useDropzone)({onDrop:o}),c=a.getRootProps,r=a.getInputProps;return Object(je.jsxs)("div",Object(S.a)(Object(S.a)({},c()),{},{style:i,children:[Object(je.jsx)("input",Object(S.a)({},r())),Object(je.jsx)("p",{children:t})]}))},Ne=n(1320),Le=n(1321),De=n(1322),Re=n(1301),Me=Object(Re.a)((function(e){return{root:{transform:"translateZ(0px)",flexGrow:1},exampleWrapper:{position:"relative",marginTop:e.spacing(3)},radioGroup:{margin:e.spacing(1,0)},speedDial:{position:"absolute","&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft":{bottom:e.spacing(2),right:e.spacing(2)},"&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight":{top:e.spacing(2),left:e.spacing(2)}}}}));function Ge(e){var t=Me(),n=i.a.useState("left")[0],s=i.a.useState(!1),o=Object(z.a)(s,2),a=o[0],c=o[1],r=i.a.useState(!1)[0];return Object(je.jsx)(Ne.a,{ariaLabel:"SpeedDial example",className:t.speedDial,hidden:r,icon:Object(je.jsx)(Le.a,{}),onClose:function(){c(!1)},onOpen:function(){c(!0)},open:a,direction:n,children:e.actions.map((function(e){return Object(je.jsx)(De.a,{icon:e.icon,tooltipTitle:e.tip||e.name,tooltipPlacement:"top",onClick:e.onClick,href:e.href},e.name)}))})}var Fe=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(q.a)(this,n);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).hotKeysHandler={SAVE_SESSION:function(){return e.saveCurrentSession()},LOAD_SESSION:function(){return e.loadSession()}},e.syncWithSession=function(e){document.dispatchEvent(new CustomEvent("syncWithSession",{detail:{session:e}}))},e.showPage=function(t){e.props.setActivePage(t)},e.saveCurrentSession=function(){var t=prompt("Please provide the path to save the session.\n\nRoot directory:\n"+e.props.session.settings.rootDir);t&&me.saveSession(t)},e.loadSession=function(){var t=prompt("Please provide the path of the saved session.\n\nRoot directory:\n"+e.props.session.settings.rootDir);t&&me.loadSession(t)},e}return Object(K.a)(n,[{key:"render",value:function(){var e=[{name:"Save session",icon:Object(je.jsx)(ee.c,{size:20}),onClick:this.saveCurrentSession},{name:"Load session",icon:Object(je.jsx)(Q.e,{size:20}),onClick:this.loadSession}];return Object(je.jsx)(Ge,{actions:e})}}]),n}(s.Component),ze=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(){return Object(q.a)(this,n),t.apply(this,arguments)}return Object(K.a)(n,[{key:"render",value:function(){return Object(je.jsx)(fe.a,{"data-tip":this.props.tooltip,style:this.props.style,floating:!0,icon:this.props.icon,onClick:this.props.onClick,className:this.props.className})}}]),n}(s.Component),Be={setActivePage:re},Ue=(Object(G.b)((function(e){return{session:e.session,active:e.active}}),Be)(Fe),n(477)),We={settings:{name:"Settings",icon:Object(je.jsx)(Ue.a,{size:20}),color:"grey",hotKey:"Shift + s"},plots:{name:"Dashboard",icon:Object(je.jsx)(te.c,{}),color:"grey",hotKey:"Shift + d"}},He=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(q.a)(this,n);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).showPage=function(){e.props.setActivePage(e.props.to)},e}return Object(K.a)(n,[{key:"render",value:function(){var e=We[this.props.to];return Object(je.jsx)(ze,Object(S.a)({icon:e.icon,className:e.color,tooltip:"Go to "+this.props.to+" ("+e.hotKey+")",onClick:this.showPage},this.props))}}]),n}(s.Component),Ve={setActivePage:re},qe=Object(G.b)(null,Ve)(He),Ke=function(e){return Object(je.jsxs)("div",{className:"plotableTag "+(e.selected?"active":""),onClick:e.toggle,"data-tip":e.plotable.path,"data-effect":"solid",children:[Object(je.jsx)("div",{children:e.plotable.name}),Object(je.jsx)("div",{style:{fontSize:"0.7em",color:"gray"},children:".../"+e.plotable.path.split("/").slice(-2,-1)[0]})]})},Ye=function(e){return Object(je.jsxs)("div",{className:"structTag "+(e.selected?"active":""),onClick:e.toggle,"data-tip":e.structure.path,"data-effect":"solid",children:[Object(je.jsx)("div",{children:e.structure.name.replace(".fdf","")}),Object(je.jsx)("div",{style:{fontSize:"0.7em",color:"gray"},children:".../"+e.structure.path.split("/").slice(-2,-1)[0]})]})},Xe={searchString:"",alphabeticSorting:!1,selectedSorting:!1,searchByFolder:!1,displayStructures:!0,displayPlotables:!0},Je=Object(s.createContext)({pickerParams:Xe,setPickerParams:function(e){},toggleParam:function(e){}}),Ze={structures:[],plotables:[]};var $e=Object(s.createContext)({pickerSelected:Ze,nChanges:0,setPickerSelected:function(e){},toggleSelectedObject:function(e,t){},filterSelected:function(e,t){return Ze[e].map((function(e){return t[e]})).filter((function(e){return void 0!==e}))},unselect:function(e,t){}}),Qe=function(e){var t=Object(s.useState)(Xe),n=Object(z.a)(t,2),i=n[0],o=n[1],a=Object(s.useRef)(0),c=Object(s.useState)(Ze),r=Object(z.a)(c,2),l=r[0],u=r[1],d=Object(s.useMemo)((function(){return{pickerParams:i,setPickerParams:function(e){return o(Object(S.a)(Object(S.a)({},i),e))},toggleParam:function(e){var t;if("alphabeticSorting"===e){var n=i.alphabeticSorting;!1===n?t="asc":"asc"===n?t="desc":"desc"===n&&(t=!1)}else t=!i[e];o(Object(S.a)(Object(S.a)({},i),{},Object(E.a)({},e,t)))}}}),[i,o]),p=Object(s.useMemo)((function(){a.current=a.current+1;return{pickerSelected:l,nChanges:a.current,setPickerSelected:function(e){return u(Object(S.a)(Object(S.a)({},l),e))},toggleSelectedObject:function(e,t){var n=P.a.xor(l[e],[t]);u(Object(S.a)(Object(S.a)({},l),{},Object(E.a)({},e,n)))},filterSelected:function(e,t){return l[e].map((function(e){return t[e]})).filter((function(e){return void 0!==e}))},unselect:function(e,t){"string"===typeof t&&(t=[t]),console.log("UNSELECTING",t,"from",l),console.log(Object(S.a)(Object(S.a)({},l),{},Object(E.a)({},e,l[e].map((function(e){return!t.includes(e)}))))),u(Object(S.a)(Object(S.a)({},l),{},Object(E.a)({},e,l[e].filter((function(e){return!t.includes(e)})))))}}}),[l,u]);return Object(je.jsx)(Je.Provider,{value:d,children:Object(je.jsx)($e.Provider,{value:p,children:e.children})})};var et=function(e,t,n){var s=n.searchString;s=s.includes("*")||s.includes("?")?s:"*"+s+"*";var i=[n.displayStructures,n.displayPlotables];return[e,t].reduce((function(e,t,o){if(!i[o])return e;var a=1===o;return Object.keys(t).forEach((function(i){var o,c=t[i],r=n.searchByFolder?c.path.split("/").slice(-2,-1)[0]:c.name;o=r,new RegExp("^".concat(s.replace(/\*/g,".*").replace(/\?/g,"."),"$"),"i").test(o)&&(e[i]=Object(S.a)(Object(S.a)({},c),{},{isPlotable:a}))})),e}),{})},tt=function(e){return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{style:{color:"darkred"},children:"No structures in the search scope right now."}),Object(je.jsx)("div",{children:"Try to change file system settings or initialize the GUI from a different directory"}),Object(je.jsx)(qe,{to:"settings",style:{marginTop:10}})]})},nt=function(e){return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{style:{color:"darkred"},children:"No structure that matches your search."}),Object(je.jsx)("div",{children:"Try to change file system settings or initialize the GUI from a different directory"}),Object(je.jsx)(qe,{to:"settings",style:{marginTop:10}})]})},st=function(e){var t=Object(s.useContext)(Je),n=t.pickerParams,i=t.setPickerParams,o=t.toggleParam,a=Object(s.useContext)($e),c=a.pickerSelected,r=a.setPickerSelected,l=a.toggleSelectedObject,u=et(e.structures||{},e.plotables||{},n),d=Object.values(u);if(n.alphabeticSorting&&(d=P.a.orderBy(d,"name",n.alphabeticSorting)),n.selectedSorting){d=P.a.orderBy(d,(function(e){return[].concat(Object(V.a)(c.structures),Object(V.a)(c.plotables)).includes(e.id)}),"desc")}var p=function(e){return[].concat(Object(V.a)(c.structures),Object(V.a)(c.plotables)).includes(e)};return Object(je.jsxs)("div",{style:Object(S.a)({height:"100%",display:"flex",flexDirection:"column",backgroundColor:"white"},e.style),children:[Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",marginTop:20,marginBottom:20},children:[Object(je.jsx)(he,{label:"Search string",style:{marginRight:10},value:n.searchString,onChange:function(e){return i({searchString:e})}}),Object(je.jsx)("div",{"data-tip":"Search by folder",className:"structPickerToggle "+(n.searchByFolder?"active":""),onClick:function(){return o("searchByFolder")},style:{cursor:"pointer"},children:n.searchByFolder?Object(je.jsx)(te.f,{}):Object(je.jsx)(te.g,{})})]}),Object(je.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5},children:[Object(je.jsx)("span",{"data-tip":"Show structures",className:"structPickerToggle "+(n.displayStructures?"active":""),onClick:function(){return o("displayStructures")},style:{cursor:"pointer"},children:"Struct"}),Object(je.jsx)("span",{"data-tip":"Show plotables",className:"structPickerToggle "+(n.displayPlotables?"active":""),onClick:function(){return o("displayPlotables")},style:{cursor:"pointer"},children:"Plotables"})]}),Object(je.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:5},children:[Object(je.jsx)("span",{className:"structPickerToggle "+(n.alphabeticSorting?"active":""),onClick:function(){return o("alphabeticSorting")},style:{cursor:"pointer"},children:"A-Z"}),Object(je.jsx)("span",{"data-tip":"Show selected first",className:"structPickerToggle "+(n.selectedSorting?"active":""),onClick:function(){return o("selectedSorting")},style:{cursor:"pointer"},children:"sel"}),Object(je.jsx)("span",{className:"structPickerToggle",onClick:function(){var t=Object.keys(u),n=0===P.a.intersection([].concat(Object(V.a)(c.structures),Object(V.a)(c.plotables)),t).length,s=P.a.intersection(Object.keys(e.structures),t),i=P.a.intersection(Object.keys(e.plotables),t),o=n?[].concat(Object(V.a)(s),Object(V.a)(c.structures)):c.structures.filter((function(e){return!s.includes(e)})),a=n?[].concat(Object(V.a)(i),Object(V.a)(c.plotables)):c.plotables.filter((function(e){return!i.includes(e)}));r({structures:o,plotables:a})},style:{cursor:"pointer"},children:"All"})]}),0===Object.keys(Object(S.a)(Object(S.a)({},e.structures),e.plotables)).length?Object(je.jsx)(tt,{}):0===Object.values(d).length?Object(je.jsx)(nt,{}):null,Object(je.jsx)("div",{style:{flex:1},className:"scrollView",children:Object.values(d).map((function(e){return e.isPlotable?Object(je.jsx)(Ke,{id:e.id,plotable:e,selected:p(e.id),toggle:function(){return l("plotables",e.id)}}):Object(je.jsx)(Ye,{id:e.id,structure:e,selected:p(e.id),toggle:function(){return l("structures",e.id)}})}))})]})},it=Object(_e.WidthProvider)(_e.Responsive),ot={backgroundColor:"#757eff",paddingTop:5,marginTop:-5},at=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;return Object(q.a)(this,n),(s=t.call(this,e)).state={currentBreakpoint:"lg",compactType:"vertical",mounted:!1,layouts:{lg:[]}},s.emptyDashboard=function(){return null},s.noTabsMessage=function(){return null},s.noPlotsMessage=function(){return Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",height:"100%"},children:[Object(je.jsx)("div",{style:{fontSize:"5em",fontWeight:"bold"},children:"This is the plots dashboard."}),Object(je.jsx)("div",{style:{fontSize:"1.2em"},children:"We would like to display your plots here, but currently you don't seem to have any"}),Object(je.jsx)("div",{style:{backgroundColor:"white",fontSize:"2em",margin:20,padding:20,paddingLeft:50,paddingRight:50,borderRadius:70},children:" You can try to create one by clicking on your structures"})]})},s.toggleSelected=function(e){var t;t=s.state.selected.includes(e)?s.state.selected.filter((function(t){return t!==e})):[].concat(Object(V.a)(s.state.selected),[e]),s.setState({selected:t})},s.onBreakpointChange=function(e){document.dispatchEvent(new CustomEvent("plotResize",{detail:{id:"all"}}))},s.onResizeStop=function(e,t,n){document.dispatchEvent(new CustomEvent("plotResize",{detail:{id:n.i,higher:t.h>n.h}}))},s.shouldComponentUpdate=function(e){if(!s._plotsInLayout)return!0;var t,n=e.active.tab!==s.props.active.tab;if(!n){var i=P.a.find(s.props.tabs,["id",s.props.active.tab]),o=P.a.find(e.tabs,["id",e.active.tab]);if(!i||!o)return!0;if(!i.layouts||!o.layouts)return!0;if(P.a.isEqual(i.layouts,o.layouts))return!0;if(!P.a.isEqual(s._plotsInLayout,o.plots))return!0;t=!P.a.isEqual(i.plots,o.plots)}return n||t},s.onLayoutChange=function(e,t){s.props.onLayoutChange(e,t),me.setTabLayouts(s.props.active.tab,t)},s.onDrop=function(e){alert("Element parameters: ".concat(JSON.stringify(e)))},s.plotFiles=function(e){e.forEach((function(e){me.plotFile(e)}))},s.getLayout=function(){if(!s.props.active.tab)return s.noTabsMessage();var e=P.a.find(s.props.tabs,["id",s.props.active.tab]);if(!e)return s.noTabsMessage();if(0===e.plots.length)return s.noPlotsMessage();var t=e.plots.map((function(e){return s.props.plots[e]}));if((t=t.filter((function(e){return e}))).length!==e.plots.length)return null;var i=e.layouts;return i.lg.length!==t.length&&(i.lg=t.map((function(e){return P.a.find(i.lg,["i",e.id])||n.newPlotLayout(e,i)}))),s._plotsInLayout=e.plots,Object(je.jsx)(it,Object(S.a)(Object(S.a)({},s.props),{},{layouts:i,onBreakpointChange:s.onBreakpointChange,onLayoutChange:s.onLayoutChange,onDrop:s.onDrop,onResizeStop:s.onResizeStop,draggableCancel:".infolayer, .draglayer, .shapelayer, #scene",measureBeforeMount:!1,useCSSTransforms:s.state.mounted,compactType:s.state.compactType,preventCollision:!s.state.compactType,rowHeight:10,children:s.generateDOM(i.lg,t,s.state.selected,s.toggleSelected)}))},s.mergePlots=function(e){me.mergePlots(s.state.selected,e),s.setState({selected:[]})},s.removePlots=function(){s.state.selected.forEach((function(e){return me.removePlot(e)})),s.setState({selected:[]})},s.movePlots=function(){var e=P.a.findIndex(s.props.tabs,["id",s.props.active.tab])+1;s.props.tabs.length===e&&(e=0),s.state.selected.forEach((function(t){return me.movePlot(t,s.props.tabs[e].id)})),s.setState({selected:[]})},s.renderSelectedManager=function(){var e=s.state.selected.length;if(0===e)return null;return Object(je.jsxs)(Ee.a,{style:{padding:10,marginBottom:10},elevation:3,children:["You have ".concat(e," plots selected. What do you want to do?"),Object(je.jsxs)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[e>1?[{to:"multiple"},{to:"subplots"},{to:"animation"}].map((function(e){return Object(je.jsx)(fe.a,{onClick:function(){return s.mergePlots(e.to)},children:"Merge as ".concat(e.to)})})):null,Object(je.jsx)(fe.a,{onClick:s.removePlots,children:"Remove"}),Object(je.jsx)(fe.a,{onClick:s.movePlots,children:"Move to other tab"})]})]})},s._plotsInLayout=!1,s.state={selected:[]},s}return Object(K.a)(n,[{key:"componentDidMount",value:function(){this.setState({mounted:!0}),this.props.setActivePlot(void 0)}},{key:"generateDOM",value:function(e,t,n,s){return P.a.map(e,(function(e,i){return Object(je.jsx)("div",{onClick:function(e){return e.ctrlKey?s(t[i].id):null},children:Object(je.jsx)(we,{plot:t[i],style:n.includes(t[i].id)?ot:{}})},t[i].id)}))}},{key:"render",value:function(){return Object(je.jsxs)("div",{style:Object(S.a)(Object(S.a)({},this.props.style),{},{display:"flex",flexWrap:"wrap",height:"40vh"}),children:[Object(je.jsx)(st,{style:{paddingLeft:15,paddingRight:15,width:"10vw",minWidth:200,borderRight:"#ccc solid 1px"},structures:this.props.structures,plotables:this.props.plotables}),Object(je.jsxs)("div",{style:{flex:1,height:"100%",display:"flex",flexDirection:"column"},children:[Object(je.jsxs)("div",{style:{padding:10,flex:1},className:"scrollView",children:[this.renderSelectedManager(),this.getLayout()]}),Object(je.jsx)(Ie,{placeholder:"Drop a file to plot, or click to select one.",onChange:this.plotFiles})]})]})}}]),n}(i.a.Component);at.defaultProps={className:"layout",rowHeight:30,onLayoutChange:function(){},cols:{lg:12,md:12,sm:6,xs:4,xxs:2}},at.newPlotLayout=function(e,t){return{x:e.grid_dims[0]*t.lg.length,y:2,w:e.grid_dims[0],h:e.grid_dims[1],i:e.id}};var ct={setSessionTabs:oe,setTabPlots:function(e,t){return{type:"SET_TAB_PLOTS",tabID:e,plots:t}},setActivePlot:ae},rt=Object(G.b)((function(e){return{plots:e.plots,plotables:e.session.plotables,structures:e.session.structures,tabs:e.session.tabs,active:e.active}}),ct)(Object(ye.withHotKeys)(at)),lt=n(1314),ut=function(e){var t=!e.inputField.params.isClearable,n=e.inputField.params.isCreatable,s=e.inputField.params.isMulti,i=e.inputField.params.options,o=function e(t){var n;return s&&Array.isArray(t)?n=t.map(e):"string"===typeof t?n=t:null!==t&&(n=t.value),a(n)},a=function(e){return null===e&&(e=s?[]:null),e},c=function e(t){var n=null;return s&&Array.isArray(t)?n=t.map(e):null!=t&&null==(n=P.a.find(i,{value:t}))&&(n={value:t,label:t}),a(n)}(e.value);return Object(je.jsx)(lt.a,{fullWidth:!0,freeSolo:n,multiple:s,disableClearable:t,value:c,onChange:function(t,n,s){n=o(n),e.onChange(n)},getOptionLabel:function(e){return e.label},options:i,renderInput:function(t){return Object(je.jsx)(be.a,Object(S.a)(Object(S.a)({style:{width:"100%"}},t),{},{label:e.label,variant:"outlined"}))}})},dt=Object(G.b)((function(e){return{session:e.session}}))((function(e){var t={type:"dropdown",params:{options:e.options||e.session.plotOptions,isClearable:!0,isMulti:!0}};return Object(je.jsx)(ut,{value:e.value,inputField:t,onChange:e.onChange,label:"Plot type"})})),pt=Object(G.b)((function(e){return{tabs:e.session.tabs,active:e.active}}))((function(e){var t=e.tabs.map((function(e){return{label:e.name,value:e.id}})),n=e.value;null==n&&e.active.tab&&P.a.find(e.tabs,["id",e.active.tab])&&e.onChange(e.active.tab);var s={type:"dropdown",params:{options:t,isClearable:!1,isMulti:!1}};return Object(je.jsx)(ut,{value:n,inputField:s,onChange:e.onChange,label:"Tab"})})),bt=function(e){var t=Object(s.useContext)($e).unselect,n=e.structure,i=e.groupActive;return Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"flex-start",alignItems:"center",marginTop:10,marginBottom:10},children:[Object(je.jsx)("div",{style:{color:"darkred",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:function(){return t("structures",n.id)},children:Object(je.jsx)(te.i,{})}),Object(je.jsx)("div",{style:{cursor:i?"default":"pointer",marginRight:20,marginLeft:20,padding:10,backgroundColor:i?"whitesmoke":"#ccc",borderRadius:3},onClick:i?void 0:e.moveStructToActiveGroup,children:n.name.replace(".fdf","")}),Object(je.jsx)("div",{"data-tip":n.path,children:".../"+n.path.split("/").slice(-2,-1)[0]})]})},jt=[{label:"Plot individually",value:"separatePlot"},{label:"Merge in single plot",value:"jointPlot"},{label:"Build animation",value:"jointAnimation"},{label:"Animation for each",value:"separateAnimation"}],ht=function(e){var t=e.value;null==t&&e.onChange(jt[0].value);var n={type:"dropdown",params:{options:jt,isClearable:!1,isMulti:!1}};return Object(je.jsx)(ut,{value:t,inputField:n,onChange:e.onChange,label:"Plotting method"})},ft=n(1304),Ot=function(e){var t=e.initializingOptions,n=t.tabID,s=t.plotClasses,i=t.mergeMethod,o=e.active?{backgroundColor:"#ccc"}:{backgroundColor:"whitesmoke"};return Object(je.jsxs)("div",{children:[Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",margin:-4},children:[Object(je.jsx)("div",{className:"structGroupAction",style:o,onClick:e.splitGroup,children:"Split"}),Object(je.jsx)("div",{className:"structGroupAction",style:o,onClick:e.removeGroup,children:"Remove"}),e.active?null:Object(je.jsx)("div",{className:"structGroupAction",style:o,onClick:e.setGroupAsActive,children:"Mark as receptive"}),Object(je.jsx)("div",{style:{flex:1}})]}),Object(je.jsxs)(ft.a,{container:!0,spacing:1,style:Object(S.a)({transition:"all 300ms",display:"flex",flexWrap:"wrap",padding:20,marginTop:0,marginBottom:20,borderRadius:5,borderTopLeftRadius:0,justifyContent:"center",alignItems:"center"},o),children:[Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,lg:3,children:e.structs.map((function(t){return Object(je.jsx)(bt,{structure:t,groupActive:e.active,moveStructToActiveGroup:function(){return e.moveStructToActiveGroup(t.id)}})}))}),Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,lg:3,children:Object(je.jsx)(dt,{value:s,onChange:function(t){return e.onInitParamChange("plotClasses",t)}})}),Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,lg:3,children:Object(je.jsx)(pt,{value:n,onChange:function(t){return e.onInitParamChange("tabID",t)}})}),Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,lg:3,children:Object(je.jsx)(ht,{value:i,onChange:function(t){return e.onInitParamChange("mergeMethod",t)}})})]})]})},gt=function(e){return!e.plots&&e.plotable.default_plot&&e.selectPlots([e.plotable.default_plot]),Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center",marginTop:10},children:[Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(je.jsx)("div",{style:{color:"darkred",cursor:"pointer",display:"flex",justifyContent:"center",alignItems:"center"},onClick:e.unselect,children:Object(je.jsx)(te.i,{})}),Object(je.jsx)("div",{"data-tip":e.plotable.path,style:{marginLeft:20},children:"(.../"+e.plotable.path.split("/").slice(-2,-1)[0]+")"}),Object(je.jsx)("div",{style:{marginLeft:20,padding:10,backgroundColor:"whitesmoke",borderRadius:3},children:e.plotable.name})]}),Object(je.jsx)("div",{style:{flex:1,paddingLeft:20,paddingRight:20},children:Object(je.jsx)(dt,{options:e.plotable.plots.map((function(e){return{value:e,label:e}})),value:e.plots||[""],onChange:e.selectPlots})})]})},vt=function(e,t,n){return Object(S.a)({structs:e,initializingOptions:{tabID:t,plotClasses:[],mergeMethod:"separatePlot"}},n)},mt=function(e,t){return t.map((function(t,n){return Object(S.a)(Object(S.a)({},t),{},{active:n===e})}))},yt=function(e){return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{style:{color:"darkred",fontSize:"1.3em",fontWeight:"bold"},children:"There's nothing to plot currently"}),Object(je.jsx)("div",{children:"Select a structure or plotable to begin."})]})},xt={setActiveTab:ce,addPlots:ie,informLoadingPlot:function(e){return{type:g,plot:e}},informLoadedPlot:function(e){return{type:v,plotID:e}}},St=Object(G.b)((function(e){return{tabs:e.session.tabs,active:e.active}}),xt)((function(e){var t,n,i=Object(s.useContext)($e),o=i.pickerSelected,a=i.nChanges,c=i.setPickerSelected,r=i.filterSelected,l=i.unselect,u=Object(s.useState)([]),d=Object(z.a)(u,2),p=d[0],b=d[1],j=Object(s.useState)({}),h=Object(z.a)(j,2),f=h[0],O=h[1],g=e.active.tab?e.active.tab:e.tabs.length&&e.tabs.length>0?e.tabs[0].id:void 0,v=r("plotables",e.session.plotables),m=r("structures",e.session.structures),y=function(e){var t=P.a.find(m,["id",e]);if(t){var n=p.map((function(n){var s=n.active?[].concat(Object(V.a)(n.structs),[t]):n.structs.filter((function(t){return t.id!==e}));return Object(S.a)(Object(S.a)({},n),{},{structs:s})}));b(n)}},x=Object(s.useRef)(0);if(x.current!==a){x.current=a;var C=[],T=p.reduce((function(e,t){return[].concat(Object(V.a)(e),Object(V.a)(t.structs.map((function(e){return e.id}))))}),[]),k=m.filter((function(e){var t=e.id;return!T.includes(t)}));C=k.length>0?0===p.length?mt(0,[vt(m,g)]):p.map((function(e){return e.active?Object(S.a)(Object(S.a)({},e),{},{structs:e.structs.concat(k)}):e})):Object(V.a)(p),t=C,n=o.structures,C=t.reduce((function(e,t){return(t=Object(S.a)(Object(S.a)({},t),{},{structs:t.structs.filter((function(e){var t=e.id;return n.includes(t)}))})).structs.length>0&&e.push(t),e}),[]),P.a.find(C,"active")||(C=mt(C.length-1,C)),console.log("SETTING NEW GROUPS",C),b(C)}return 0===e.tabs.length?null:(console.warn("STRUCTURE GROUPS",p),Object(je.jsxs)("div",{className:"plotInitializer",style:Object(S.a)(Object(S.a)({},e.style),{},{display:"flex"}),children:[Object(je.jsx)(st,{structures:e.session.structures,plotables:e.session.plotables,style:{paddingLeft:15,paddingRight:15,width:"10vw",minWidth:200,borderRight:"#ccc solid 1px"}}),Object(je.jsxs)($.a,{style:{flex:1,margin:20,padding:20,background:"aliceblue",overflow:"visible"},children:[m.length>0?Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{className:"sectionHeader",children:"Structures"}),p.map((function(e,t){return Object(je.jsx)(Ot,Object(S.a)(Object(S.a)({},e),{},{onInitParamChange:function(e,n){return function(e,t,n){var s=p.map((function(s,i){return i===e?Object(S.a)(Object(S.a)({},s),{},{initializingOptions:Object(S.a)(Object(S.a)({},s.initializingOptions),{},Object(E.a)({},t,n))}):s}));b(s)}(t,e,n)},setGroupAsActive:function(){return b(mt(t,p))},removeGroup:function(){return function(e){var t=p[e];if(t.structs.length>0)l("structures",t.structs.map((function(e){return e.id})));else{var n=p.filter((function(t,n){return n!==e}));t.active&&(n=mt(p.length-1,p)),b(n)}}(t)},splitGroup:function(){return function(e){var t=p[e],n=t.structs.map((function(e){return vt([e],g,P.a.omit(t,["structs"]))})),s=p.filter((function(t,n){return n!==e}));s=[].concat(Object(V.a)(s.slice(0,e)),Object(V.a)(n),Object(V.a)(s.slice(e))),t.active&&(s=mt(e,s)),b(s)}(t)},moveStructToActiveGroup:y}))})),Object(je.jsx)("div",{onClick:function(){return function(e){var t=e.structs,n=mt(p.length,[].concat(Object(V.a)(p),[vt(t||[],g)]));b(n)}({})},children:"New Group"})]}):null,v.length>0?Object(je.jsx)("div",{className:"sectionHeader",children:"Plotables"}):null,Object(je.jsx)("div",{children:v.map((function(e){return Object(je.jsx)(gt,{plotable:e,plots:f[e.id],selectPlots:function(t){return O(Object(S.a)(Object(S.a)({},f),{},Object(E.a)({},e.id,t)))},unselect:function(){return l("plotables",e.id)}})}))}),0===[].concat(Object(V.a)(v),Object(V.a)(m)).length?Object(je.jsx)(yt,{}):null,Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",paddingTop:20},children:[Object(je.jsx)(fe.a,{style:{marginRight:20},onClick:function(){return c({structures:[],plotables:[]})},endIcon:Object(je.jsx)(te.b,{}),children:"Dismiss"}),Object(je.jsx)(fe.a,{style:{marginLeft:20},onClick:function(){c({structures:[],plotables:[]}),v.forEach((function(e){f[e.id].forEach((function(t){me.newPlot({tabID:g,plotable_path:e.path,plot_method:t})}))})),p.forEach((function(e){var t=e.structs,n=e.initializingOptions;if(n.mergeMethod.includes("separate")){var s=n.mergeMethod.includes("Animation");t.forEach((function(e){n.plotClasses.forEach((function(t){me.newPlot({tabID:n.tabID,structID:e.id,animation:s,plotClass:t})}))}))}}))},endIcon:Object(je.jsx)(te.d,{}),children:"Initialize plots"})]})]})]}))})),Ct=n(1306),Pt=n(1316),Tt=n(1305),kt=n(1307),wt=n(1318),_t=function(e){var t=e.id||(e.setting?e.setting.key:"");return Object(je.jsxs)("div",{className:"container",children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:e.label}),Object(je.jsx)(wt.a,Object(S.a)({id:t,checked:e.value,onChange:function(t){return e.onChange(t.target.checked)}},e.inputField?e.inputField.params:void 0))]})},Et=n(318),At=function(e){var t=Object(s.useState)(void 0),n=Object(z.a)(t,2),i=n[0],o=n[1],a=Object(s.useState)(!1),c=Object(z.a)(a,2),r=c[0],l=c[1],u=r?Object(je.jsx)("div",{style:{position:"absolute",bottom:60},children:Object(je.jsx)(Et.ChromePicker,Object(S.a)({color:i||e.value||"black",onChange:function(e){o(e.hex)},onChangeComplete:function(t){e.onChange(t.hex),o(void 0)}},e.inputField?e.inputField.params:void 0))}):null;return Object(je.jsxs)("div",{style:{position:"relative",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:e.label}),Object(je.jsx)("div",{className:"MuiPaper-elevation3",onClick:function(){return l(!r)},style:{width:30,height:30,borderRadius:30,background:e.value}}),u]})},It=n(1319),Nt=function(e){var t=e.inputField?e.inputField.params:{},n=t.min,s=t.max,i=t.step,o=t.marks;o=Array.isArray(o)?o:void 0;var a=e.value||[0,0];return Object(je.jsxs)("div",{className:"container",children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:e.label}),Object(je.jsx)(It.a,{getAriaLabel:function(){return e.label},value:a,onChange:function(t,n){return e.onChange(n)},valueLabelDisplay:"auto",min:n,max:s,step:i,marks:o})]})},Lt=function(e){var t=null!=e.value?e.value:["",""],n=function(t,n,s){var i=Wt(t.target.value),o=!0;if("number"===typeof i&&(0===n&&"number"===typeof s[1]&&(o=i<=s[1]),1===n&&"number"===typeof s[0]&&(o=i>=s[0])),o){var a=0===n?[i,s[1]]:[s[0],i];e.onChange(a)}};return Object(je.jsxs)("div",{children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:e.label}),Object(je.jsxs)("div",{style:{display:"flex"},children:[Object(je.jsx)(be.a,Object(S.a)({style:{marginRight:30,flex:1},type:"number",variant:"outlined",label:"min",value:t[0],onChange:function(e){return n(e,0,t)}},e.inputField?e.inputField.params:void 0)),Object(je.jsx)(be.a,Object(S.a)({style:{marginLeft:30,flex:1},type:"number",variant:"outlined",label:"max",value:t[1],onChange:function(e){return n(e,1,t)}},e.inputField?e.inputField.params:void 0))]})]})},Dt=function(e){var t=e.inputField?e.inputField.params:{},n=void 0===e.value?"":e.value;return Object(je.jsx)("div",{children:Object(je.jsx)(be.a,{type:"number",label:e.label,value:n,onChange:function(t){return e.onChange(Wt(t.target.value))},style:e.style,variant:"outlined",inputProps:t})})},Rt=function(e){var t=function(){return Array((e.inputField.params.shape||[1])[0]).fill(null)},n=e.inputField.params.vertical?{marginLeft:20,marginRight:20,marginBottom:0,width:70}:{marginLeft:5,marginRight:5,marginBottom:0,width:100},s=Object(S.a)(Object(S.a)({},n),{},{textAlign:"center"}),i=e.value;return i||(i=t()),Object(je.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:[Object(je.jsx)("div",{style:{paddingBottom:10},children:e.label}),Object(je.jsx)("div",{style:{display:"flex",flexDirection:e.inputField.params.vertical?"column":"row",justifyContent:"center",alignItems:"center"},className:"arrayContainer",children:i.map((function(n,i){return Object(je.jsx)(Dt,{value:n,onChange:function(n){return function(n,s){var i=P.a.cloneDeep(e.value);"string"!==typeof n&&null!==n&&void 0!==n&&(i||(i=t()),i[s]=n,e.onChange(i))}(n,i)},style:s},i)}))})]})},Mt=n(197),Gt=Object(Mt.c)((function(){return Object(je.jsx)(te.e,{size:20,color:"gray"})})),Ft=Object(Mt.b)((function(e){return Object(je.jsxs)("div",{className:"listitem",children:[e.sortable?Object(je.jsx)(Gt,{}):null,Object(je.jsx)(qt,Object(S.a)({},e)),e.remove?Object(je.jsx)(Pe.a,{className:"removebutton",onClick:e.remove,children:Object(je.jsx)(Q.a,{color:"red"})}):null]})})),zt=Object(Mt.a)((function(e){return Object(je.jsx)("div",{className:"listcontainer",children:e.children})})),Bt=function(e){return e?Array.isArray(e)?e:[e]:[]},Ut={textinput:he,bool:_t,options:ut,"creatable options":function(e){return e.inputField.params.isCreatable=!0,Object(je.jsx)(ut,Object(S.a)({},e))},dict:function(e){var t=e.value||{},n=e.setting.inputField.fields||[];return Object(je.jsxs)("div",{className:"container",style:e.style,children:[Object(je.jsx)("div",{className:"namediv",children:e.setting.name}),Object(je.jsx)("div",{className:"fieldscontainer",children:n.map((function(n){return Object(je.jsx)(qt,{setting:n,value:t[n.key],onValueChange:function(t){return s=n.key,i=t,void e.onChange(Object(S.a)(Object(S.a)({},e.value),{},Object(E.a)({},s,i)));var s,i}},n.key)}))})]})},"creatable dict":function(e){var t=Object(s.useState)(void 0),n=Object(z.a)(t,2),i=n[0],o=n[1],a=e.label||(e.setting?e.setting.name:""),c=e.setting.inputField.fields||[],r=e.value||{},l=function(t){return P.a.find(e.setting.inputField.fields||[],["key",t])},u=function(t,n){e.onChange(Object(S.a)(Object(S.a)({},e.value),{},Object(E.a)({},t,n)))},d=function(t,n){var s=l(t);return s?Object(je.jsxs)("fieldset",{children:[Object(je.jsx)("legend",{style:{paddingLeft:10,paddingRight:10,paddingTop:2,paddingBottom:2,borderRadius:3,backgroundColor:"white"},children:s.name}),Object(je.jsx)(qt,Object(S.a)(Object(S.a)({},e),{},{setting:Object(S.a)(Object(S.a)({},s),{},{name:""}),value:n,onValueChange:function(e){return u(t,e)}})),Object(je.jsx)(Pe.a,{onClick:function(){return function(t){e.onChange(P.a.omit(e.value,t))}(t)},children:Object(je.jsx)(Q.a,{color:"red"})})]}):null};return Object(je.jsxs)("div",{className:"container",children:[Object(je.jsx)("div",{className:"namediv",children:a}),Object(je.jsx)("div",{className:"listcontainer",children:Object.keys(r).map((function(e){return d(e,r[e])}))}),Object(je.jsxs)("div",{className:"newfielddiv",children:[Object(je.jsx)(ut,{value:i,onChange:function(e){return o(e)},label:"Add a new selection...",inputField:{type:"",params:{options:c.map((function(e){return{label:e.name,value:e.key}}))}}}),Object(je.jsx)(Pe.a,{onClick:function(){return function(e){if(e){var t=l(e);t&&u(e,t.default)}}(i)},children:Object(je.jsx)(te.h,{color:"green"})})]})]})},color:At,rangeslider:Nt,range:Lt,number:Dt,vector:Rt,list:function(e){var t=Bt(e.value);return Object(je.jsxs)("div",{className:"container",style:e.style,children:[Object(je.jsx)("div",{className:"namediv",style:{paddingBottom:10},children:e.setting.name}),Object(je.jsx)(zt,{onSortEnd:function(t){e.onChange(Object(Mt.d)(Bt(e.value),t.oldIndex,t.newIndex))},useDragHandle:!0,children:t.map((function(t,n){return Object(je.jsx)(Ft,{index:n,value:t,onValueChange:function(t){return function(t,n){var s=Object(V.a)(Bt(e.value));s[n]=t,e.onChange(s)}(t,n)},remove:function(){return function(t){e.onChange(Bt(e.value).filter((function(e,n){return n!==t})))}(n)},sortable:e.setting.inputField.params.sortable,setting:e.setting.inputField.params.itemInput},"item-".concat(n))}))}),Object(je.jsx)(Pe.a,{"data-tip":"Add a new item",onClick:function(){e.onChange([].concat(Object(V.a)(Bt(e.value)),[e.setting.default||null]))},children:Object(je.jsx)(te.h,{color:"green"})})]})}},Wt=function(e){if("string"===typeof e){if(""===e)return null;if(["-","."].includes(e))return e}return Number(e)},Ht=function(e,t){t.onValueChange?t.onValueChange(e):t.changeSettings&&t.onSettingChangeType&&t.onSettingChangeExtraParams?t.changeSettings(t.onSettingChangeType,t.setting.key,e,t.onSettingChangeExtraParams):console.error("Wrong usage of changeSettingValue")},Vt={changeSettings:function(e,t,n,s){return{type:e,settingKey:t,value:n,extraParams:s}}},qt=Object(G.b)((function(e){return{browser:e.browser}}),Vt)((function(e){var t=e.setting.inputField,n=Ut[t.type];if(!n)return null;var s=e.setting?e.setting.name:"",i=Object(je.jsx)(n,Object(S.a)(Object(S.a)({},e),{},{label:s,inputField:t,onChange:function(t){return Ht(t,e)}})),o={"data-tip":(e.setting.help?e.setting.help+"<br>":"")+"Default: "+(e.setting.default||"None"),"data-multiline":!0,"data-effect":"solid","data-place":"color"===t.type?"bottom":"top"},a="SISL_INPUTFIELD SISL_INPUTFIELD_".concat(t.type.replace(/ /g,"_")," SISL_SETTING_").concat(e.setting.key," ");return null==e.value&&(a+=" inputvalue_None"),Object(je.jsx)("div",Object(S.a)(Object(S.a)({className:a,onClick:function(t){t.ctrlKey&&(t.stopPropagation(),Ht(null==e.value?e.setting.default:null,e))},style:e.style},o),{},{children:i}))})),Kt=n(481),Yt=n(496),Xt=function(e){var t=Object(s.useState)([]),n=Object(z.a)(t,2),i=n[0],o=n[1],a=e.paramGroup,c=e.groupedParams[a.key?a.key:"null"];if(!c)return null;var r=P.a.groupBy(c,"subGroup"),l={key:"null",name:null,icon:"",description:""},u=a.subGroups?[l].concat(Object(V.a)(a.subGroups)):[l];return Object(je.jsx)(Yt.a,{enableReinitialize:!0,initialValues:e.settings,onSubmit:function(t){e.submitSettings(Object.fromEntries(Object.entries(t).filter((function(e){var t=Object(z.a)(e,2),n=t[0];t[1];return i.includes(n)}))))},children:function(e){var t=e.values,n=(e.handleChange,e.handleSubmit),s=e.setFieldValue,c=e.resetForm;return Object(je.jsxs)("form",{className:"SISL_INPUTGROUP SISL_INPUTGROUP_".concat(a.key),onSubmit:n,children:[Object(je.jsx)("blockquote",{style:{textAlign:"left"},children:Object(Kt.a)(a.description)}),Object(je.jsx)("div",{className:"subgroupscontainer",children:u.map((function(e){var n=e.key,a=e.name;return r[n]?Object(je.jsxs)("div",{className:"SISL_INPUTSUBGROUP SISL_INPUTSUBGROUP_".concat(n),children:[Object(je.jsx)("div",{className:"namediv",style:{paddingBottom:20,fontWeight:"bold",fontSize:"1.3em",textAlign:"left"},children:a}),Object(je.jsx)("div",{className:"fieldscontainer",children:r[n].map((function(e){return e.inputField?Object(je.jsx)(qt,{onValueChange:function(t){o([].concat(Object(V.a)(i),[e.key])),s(e.key,t)},setting:e,value:t[e.key]},e.key):null}))})]},n):null}))}),Object(je.jsxs)("div",{style:{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},children:[Object(je.jsxs)(fe.a,{onClick:function(){return c()},"data-tip":"This will restore the settings to the current ones",style:{margin:20},children:[Object(je.jsx)(te.k,{}),"Restore"]}),Object(je.jsxs)(fe.a,{type:"submit","data-tip":"This will change the settings and will update everything accordingly.<br> IT ONLY AFFECTS THIS GROUP OF SETTINGS, not all settings",style:{margin:20},children:["Submit settings",Object(je.jsx)(ee.a,{})]})]})]})}})},Jt=function(e){var t=e.paramGroup,n=t.key?t.key:"null";return Object(je.jsxs)(Pt.a,{children:[Object(je.jsxs)(Tt.a,{style:{display:"flex",justifyContent:"center",alignItems:"center"},children:[Object(je.jsx)(Ct.a,{children:t.icon}),Object(je.jsx)("span",{style:{paddingLeft:10},children:t.name})]}),Object(je.jsx)(kt.a,{children:Object(je.jsx)(Xt,Object(S.a)({},e))})]},n)},Zt=function(e){var t=P.a.groupBy(e.params,"group");return Object(je.jsx)("div",{style:e.style,className:e.className,children:e.paramGroups.map((function(n,s){return Object(je.jsx)(Jt,Object(S.a)({index:s,paramGroup:n,groupedParams:t},e),s)}))})},$t=Object(G.b)((function(e){return{plots:e.plots,activePlot:R(e),session:e.session,browser:e.browser}}))((function(e){var t=e.activePlot;if(!t)return null;var n=t.settings;console.warn(t);var s=Object(je.jsx)(Zt,{className:"SISL_SETTING_PLOTCLASS_"+t.plotClass,settings:n,params:t.params,paramGroups:t.paramGroups,submitSettings:function(e){return me.updatePlotSettings(t.id,e)},undoSettings:function(){return me.undoPlotSettings(t.id)}});return Object(je.jsxs)("div",{style:Object(S.a)({},e.style),children:[Object(je.jsxs)(ft.a,{container:!0,style:{paddingLeft:"20px"},children:[Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,style:{height:"90vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:Object(je.jsx)(we,{plot:t,style:{height:"80vh"}})}),Object(je.jsx)(ft.a,{item:!0,sm:12,md:8,style:{padding:20,display:"flex",flexDirection:"column"},children:"infinity"===e.browser.mediaType?Object(je.jsx)("div",{className:"scrollView",style:{maxHeight:"90vh"},children:s}):s})]}),Object(je.jsx)(se.a,{effect:"solid",multiline:!0,disable:!!e.session.settings&&!e.session.settings.showTooltips})]})})),Qt=n(1309),en=n(495),tn=n(1308),nn=function(e){return Object(je.jsxs)(Pt.a,{children:[Object(je.jsxs)(Tt.a,{style:{display:"flex",cursor:"pointer",justifyContent:"space-between",alignItems:"center"},children:[Object(je.jsx)("span",{style:{color:"gray",marginRight:10},children:e.sequence}),Object(je.jsx)("span",{style:{fontWeight:"bold"},children:e.shortcut.name})]}),Object(je.jsx)(kt.a,{style:{fontSize:13},children:Object(je.jsx)(en.a,{children:e.shortcut.description})}),Object(je.jsx)(tn.a,{children:Object(je.jsx)(fe.a,{onClick:e.applyMethod,children:"APPLY METHOD"})})]})},sn=function(e){return Object(je.jsx)("div",{className:"scrollView",style:{textAlign:"left",borderRadius:3,maxHeight:"90vh"},children:Object.keys(e.shortcuts).map((function(t){return Object(je.jsx)(nn,{sequence:t,shortcut:e.shortcuts[t],applyMethod:function(){return e.applyMethod(t)}})}))})},on=Object(G.b)((function(e){return{activePlot:R(e),session:e.session}}))((function(e){return Object(je.jsxs)("div",{style:Object(S.a)(Object(S.a)({},e.style),{},{paddingLeft:"20px"}),children:[Object(je.jsxs)(ft.a,{container:!0,children:[Object(je.jsx)(ft.a,{item:!0,sm:12,md:4,style:{height:"90vh",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},children:Object(je.jsx)(we,{plot:e.activePlot,style:{height:"80vh"}})}),Object(je.jsx)(ft.a,{item:!0,sm:12,md:8,style:{padding:20,display:"flex",flexDirection:"column"},children:Object(je.jsx)(sn,{shortcuts:e.activePlot.shortcuts,applyMethod:function(t){return me.callPlotShortcut(e.activePlot.id,t)}})})]}),Object(je.jsx)(se.a,{multiline:!0,disable:!!e.session.settings&&!e.session.settings.showTooltips})]})})),an=n(316),cn=n.n(an),rn=n(484),ln=n.n(rn),un=(n(1232),{editable:!0}),dn=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;Object(q.a)(this,n),(s=t.call(this,e)).hotKeysHandlers={UNDO_SETTINGS:function(){return s.undoSettings()},SUBMIT_ALL_SETTINGS:function(){return s.submitSettings("all")}},s.submitSettings=function(e){"all"===e&&(e=s.props.activePlot.unsubmittedSettings),me.updatePlotSettings(s.props.activePlot.id,e)},s.undoSettings=function(){me.undoPlotSettings(s.props.activePlot.id)};var i=e.activePlot;return s.state=i.figure,s}return Object(K.a)(n,[{key:"componentWillUnmount",value:function(){me.updateFigure(this.props.activePlot.id,Object(S.a)(Object(S.a)({},this.state),{},{overwrite:!0}))}},{key:"render",value:function(){var e=this;return this.props.activePlot?Object(je.jsx)("div",{style:Object(S.a)(Object(S.a)({},this.props.style),{},{height:"40vh"}),children:Object(je.jsx)(ln.a,{data:this.state.data,layout:this.state.layout,config:un,frames:this.state.frames,plotly:cn.a,style:Object(S.a)({},this.props.style),onUpdate:function(t,n,s){return e.setState({data:t,layout:n,frames:s})},useResizeHandler:!0,debug:!0,advancedTraceTypeSelector:!0})}):null}}]),n}(s.Component),pn=Object(G.b)((function(e){return{activePlot:R(e)}}),null)(dn),bn=function(e){var t=e.tab,n=t.id,s=t.name;return Object(je.jsxs)("div",{className:e.selected?"active plotTab":"plotTab",onClick:e.selected?void 0:e.selectTab,children:[Object(je.jsx)("div",{id:n,contentEditable:e.selected,onBlur:function(t){t.target.blur&&t.target.blur();var n=t.target.textContent;n&&e.updateTabName(n)},children:s}),e.selected?Object(je.jsx)("div",{className:"removeTabBut",onClick:e.removeTab,children:Object(je.jsx)(te.j,{size:20})}):null]},n)},jn=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(){var e;Object(q.a)(this,n);for(var s=arguments.length,i=new Array(s),o=0;o<s;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).hotKeysHandlers={MOVE_TO_NEXT_TAB:function(){return e.moveThroughTabs("right")},MOVE_TO_PREVIOUS_TAB:function(){return e.moveThroughTabs("left")},NEW_TAB:function(){return e.newTab()},TRY:function(){return console.warn("YES")}},e.moveThroughTabs=function(t){var n,s=e.props.tabs,i=P.a.findIndex(s,["id",e.props.active.tab]);"left"===t?n=0!==i?i-1:s.length-1:"right"===t&&(n=i!==s.length-1?i+1:0),e.props.setActiveTab(s[n].id)},e.updateTabs=function(e){document.dispatchEvent(new CustomEvent("updateTabs",{detail:{tabs:e}}))},e.newTab=function(){me.addTab()},e.noTabsMessage=function(){return Object(je.jsx)("div",{style:{paddingLeft:20},children:Object(je.jsx)("span",{style:{color:"darkred"},children:"You don't seem to have any tab. "})})},e}return Object(K.a)(n,[{key:"render",value:function(){var e=this,t=this.props.tabs||[],n=this.props.tabComponent||bn,s=this.props.newTabComponent||function(e){return null},i=this.props.noTabsComponent||this.noTabsMessage();return Object(je.jsxs)("div",{style:Object(S.a)({display:"flex",flexWrap:"wrap",alignItems:"center"},this.props.style),children:[Object(je.jsx)(ye.GlobalHotKeys,{keyMap:Se.global,handlers:this.hotKeysHandlers}),0===t.length?i:t.map((function(t){return Object(je.jsx)(n,{tab:t,selected:e.props.active.tab===t.id,selectTab:function(){return e.props.setActiveTab(t.id)},removeTab:function(){return me.removeTab(t.id)},updateTabName:function(e){return me.updateTab(t.id,{name:e})}})})),Object(je.jsx)(s,{onClick:this.newTab})]})}}]),n}(s.Component),hn={setActiveTab:ce},fn=Object(G.b)((function(e){return{tabs:e.session.tabs,active:e.active}}),hn)(jn);Object(ye.configure)({logLevel:"debug",simulateMissingKeyPressEvents:!1});var On=function(e){var t=Object(s.useState)(!1),n=Object(z.a)(t,2),i=n[0],o=n[1];i&&!e.selected&&o(!1);var a=e.tab.name;return i?Object(je.jsx)(be.a,{label:"Tab name",defaultValue:a,onKeyPress:function(t){"Enter"===t.key&&(e.updateTabName(t.target.value),o(!1))}}):Object(je.jsx)(fe.a,{color:"inherit",style:{backgroundColor:e.selected?"whitesmoke":void 0,marginRight:10},onClick:e.selected?void 0:e.selectTab,onDoubleClick:function(){return o(!0)},endIcon:e.selected?Object(je.jsx)(te.j,{className:"removeTabBut",onClick:e.removeTab}):void 0,children:a})},gn=function(e){return Object(je.jsx)(Pe.a,{color:"inherit","aria-label":"add new tab",component:"span",onClick:e.onClick,children:Object(je.jsx)(te.a,{color:"green",className:"newTabIcon"})})},vn=function(e){var t=Object(s.useContext)($e).pickerSelected,n=Object.keys(t).reduce((function(e,n){return e+t[n].length}),0),i=Object(s.useRef)(n);i.current!==n&&(console.warn(n,e.active.page),0===n&&"plotInitializer"===e.active.page?e.setActivePage("plots"):n>0&&"plotInitializer"!==e.active.page&&e.setActivePage("plotInitializer"),i.current=n);var o=P.a.find(e.tabs,["id",e.active.tab]);o&&o.plots.forEach((function(t){e.plots[t]||me.getPlot(t)}));var a={GO_TO_DASHBOARD:function(){return e.setActivePage("plots")},SHOW_AVAIL_HOTKEYS:function(){return console.warn(Object(ye.getApplicationKeyMap)())}};e.active.plot||["plotInitializer","plots"].includes(e.active.page)||e.setActivePage("plots");var c={plots:rt,plotLayoutEditor:pn,plotTweaking:$t,plotMethods:on,plotInitializer:St}[e.active.page];return Object(je.jsxs)("div",{style:{height:"100%",display:"flex",flexDirection:"column"},children:[Object(je.jsx)(ye.GlobalHotKeys,{keyMap:Object(S.a)({},xe),handlers:a}),Object(je.jsxs)(Qt.a,{style:{backgroundColor:"#cccccc"},children:[["plots"].includes(e.active.page)?null:Object(je.jsx)(fe.a,{color:"inherit",onClick:function(){return e.setActivePage("plots")},children:"BACK TO DASHBOARD"}),"plots"===e.active.page?Object(je.jsx)(fn,{tabComponent:On,newTabComponent:gn}):null]}),Object(je.jsx)(c,{style:{flex:1},session:e.session,goto:e.setActivePage})]})},mn={setActivePlot:ae,setActivePage:re},yn=Object(G.b)((function(e){return{plots:e.plots,tabs:e.session.tabs,active:e.active,session:e.session}}),mn)((function(e){return Object(je.jsx)(Qe,{children:Object(je.jsx)(vn,Object(S.a)({},e))})}));function xn(){var e=window;return{width:e.innerWidth,height:e.innerHeight}}var Sn=function(e){var t=function(){var e=Object(s.useState)(xn()),t=Object(z.a)(e,2),n=t[0],i=t[1];return Object(s.useEffect)((function(){function e(){i(xn())}return window.addEventListener("resize",e),function(){return window.removeEventListener("resize",e)}}),[]),n}().height;return Object(je.jsx)("iframe",{src:"https://zerothi.github.io/sisl/",title:"Sisl documentation","aria-label":"Sisl documentation",style:{height:t-20,width:"99%"}})},Cn=n(324);function Pn(e){var t=Object(s.useRef)(),n=Object(s.useState)(!1),i=Object(z.a)(n,2),o=i[0],a=i[1],c=Object(s.useState)(!1),r=Object(z.a)(c,2),l=r[0],u=r[1];return Object(Cn.b)((function(){t.current.rotation.x=t.current.rotation.y+=.01})),Object(je.jsxs)("mesh",Object(S.a)(Object(S.a)({},e),{},{ref:t,scale:l?[1.5,1.5,1.5]:[1,1,1],onClick:function(e){return u(!l)},onPointerOver:function(e){return a(!0)},onPointerOut:function(e){return a(!1)},children:[Object(je.jsx)("boxBufferGeometry",{attach:"geometry",args:[1,1,1]}),Object(je.jsx)("meshStandardMaterial",{attach:"material",color:o?"hotpink":"orange"})]}))}function Tn(e){return Object(je.jsxs)(Cn.a,Object(S.a)(Object(S.a)({style:e.style},e),{},{children:[Object(je.jsx)("ambientLight",{}),Object(je.jsx)("pointLight",{position:[10,10,10]}),Object(je.jsx)(Pn,{position:[-1.2,0,0],sign:-1}),Object(je.jsx)(Pn,{position:[1.2,0,0]})]}))}var kn=function(e){var t=e[0];me.loadSessionFromFile(t)},wn=function(){me.getSessionFile((function(e){var t=new Blob([e]),n=window.URL.createObjectURL(t),s=document.createElement("a");s.href=n,s.setAttribute("download","newSession.session"),s.click()}))},_n=Object(G.b)((function(e){return{session:e.session}}))((function(e){var t=Object(s.useState)(!(!me||!me.socket)&&me.socket.connected),n=Object(z.a)(t,2),i=n[0],o=n[1],a=Object(s.useState)("settings"),c=Object(z.a)(a,2),r=c[0],l=c[1];if(me.onConnect((function(){o(!0)})),!i)return Object(je.jsxs)("div",{style:Object(S.a)(Object(S.a)({},e.style),{},{height:"100%",display:"flex",flexDirection:"column"}),children:[Object(je.jsx)("div",{style:{paddingTop:100},children:Object(je.jsx)("div",{style:{fontSize:"2.5em",fontWeight:"bold"},children:"We are trying to connect to the sisl API."})}),Object(je.jsx)(Tn,{style:{flex:1},camera:{position:[0,0,5]}}),Object(je.jsx)("div",{style:{paddingBottom:100,fontSize:"1.2em"},children:" Meanwhile you can have fun with these two moving cubes. "})]});if(P.a.isEmpty(e.session))return null;var u=null;return"settings"===r?u=Object(je.jsx)("div",{style:{padding:20,flex:1},className:"scrollView",children:Object(je.jsx)(Zt,{className:"SISL_SETTING_SESSION SISL_SETTING_SESSIONCLASS_".concat(e.session.sessionClass),settings:e.session.settings,params:e.session.params,paramGroups:e.session.paramGroups,submitSettings:me.updateSessionSettings,undoSettings:me.undoSessionSettings})}):"methods"===r&&(u=Object(je.jsx)("div",{style:{padding:20,flex:1},className:"scrollView",children:Object(je.jsx)(sn,{shortcuts:e.session.shortcuts,applyMethod:function(e){return me.callSessionShortcut(e)}})})),Object(je.jsxs)("div",{style:Object(S.a)(Object(S.a)({},e.style),{},{height:"100%",display:"flex",flexDirection:"column"}),children:[Object(je.jsxs)(Qt.a,{style:{backgroundColor:"#cccccc",justifyContent:"space-between"},children:[Object(je.jsxs)("div",{children:[Object(je.jsx)(fe.a,{color:"inherit",style:{backgroundColor:"settings"===r?"whitesmoke":void 0,marginRight:10},onClick:function(){return l("settings")},children:"SETTINGS"}),Object(je.jsx)(fe.a,{color:"inherit",style:{backgroundColor:"methods"===r?"whitesmoke":void 0},onClick:function(){return l("methods")},children:"METHODS"})]}),Object(je.jsxs)("div",{children:[Object(je.jsx)(fe.a,{color:"inherit","data-tip":"Download current session as a file",onClick:wn,children:"DOWNLOAD"}),Object(je.jsx)(fe.a,{color:"inherit","data-tip":"Save current session",onClick:function(){return function(e){var t=prompt("Please provide the path to save the session.\n\nRoot directory:\n"+e.settings.root_dir);t&&me.saveSession(t)}(e.session)},children:"SAVE"}),Object(je.jsx)(fe.a,{color:"inherit",children:Object(je.jsx)(Ie,{placeholder:"LOAD",onChange:kn})})]})]}),u,Object(je.jsx)(se.a,{multiline:!0,effect:"solid",disable:!!e.session.settings&&!e.session.settings.showTooltips})]})})),En=n(323),An=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;return Object(q.a)(this,n),(s=t.call(this,e)).state={connected:me.socket.connected},s}return Object(K.a)(n,[{key:"componentDidMount",value:function(){var e=this;me.onConnect((function(){return e.setState({connected:!0})})),me.onDisconnect((function(){return e.setState({connected:!1})}))}},{key:"render",value:function(){var e=this.state.connected?{backgroundColor:"lightgreen"}:{backgroundColor:"salmon"},t=this.state.connected?this.props.connectedStyle:this.props.disconnectedStyle;return Object(je.jsx)("div",Object(S.a)(Object(S.a)({},this.props),{},{style:Object(S.a)(Object(S.a)(Object(S.a)({},e),this.props.style),t),"data-tip":this.state.connected?"Connected to ".concat(me.apiAddress):"Currently not connected","data-place":"left","data-background-color":e.backgroundColor,children:this.state.connected?Object(je.jsx)(En.a,{color:"green",size:20}):Object(je.jsx)(En.b,{color:"darkred",size:20})}))}}]),n}(s.Component),In=(n(1237),["children","value","index"]);function Nn(e){var t=e.children,n=e.value,s=e.index,i=Object(B.a)(e,In);return Object(je.jsx)("div",Object(S.a)(Object(S.a)({role:"tabpanel",hidden:n!==s,id:"simple-tabpanel-".concat(s),"aria-labelledby":"simple-tab-".concat(s),style:{flex:1,height:"100%"}},i),{},{children:n===s&&Object(je.jsx)(H.a,{sx:{width:"100%",height:"100%"},children:t})}))}function Ln(e){return{id:"simple-tab-".concat(e),"aria-controls":"simple-tabpanel-".concat(e)}}function Dn(){var e=s.useState(1),t=Object(z.a)(e,2),n=t[0],i=t[1];return Object(je.jsxs)(H.a,{sx:{flexGrow:1,display:"flex",height:"100vh"},children:[Object(je.jsxs)(H.a,{sx:{bgcolor:"background.paper"},children:[Object(je.jsx)(An,{connectedStyle:{backgroundColor:"lightgreen",display:"none"},style:{padding:10}}),Object(je.jsxs)(U.a,{orientation:"vertical",variant:"scrollable",value:n,onChange:function(e,t){i(t)},"aria-label":"Main app tabs",sx:{borderRight:1,borderColor:"divider"},children:[Object(je.jsx)(W.a,Object(S.a)({label:"Session"},Ln(0))),Object(je.jsx)(W.a,Object(S.a)({label:"Plotting"},Ln(1))),Object(je.jsx)(W.a,Object(S.a)({label:"Sisl docs"},Ln(2)))]})]}),Object(je.jsx)(Nn,{value:n,index:0,children:Object(je.jsx)(_n,{})}),Object(je.jsx)(Nn,{value:n,index:1,children:Object(je.jsx)(yn,{})}),Object(je.jsx)(Nn,{value:n,index:2,children:Object(je.jsx)(Sn,{})}),Object(je.jsx)(de.a,{})]})}var Rn=function(e){Object(Y.a)(n,e);var t=Object(X.a)(n);function n(e){var s;return Object(q.a)(this,n),(s=t.call(this,e)).syncWithSession=function(e){if(!e)return me.askForSession();s.props.setCurrentSession(e)},document.addEventListener("syncWithSession",(function(e){return s.syncWithSession(e.detail.session)})),document.addEventListener("updateTabs",(function(){return s.syncWithSession()})),document.addEventListener("plot",(function(t){var n=t.detail.plot;e.addPlots(Object(E.a)({},n.id,n))})),document.addEventListener("newPlot",(function(){return s.syncWithSession()})),document.addEventListener("sessionUpdate",(function(e){e.detail.justUpdated.forEach((function(e){me.getPlot(e)}))})),s}return Object(K.a)(n,[{key:"render",value:function(){return null}}]),n}(s.Component),Mn={setCurrentSession:function(e){return{type:f,session:e}},setActiveTab:ce,setSessionTabs:oe,setActivePlot:ae,addPlots:ie,setNewStructures:function(e){return{type:p,newStructures:e}},setNewPlotables:function(e){return{type:b,newPlotables:e}},setActivePage:re},Gn=Object(G.b)((function(e){return{plots:e.plots,structures:e.session.structures,tabs:e.session.tabs,active:e.active,session:e.session}}),Mn)(Rn),Fn=M(),zn=Fn.store,Bn=Fn.persistor;var Un=function(){return Object(je.jsx)(G.a,{store:zn,children:Object(je.jsxs)(F.a,{persistor:Bn,children:[Object(je.jsx)(Gn,{}),Object(je.jsx)("div",{className:"App",style:{display:"flex",flexDirection:"column"},children:Object(je.jsx)("div",{className:"appContent",style:{height:"100vh"},children:Object(je.jsx)(Dn,{})})})]})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a.a.render(Object(je.jsx)(Un,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},521:function(e,t,n){},522:function(e,t,n){},523:function(e,t,n){}},[[1238,1,2]]]);
//# sourceMappingURL=main.839575ce.chunk.js.map