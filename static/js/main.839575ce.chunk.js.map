{"version":3,"sources":["redux/actions/actionTypes.js","redux/reducers/session.js","redux/reducers/plots.js","redux/reducers/active.js","redux/reducers/loading.js","redux/reducers/persist.js","redux/reducers/index.js","redux/store/index.js","redux/actions/index.js","components/settings/inputFields/TextInput.tsx","components/prompts/Prompt.js","apis/PythonApi.js","utils/hotkeys.js","components/plots/PlotCard.js","components/settings/inputFields/Files.tsx","components/controls/Controls.js","components/controls/NavigateButton.js","components/structures/Tag.tsx","components/structures/pickerContext.tsx","components/structures/StructurePicker.tsx","components/plots/PlotDashboard.js","components/settings/inputFields/Dropdown.tsx","components/plotInitializer/PlotTypePicker.tsx","components/plotInitializer/TabPicker.tsx","components/plotInitializer/StructureRow.tsx","components/plotInitializer/MergeMethodPicker.tsx","components/plotInitializer/StructuresGroup.tsx","components/plotInitializer/PlotableRow.tsx","components/plotInitializer/PlotInitializer.tsx","components/settings/inputFields/Switch.tsx","components/settings/inputFields/ColorPicker.tsx","components/settings/inputFields/RangeSlider.tsx","components/settings/inputFields/Range.tsx","components/settings/inputFields/Numeric.tsx","components/settings/inputFields/Array.tsx","components/settings/inputFields/List.tsx","components/settings/InputField.tsx","components/settings/inputFields/CreatableDropown.tsx","components/settings/inputFields/DictInput.tsx","components/settings/inputFields/CreatableDict.tsx","components/settings/SettingsContainer.tsx","pages/PlotTweaking.tsx","components/pythonMethods/Method.tsx","components/pythonMethods/Methods.tsx","pages/PlotMethods.tsx","pages/PlotEditor.js","components/tabs/Tab.tsx","components/tabs/Tabs.js","pages/Plots.js","pages/SislDocs.js","components/loading/NotConnected.js","pages/Session.tsx","components/controls/ConnectionStatus.js","pages/MainPage.js","pages/Syncronizer.js","App.tsx","serviceWorker.js","index.js"],"names":["ADD_PLOTS","REMOVE_PLOT","SET_STRUCTURES","SET_PLOTABLES","SET_ACTIVE_PLOT","SET_ACTIVE_TAB","SET_SESSION","CLEAR_SESSION","START_LOADING_PLOT","END_LOADING_PLOT","SET_ACTIVE_PAGE","defaultState","session","state","action","type","plots","newState","console","log","newPlots","_","omit","plotID","plot","undefined","tab","structs","plotables","page","active","activeTab","activeTabInSession","find","tabs","anyTab","length","id","pageName","loading","from","Date","persist","key","whitelist","reducer","persistReducer","storage","combineReducers","browser","createResponsiveStateReducer","small","medium","selectActivePlot","getStoreAndPersistor","store","createStore","rootReducer","responsiveStoreEnhancer","persistor","persistStore","addPlots","tabsIDs","setSessionTabs","setActivePlot","setActiveTab","setActivePage","Text","props","value","TextField","variant","onChange","e","target","label","style","width","inputField","params","Prompt","controlClose","closeToast","this","callback","paddingBottom","content","TextInput","setState","inputProps","Button","onClick","Component","prompt","toast","autoClose","closeOnClick","onClose","arg","warn","connect","address","apiAddress","externalListeners","socket","io","listeners","forEach","listener","on","connectionTimeOut","setTimeout","currentAddress","newAddress","trim","connected","disconnect","close","onConnect","args","push","onDisconnect","setupListeners","clearTimeout","requestSession","reason","askForAuth","err","handleError","error","document","dispatchEvent","CustomEvent","detail","info","authenticating","toastPrompt","username","emit","path","loadSession","loadSessionFromFile","file","name","getSessionFile","once","sessionfile","newProcessId","uuidv4","_sessionMethod","methodName","kwargs","callSessionShortcut","sequence","updateSessionSettings","newSettings","undoSessionSettings","addTab","tabName","removeTab","tabID","updateTab","newParams","setTabLayouts","layouts","saveSession","getPlot","plot_id","newPlot","newPlotKwargs","removePlot","movePlot","mergePlots","plotIDs","to","_plotMethod","showPlotFullScreen","updatePlotSettings","settings","undoPlotSettings","updatePlotLayout","layoutUpdates","updateFigure","layout","data","frames","overwrite","callPlotShortcut","dispatchPlotEvent","event","savePlot","plotFile","user","api","GLOBAL_HOT_KEYS","SHOW_AVAIL_HOTKEYS","GO_TO_SETTINGS","GO_TO_DASHBOARD","GO_TO_MOLECULEVIEWER","SAVE_SESSION","sequences","LOAD_SESSION","TABS_HOT_KEYS","global","MOVE_TO_NEXT_TAB","MOVE_TO_PREVIOUS_TAB","NEW_TAB","TRY","PLOT_CARD_HOT_KEYS","GO_TO_PLOT_SETTINGSEDITING","GO_TO_PLOT_LAYOUTEDITING","GO_TO_PLOT_METHODS","FULL_SCREEN","UNDO_PLOT_SETTINGS","PlotCard","hotKeys","querySelectorAll","hotKeysHandlers","goToPlotLayoutEditing","goToPlotSettingsEditing","goToPlotMethods","undoSettings","shortcuts","PythonApi","handlePlotClick","points","handlePlotRelayout","keys","Object","includes","setPlotAsActive","togglePlotAsActive","isActivePlot","rootDir","isLoading","editable","addEventListener","cou","Math","random","Card","className","borderRadius","figure","backColor","paper_bgcolor","hotKeysKeyMap","TESTING","reduce","plotShortcuts","shortcut","replace","activeStyles","component","elevation","keyMap","handlers","allowChanges","height","display","flexDirection","overflow","background","paddingTop","flex","ref","plotlyRef","useResizeHandler","autosize","title","onRelayout","onUpdate","config","responsive","paddingLeft","paddingRight","marginBottom","Provider","size","margin","color","textAlign","IconButton","effect","place","disable","showTooltips","mapDispatchToProps","FilesInput","placeholder","onDrop","useCallback","files","useDropzone","getRootProps","getInputProps","useStyles","makeStyles","theme","root","transform","flexGrow","exampleWrapper","position","marginTop","spacing","radioGroup","speedDial","bottom","right","top","left","SpeedDials","classes","direction","React","useState","open","setOpen","hidden","SpeedDial","ariaLabel","icon","SpeedDialIcon","onOpen","actions","map","SpeedDialAction","tooltipTitle","tip","tooltipPlacement","href","Controls","hotKeysHandler","saveCurrentSession","syncWithSession","showPage","Control","tooltip","floating","ROUTES","hotKey","NavigateButton","route","PlotableTag","selected","toggle","plotable","fontSize","split","slice","StructureTag","structure","defaultPickerParams","searchString","alphabeticSorting","selectedSorting","searchByFolder","displayStructures","displayPlotables","PickerParamsContext","createContext","pickerParams","setPickerParams","toggleParam","defaultPickerSelected","structures","PickerSelectedContext","pickerSelected","nChanges","setPickerSelected","toggleSelectedObject","what","objectId","filterSelected","objects","filter","obj","unselect","ids","StructurePickerProvider","nChangesSelected","useRef","pickerValue","useMemo","newVal","currVal","selectedValue","current","toSelect","xor","children","filterStructs","toggles","object","index","isPlotable","structID","str","struct","toTest","RegExp","test","NoStructuresMessage","NoMatchingStructuresMessage","StructurePicker","useContext","filteredObjs","structsAndPlotables","values","orderBy","isSelected","backgroundColor","justifyContent","alignItems","marginRight","cursor","onDisplay","onDisplaySelected","intersection","displayedStructs","displayedPlotables","newSelectedStructs","newSelectedPlotables","plotableID","ResponsiveReactGridLayout","WidthProvider","Responsive","selectedPlotStyles","PlotDashboard","currentBreakpoint","compactType","mounted","lg","emptyDashboard","noTabsMessage","noPlotsMessage","fontWeight","padding","toggleSelected","onBreakpointChange","breakpoint","onResizeStop","finalL","initL","i","higher","h","shouldComponentUpdate","newProps","_plotsInLayout","hasDifferentPlots","isDifferentTab","newTab","isEqual","onLayoutChange","elemParams","alert","JSON","stringify","plotFiles","acceptedFiles","getLayout","newPlotLayout","draggableCancel","measureBeforeMount","useCSSTransforms","preventCollision","rowHeight","generateDOM","removePlots","movePlots","iTab","findIndex","renderSelectedManager","nSelected","Paper","merge","toggleSelect","l","ctrlKey","flexWrap","minWidth","borderRight","Files","defaultProps","cols","md","sm","xs","xxs","x","grid_dims","y","w","setTabPlots","withHotKeys","Dropdown","disableClearable","isClearable","freeSolo","isCreatable","multiple","isMulti","options","getValueFromObj","Array","isArray","sanitizeValue","getObjFromValue","Autocomplete","fullWidth","getOptionLabel","option","renderInput","plotOptions","StructureRow","groupActive","marginLeft","moveStructToActiveGroup","OPTIONS","MergeMethodPicker","StructuresGroup","initializingOptions","plotClasses","mergeMethod","activenessStyles","splitGroup","removeGroup","setGroupAsActive","Grid","container","transition","borderTopLeftRadius","item","val","onInitParamChange","PlotableRow","default_plot","selectPlots","plotOption","newGroup","groupParams","markActiveGroup","iGroup","groups","group","NothingToPlotMessage","informLoadingPlot","informLoadedPlot","selectedStructures","structureGroups","setStructureGroups","plotablesPlots","setPlotablesPlots","defaultTabID","selPlotables","selStructures","newStructureGroups","nChangesRef","prevSelectedStructures","prevStructs","newStructs","concat","cleanGroups","updateGroupInitParams","g","splitted","addGroup","endIcon","plotType","plotable_path","plot_method","animation","plotClass","SwitchInput","setting","Switch","checked","ColorPicker","tempcolor","setTempcolor","showColorPicker","setShowColorPicker","colorPicker","hex","onChangeComplete","RangeSlider","min","max","step","marks","Slider","getAriaLabel","valueLabelDisplay","Range","handleChange","oldValue","number","valid","finalVal","Numeric","additionalProps","ArrayInput","handleNone","shape","fill","orientationStyles","vertical","inputStyle","cloneDeep","changeValue","DragHandle","SortableHandle","SortableItem","SortableElement","sortable","remove","SortableList","SortableContainer","sanitizeVal","INPUT_FIELDS","textinput","bool","dict","fields","field","onValueChange","paramKey","paramValue","new_cat_value","setNewCatValue","creatable_fields","getParam","onItemChange","renderItem","param","deleteItem","default","addNewItem","rangeslider","range","vector","list","onSortEnd","arrayMove","oldIndex","newIndex","useDragHandle","removeItem","itemInput","Number","changeSettingValue","newValue","changeSettings","onSettingChangeType","onSettingChangeExtraParams","actionType","settingKey","extraParams","InputComponent","fieldLayout","tooltipParams","help","stopPropagation","SettingsForm","changedFields","setChangedFields","paramGroup","settingsGroup","groupedParams","subGrouped","groupBy","nullSubGroup","description","subGroups","enableReinitialize","initialValues","onSubmit","submitSettings","fromEntries","entries","handleSubmit","setFieldValue","resetForm","parse","SettingGroupsCollapse","groupKey","Icon","SettingsContainer","paramGroups","iParamGroup","activePlot","plotSettings","setsCont","mediaType","maxHeight","multiline","Method","ExpansionPanel","ExpansionPanelSummary","ExpansionPanelDetails","ExpansionPanelActions","applyMethod","Methods","PlotEditor","UNDO_SETTINGS","SUBMIT_ALL_SETTINGS","unsubmittedSettings","plotly","debug","advancedTraceTypeSelector","Tab","selectTab","contentEditable","onBlur","blur","textContent","updateTabName","Tabs","moveThroughTabs","newI","updateTabs","TabComponent","tabComponent","NewTabComponent","newTabComponent","noTabsComponent","configure","logLevel","simulateMissingKeyPressEvents","setEditable","defaultValue","onKeyPress","onDoubleClick","NewTabButton","Plots","n","k","selectedRef","getApplicationKeyMap","MainComponent","PlotTweaking","PlotMethods","PlotInitializer","Toolbar","goto","getWindowDimensions","window","innerWidth","innerHeight","SislDocs","windowDimensions","setWindowDimensions","useEffect","handleResize","removeEventListener","useWindowDimensions","src","Box","mesh","hovered","setHover","setActive","useFrame","rotation","scale","onPointerOver","onPointerOut","attach","NotConnected","sign","sessionFile","downloadSession","blob","Blob","url","URL","createObjectURL","link","createElement","setAttribute","click","setConnected","tabKey","setTabKey","camera","isEmpty","sessionClass","currentSession","root_dir","ConnectionStatus","addStyles","connectedStyle","disconnectedStyle","TabPanel","other","role","sx","a11yProps","MainPage","setValue","bgcolor","orientation","borderColor","Syncronizer","askForSession","setCurrentSession","justUpdated","setNewStructures","newStructures","setNewPlotables","newPlotables","App","Boolean","location","hostname","match","ReactDOM","render","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"iNAAaA,EAAY,YACZC,EAAc,cAEdC,EAAiB,iBACjBC,EAAgB,gBAIhBC,EAAkB,kBAClBC,EAAiB,iBAEjBC,EAAc,cACdC,EAAgB,gBAChBC,EAAqB,qBACrBC,EAAmB,mBACnBC,EAAkB,kBCbzBC,EAAe,GAkBNC,EAhBC,WAAmC,IAAlCC,EAAiC,uDAAzBF,EAAcG,EAAW,uCAE9C,OAAQA,EAAOC,MACX,KAAKT,EAGD,OAFWQ,EAAOF,QAItB,KAAKL,EACD,OAAOI,EAEX,QACI,OAAOE,I,wBCbbF,EAAe,GAyBNK,EAvBD,WAAmC,IACzCC,EADOJ,EAAiC,uDAAzBF,EAAcG,EAAW,uCAE5C,OAAQA,EAAOC,MACX,KAAKf,EAOD,OANAkB,QAAQC,IAAI,gCACZF,EAAQ,2BACDJ,GACAC,EAAOM,UAEdF,QAAQC,IAAIF,GACLA,EAEX,KAAKhB,EACD,OAAOoB,IAAEC,KAAKT,EAAO,CAACC,EAAOS,SAEjC,KAAKhB,EACD,OAAOI,EAEX,QACI,OAAOE,ICZbF,EAAe,CAACa,UAAMC,EAAWC,SAAKD,EAAWE,QAAS,GAAIC,UAAU,GAAIC,KAAM,SA6DzEC,EA3DA,WAAmC,IAC1Cb,EADQJ,EAAiC,uDAAzBF,EAAcG,EAAW,uCAE7C,OAAQA,EAAOC,MACX,KAAKX,EAOD,OANAc,QAAQC,IAAI,iCACZF,EAAQ,2BACDJ,GADC,IAEJW,KAAMV,EAAOS,SAEjBL,QAAQC,IAAIF,GACLA,EAEX,KAAKZ,EAOD,OANAa,QAAQC,IAAI,gCACZF,EAAQ,2BACDJ,GADC,IAEJa,IAAKZ,EAAOiB,YAEhBb,QAAQC,IAAIF,GACLA,EAEX,KAAKX,EAED,IAAM0B,EAAqBX,IAAEY,KAAKnB,EAAOF,QAAQsB,KAAM,CAAC,KAAMrB,EAAMa,MAC9DS,EAASrB,EAAOF,QAAQsB,KAAKE,OAAS,EAE5C,OAAIJ,EACOnB,EACAsB,EACA,2BAAItB,GAAX,IAAkBa,IAAKZ,EAAOF,QAAQsB,KAAK,GAAGG,KAEvC,2BAAKxB,GAAZ,IAAmBa,IAAK,OAGhC,KAAKxB,EAED,OAAO,2BAAKW,GAAZ,IAAmBc,QAAS,KAEhC,KAAKjB,EAOD,OALAO,EAAQ,2BACDJ,GADC,IAEJgB,KAAMf,EAAOwB,WAKrB,KAAKnC,EAED,OAAO,2BAAKU,GAAZ,IAAmBe,UAAW,KAElC,KAAKrB,EACD,OAAOI,EAEX,QACI,OAAOE,I,QC9BJ0B,EAhCC,WAAiC,IACzCtB,EADSJ,EAA+B,uDAAvB,CAACG,MAAM,IAAKF,EAAW,uCAE5C,OAAQA,EAAOC,MACX,KAAKP,EAaD,OAZAU,QAAQC,IAAI,iCACZF,EAAQ,2BACDJ,GADC,IAEJG,MAAM,2BACCH,EAAMG,OADR,kBAEAF,EAAOU,KAAKa,GAFZ,2BAGMvB,EAAOU,MAHb,IAIGgB,KAAM,IAAIC,WAItBvB,QAAQC,IAAIF,GACLA,EAEX,KAAKR,EAOD,OANAS,QAAQC,IAAI,yDACZF,EAAQ,2BACDJ,GADC,IAEJG,MAAOK,IAAEC,KAAKT,EAAMG,MAAO,CAACF,EAAOS,WAEvCL,QAAQC,IAAIF,GACLA,EAEX,QACI,OAAOJ,I,kBCjCZ,SAAS6B,EAAQC,EAAKC,EAAWC,GACpC,OAAOC,YAAe,CAClBH,MACAI,YACAH,aACDC,GCEQG,kBAAgB,CAC3BpC,UACAI,QACAuB,QAASG,EAAQ,UAAW,CAAC,SAAUH,GACvCT,OAAQY,EAAS,SAAU,CAAC,MAAO,QAASZ,GAC5CmB,QAASC,YAA6B,CAClCC,MAAO,IACPC,OAAQ,QAIHC,EAAmB,SAACxC,GAC7B,OAAOA,EAAMG,MAAMH,EAAMiB,OAAON,OCRrB8B,EAPc,WAC3B,IAAIC,EAAQC,YAAYC,EAAaC,KAGrC,MAAO,CAAEH,QAAOI,UAFAC,YAAaL,K,6KCiBlBM,GAAW,SAACzC,EAAU0C,GAAX,MAAwB,CAC5C/C,KAAMf,EACNoB,WACA0C,YAgCSC,GAAiB,SAAC7B,GAAD,MAAW,CACrCnB,KRvD4B,mBQwD5BmB,SAGS8B,GAAgB,SAACxC,GAAD,MAAW,CACpCT,KAAMX,EACNmB,OAAQC,EAAuB,iBAATA,EAAoBA,EAAOA,EAAKa,QAAKZ,IAGlDwC,GAAe,SAACvC,GAAD,MAAU,CAClCX,KAAMV,EACN0B,UAAWL,IAiBFwC,GAAgB,SAAC5B,GAAD,MAAe,CACxCvB,KAAML,EACN4B,a,6DCzEW6B,GAd0B,SAAAC,GACrC,IAAMC,EAAQD,EAAMC,OAAS,GAE7B,OACI,eAACC,GAAA,EAAD,aACIC,QAAQ,WACRF,MAAOA,EACPG,SAAU,SAACC,GAAD,OAAOL,EAAMI,SAASC,EAAEC,OAAOL,QACzCM,MAAOP,EAAMO,MACbC,MAAK,aAAGC,MAAO,QAAWT,EAAMQ,QAC3BR,EAAMU,WAAaV,EAAMU,WAAWC,OAAS,M,WCRjDC,GAAb,kDAEI,WAAYZ,GAAO,IAAD,8BACd,cAAMA,IAEDvD,MAAQ,CACTwD,MAAO,IAGPD,EAAMa,cACNb,EAAMa,aAAab,EAAMc,YARf,EAFtB,wDAcI,WACIC,KAAKf,MAAMgB,SAASD,KAAKtE,MAAMwD,SAfvC,oBAkBI,WAAU,IAAD,OACL,OACI,iCACI,sBAAKO,MAAO,CAACS,cAAe,IAA5B,SAAkCF,KAAKf,MAAMkB,UAC7C,eAACC,GAAD,CAAWlB,MAAOc,KAAKtE,MAAMwD,MAAOG,SAAU,SAACH,GAAW,EAAKmB,SAAS,CAACnB,WAAUM,MAAOQ,KAAKf,MAAMqB,WAAWd,QAChH,eAACe,GAAA,EAAD,CAAQC,QAASR,KAAKf,MAAMc,WAA5B,2BAvBhB,GAA4BU,aA8BtBC,GAAS,SAACP,EAASF,EAAUhB,GAE/B0B,aAAM,eAAC,GAAD,aAAQR,QAASA,EAASF,SAAUA,GAAchB,IAAU,CAAC2B,WAAW,EAAOC,cAAc,EAAOC,QAAS,SAACC,GAAShF,QAAQiF,KAAKD,OA2B/HL,MC8MA,OAxQX,aAAe,IAAD,gCAiBdO,QAAU,SAACC,GAEHA,IAAS,EAAKC,WAAaD,GAE/B,EAAKE,kBAAoB,GAEzB,EAAKC,OAASC,KAAG,EAAKH,YACtB,EAAKI,UAAUC,SAAQ,SAAAC,GAAQ,aAAI,IAAKJ,QAAOK,GAAZ,oBAAkBD,OAGrD,EAAKE,kBAAoBC,YAAW,WDQZ,IAACC,EAAgB5B,EAAUhB,EAA1B4C,ECNJ,EAAKV,WDMelB,ECNH,SAAC6B,GAC3BA,IACA,EAAKX,WAAaW,EAAWC,QAE5B,EAAKV,OAAOW,YACb,EAAKC,aACL,EAAKhB,YDAkChC,ECG5C,CAACa,aAAc,SAACoC,GAAD,OAAW,EAAKC,UAAUD,KDKpDxB,GANgB,iCACZ,+BAAM,uBAAyBmB,IAC/B,2FACA,6DAGY5B,EAAV,aAAqBK,WAAY,CAACd,MAAO,gBAAoBP,MCH5D,KAEH,EAAKoC,OAAOJ,WA1CF,KA8CdgB,WAAa,WACT,EAAKZ,OAAOY,cA/CF,KAkDdP,GAAK,WAAc,IAAD,uBAATU,EAAS,yBAATA,EAAS,gBAEG,IAAD,EAAZ,EAAKf,SACL,IAAKA,QAAOK,GAAZ,QAAkBU,GAItB,EAAKb,UAAUc,KAAKD,IAzDV,KA4DdD,UAAY,WAAc,IAAD,uBAATC,EAAS,yBAATA,EAAS,gBACrB,EAAKV,GAAL,QAAI,CAAI,WAAJ,OAAkBU,KA7DZ,KAgEdE,aAAe,WAAc,IAAD,uBAATF,EAAS,yBAATA,EAAS,gBACxB,EAAKV,GAAL,QAAI,CAAI,cAAJ,OAAqBU,KAjEf,KAoEdG,eAAiB,WAEb,EAAKb,GAAG,WAAW,WAEfc,aAAa,EAAKb,mBAClB,EAAKc,oBAGT,EAAKf,GAAG,cAAc,SAACgB,GACnB3G,QAAQiF,KAAK0B,GACb,EAAKT,aACL,EAAKhB,aAGT,EAAKS,GAAG,gBAAiB,EAAKiB,YAE9B,EAAKjB,GAAG,YAAa,EAAKe,gBAE1B,EAAKf,GAAG,SAAS,SAACkB,GAAD,OAAS,EAAKC,YAAYD,EAAK,aAEhD,EAAKlB,GAAG,gBAAgB,SAACkB,GAAD,OAAS,EAAKC,YAAYD,EAAK,aAEvD,EAAKlB,GAAG,mBAAmB,SAACjG,GACxBM,QAAQ+G,MAAMrH,GACdsH,SAASC,cAAc,IAAIC,YAAY,kBAAmB,CAAEC,OAAQ,CAAEzH,iBAG1E,EAAKiG,GAAG,gBAAgB,SAACyB,GACrBJ,SAASC,cAAc,IAAIC,YAAY,cAAe,CAAEC,OAAQC,QAGpE,EAAKzB,GAAG,QAAQ,SAACrF,GACb0G,SAASC,cAAc,IAAIC,YAAY,OAAQ,CAAEC,OAAQ,CAAE7G,eApGrD,KAyGdwG,YAAc,SAACD,EAAKhH,GACH,WAATA,EACA+E,KAAMmC,MAAM,8BAAgCF,GAE5CjC,KAAMmC,MAAMF,IA7GN,KAkHdD,WAAa,WAEL,EAAKS,iBAET,EAAKA,gBAAiB,EACtBC,IAAY,SAACC,GACT,EAAKjC,OAAOkC,KAAK,QAASD,GAC1B,EAAKF,gBAAiB,OAzHhB,KA6HdX,eAAiB,SAACe,GACd,EAAKnC,OAAOkC,KAAK,kBAAmBC,IA9H1B,KAiIdC,YAAc,SAACD,GACX,EAAKf,eAAee,IAlIV,KAqIdE,oBAAsB,SAACC,GACnB,EAAKtC,OAAOkC,KAAK,yBAA0BI,EAAMA,EAAKC,OAtI5C,KAyIdC,eAAiB,SAAC5D,GAEd,EAAKoB,OAAOyC,KAAK,gBAAgB,SAACC,GAC9B9D,EAAS8D,MAGb,EAAK1C,OAAOkC,KAAK,qBA/IP,KAkJdS,aAAeC,KAlJD,KAoJdC,eAAiB,SAACC,EAAYC,EAAQnE,GAAsB,IAAC,IAAD,qBAATmC,EAAS,iCAATA,EAAS,mBAkBxD,IAAKf,QAAOkC,KAAZ,SAAiB,0BAA2BY,EAAYC,GAAxD,OAAmEhC,KAtKzD,KAyKdiC,oBAAsB,SAACC,GACnB,EAAKJ,eAAe,gBAAiB,KAAM,KAAMI,IA1KvC,KA6KdC,sBAAwB,SAACC,GACrB,EAAKN,eAAe,kBAAmBM,IA9K7B,KAiLdC,oBAAsB,WAClB,EAAKP,eAAe,kBAlLV,KAqLdQ,OAAS,SAACC,GACN,EAAKT,eAAe,UAAW,CAACN,KAAMe,KAtL5B,KAyLdC,UAAY,SAACC,GACT,EAAKX,eAAe,aAAc,CAACW,WA1LzB,KA6LdC,UAAY,SAACD,EAAOE,GAChB,EAAKb,eAAe,aAAc,CAAEW,QAAOE,eA9LjC,KAiMdC,cAAgB,SAACH,EAAOI,GACpB,EAAKH,UAAUD,EAAO,CAACI,aAlMb,KAqMdC,YAAc,SAAC1B,GACX,EAAKU,eAAe,OAAQ,CAACV,UAtMnB,KAyMd2B,QAAU,SAAC/I,GACP2G,SAASC,cAAc,IAAIC,YAAY,eAAgB,CAACC,OAAQ,CAACkC,QAAShJ,MAC1E,EAAKiF,OAAOkC,KAAK,WAAYnH,IA3MnB,KA8MdiJ,QAAU,SAACC,GACP,EAAKpB,eAAe,WAAYoB,IA/MtB,KAkNdC,WAAa,SAACnJ,GACV,EAAK8H,eAAe,cAAe,KAAM,KAAM9H,IAnNrC,KAsNdoJ,SAAW,SAACpJ,EAAQG,GAChB,EAAK2H,eAAe,YAAa,KAAM,KAAM9H,EAAQG,IAvN3C,KA0NdkJ,WAAa,SAACC,EAASC,GACnB,EAAKzB,eAAe,cAAe,CAACyB,MAAK,KAAMD,IA3NrC,KA8NdE,YAAc,SAACxJ,EAAQ+H,EAAYC,EAAQnE,GAAuB,IAAD,uBAATmC,EAAS,iCAATA,EAAS,kBAC7D,EAAK8B,eAAL,QAAI,CAAgB,mBAAoBE,EAAQnE,EAAU7D,EAAQ+H,GAA9D,OAA6E/B,KA/NvE,KAkOdyD,mBAAqB,SAACzJ,GAClB,EAAKwJ,YAAYxJ,EAAQ,SAnOf,KAsOd0J,mBAAqB,SAAC1J,EAAQ2J,GAC1B,EAAKH,YAAYxJ,EAAQ,kBAAmB2J,IAvOlC,KA0OdC,iBAAmB,SAAC5J,GAChB,EAAKwJ,YAAYxJ,EAAQ,kBA3Of,KA8Od6J,iBAAmB,SAAC7J,EAAQ8J,GACxB,EAAKN,YAAYxJ,EAAQ,gBAAiB8J,IA/OhC,KAkPdC,aAAe,SAAC/J,EAAD,GAAgD,IAAtCgK,EAAqC,EAArCA,OAAQC,EAA6B,EAA7BA,KAAMC,EAAuB,EAAvBA,OAAQC,EAAe,EAAfA,UAC3C,EAAKX,YAAYxJ,EAAQ,SAAU,CAACgK,SAAQC,OAAMC,SAAQC,eAnPhD,KAsPdC,iBAAmB,SAACpK,EAAQkI,GACxB,EAAKsB,YAAYxJ,EAAQ,gBAAiB,KAAM,KAAMkI,IAvP5C,KA0PdmC,kBAAoB,SAACrK,EAAQsK,EAAOL,GAChC,EAAKT,YAAYxJ,EAAQ,iBAAkBiK,EAAM,KAAMK,IA3P7C,KA8PdC,SAAW,SAACvK,EAAQoH,GAChB,EAAKoC,YAAYxJ,EAAQ,OAAQ,CAAEoH,KAAMA,KA/P/B,KAkQdoD,SAAW,SAACjD,GACR,EAAKtC,OAAOkC,KAAK,YAAaI,EAAMA,EAAKC,OAjQzC5D,KAAKmB,WAAa,wBAClBnB,KAAK6G,UAAOvK,EAEZ0D,KAAKuB,UAAY,GACjBvB,KAAKuC,iBAELvC,KAAKiB,UAKL8B,SAAS+D,IAAM9G,M,SCnBV+G,GAAkB,CAG3BC,mBAAmB,CACfpD,KAAM,yBACNU,SAAU,WAId2C,eAAgB,CACZrD,KAAM,iBACNU,SAAU,WAEd4C,gBAAiB,CACbtD,KAAM,6BACNU,SAAU,WAEd6C,qBAAsB,CAClBvD,KAAM,4BACNU,SAAU,WAId8C,aAAc,CACVxD,KAAM,eACNyD,UAAW,CAAC,eAAgB,eAEhCC,aAAc,CACV1D,KAAM,eACNyD,UAAW,CAAC,eAAgB,gBAmBvBE,GAAgB,CACzBC,OAAQ,CAEJC,iBAAkB,CACd7D,KAAM,mBACNU,SAAU,iBAEdoD,qBAAsB,CAClB9D,KAAM,uBACNU,SAAU,gBAEdqD,QAAS,CACL/D,KAAM,UACNU,SAAU,UACV3I,OAAQ,SAEZiM,IAAK,cAkBAC,GAAqB,CAE9BC,2BAA4B,CACxBlE,KAAM,+BACNU,SAAU,KAEdyD,yBAA0B,CACtBnE,KAAM,6BACNU,SAAU,KAEd0D,mBAAoB,CAChBpE,KAAM,6BACNU,SAAU,KAEd2D,YAAa,CACTrE,KAAM,+DACNU,SAAU,KAEdxJ,YAAa,CACT8I,KAAM,sBACNyD,UAAW,CAAC,MAAM,cAEtBa,mBAAoB,CAChBtE,KAAM,6BACNU,SAAU,W,WCtFZ6D,G,kDAEF,WAAYlJ,GAAO,IAAD,8BACd,cAAMA,IAQVmJ,QAAU,kBAAMrF,SAASsF,iBAAiB,qBATxB,EAWlBC,gBAAkB,CACdP,yBAA0B,kBAAM,EAAKQ,yBACrCT,2BAA4B,kBAAM,EAAKU,2BACvCR,mBAAoB,kBAAM,EAAKS,mBAC/BR,YAAa,kBAAM,EAAKpC,sBACxBqC,mBAAoB,kBAAM,EAAKQ,gBAC/B5N,YAAa,kBAAM,EAAKyK,eAjBV,EAoBlBiB,iBAAmB,SAAClC,GAChB3D,KAAMK,KAAK,YAAc,EAAK/B,MAAM5C,KAAKsM,UAAUrE,GAAUV,KAAO,aACpEgF,GAAUpC,iBAAiB,EAAKvH,MAAM5C,KAAKa,GAAIoH,IAtBjC,EAyBlBuE,gBAAkB,YAAe,IAAbC,EAAY,EAAZA,OACVzC,EAAOnK,IAAEC,KAAK2M,EAAO,GAAI,CAAC,OAAQ,WAAY,QAAS,UAC7D/M,QAAQiF,KAAKqF,GACbuC,GAAUnC,kBAAkB,EAAKxH,MAAM5C,KAAKa,GAAI,QAASmJ,IA5B3C,EA+BlB0C,mBAAqB,SAAC7C,GAClB,IAAIA,EAAc,gBAAlB,CAEA,IAAM8C,EAAOC,OAAOD,KAAK9C,GACrB8C,EAAKE,SAAS,aACO,IAAhBF,EAAK/L,QAEV2L,GAAU3C,iBAAiB,EAAKhH,MAAM5C,KAAKa,GAAIgJ,KAtCrC,EA0ClBwC,aAAe,WAEXE,GAAU5C,iBAAiB,EAAK/G,MAAM5C,KAAKa,KA5C7B,EAyDlBqI,WAAa,WACTqD,GAAUrD,WAAW,EAAKtG,MAAM5C,KAAKa,KA1DvB,EA6DlBsL,wBAA0B,WACtB,EAAKW,kBACL,EAAKlK,MAAMF,cAAc,iBA/DX,EAkElBwJ,sBAAwB,WACpB,EAAKY,kBACL,EAAKlK,MAAMF,cAAc,qBApEX,EAuElB0J,gBAAkB,WACd,EAAKU,kBACL,EAAKlK,MAAMF,cAAc,gBAzEX,EA4ElBoK,gBAAkB,WACd,EAAKlK,MAAMJ,cAAc,EAAKI,MAAM5C,OA7EtB,EAgFlB+M,mBAAqB,WACb,EAAKC,aACL,EAAKpK,MAAMJ,mBAAcvC,GAEzB,EAAK6M,mBApFK,EAwFlBxC,SAAW,WACP,IAAInD,EAAO9C,OAAO,iEAAmE,EAAKzB,MAAMxD,QAAQsK,SAASuD,SAC5G9F,GAELoF,GAAUjC,SAAS,EAAK1H,MAAM5C,KAAKa,GAAIsG,IA5FzB,EAmGlBqC,mBAAqB,WACjB+C,GAAU/C,mBAAmB,EAAK5G,MAAM5C,KAAKa,KAlG7C,EAAKxB,MAAQ,CACT6N,WAAW,EACXC,UAAU,GAJA,E,qDA+ClB,WAAoB,IAAD,OACfzG,SAAS0G,iBAAiB,cAAc,SAACnK,GAEjCA,EAAE4D,OAAOhG,KAAO,EAAK+B,MAAM5C,KAAKa,IAAsB,QAAhBoC,EAAE4D,OAAOhG,IAC/C,EAAKmD,SAAS,CAACqJ,IAAKC,KAAKC,gB,wBA4CrC,WACI,OAAO5J,KAAKf,MAAM5C,KAAKa,KAAO8C,KAAKf,MAAMtC,OAAON,O,oBAOpD,WAAU,IAAD,OAEL,GAAI2D,KAAKtE,MAAM6N,YAAcvJ,KAAKf,MAAM5C,KACpC,OACI,eAACwN,EAAA,EAAD,CACIC,UAAU,WACVrK,MAAO,CAACsK,aAAc,IAF1B,SAGI,4EAKZ,IAAM/J,KAAKf,MAAM5C,KAAK2N,OAClB,OACI,eAACH,EAAA,EAAD,CACIC,UAAU,WACVrK,MAAO,CAAEsK,aAAc,IAF3B,SAGI,oFAKZ,IAAI3D,EAASpG,KAAKf,MAAM5C,KAAK2N,OAAO5D,OAChC6D,EAAY7D,EAAO8D,eAAiB,QAElCC,EAAa,2BACZtC,IADY,IAEfuC,QAAS,WACNnB,OAAOD,KAAKhJ,KAAKf,MAAM5C,KAAKsM,WAAW0B,QAAO,SAACC,EAAehG,GAC7D,IAAIiG,EAAW,EAAKtL,MAAM5C,KAAKsM,UAAUrE,GACzC,MAAI,CAAC,SAAU,cAAc4E,SAAS5E,KAClCgG,EAAcC,EAAS3G,KAAK4G,QAAQ,KAAM,MAA1C,aACAlG,SAAUA,GACPiG,IAHiDD,IAMzD,KAGDhC,EAAe,2BACdtI,KAAKsI,iBACLW,OAAOD,KAAKhJ,KAAKf,MAAM5C,KAAKsM,WAAW0B,QAAO,SAACC,EAAehG,GAC7D,IAAIiG,EAAW,EAAKtL,MAAM5C,KAAKsM,UAAUrE,GACzC,MAAI,CAAC,SAAU,cAAc4E,SAAS5E,KACtCgG,EAAcC,EAAS3G,KAAK4G,QAAQ,KAAM,MAAQ,kBAAM,EAAKhE,iBAAiBlC,KADtBgG,IAGzD,KAGDG,GAAezK,KAAKqJ,aAItB,IAEJ,OAAO,gBAAC,WAAD,CACES,UAAU,kBAEVY,UAAWb,IACXc,UAAW3K,KAAKf,MAAM0L,WAAa,EACnCC,OAAQT,EAAeU,SAAUvC,EAAiBwC,cAAc,EAChErL,MAAK,yBAAIC,MAAO,OAAQqL,OAAQ,OAAQC,QAAS,OAAQC,cAAe,SAAUlB,aAAc,EAAGmB,SAAS,SAAUC,WAAYlB,EAAWmB,WAAY,GAAMX,GAAiBzK,KAAKf,MAAMQ,OAN7L,UAOC,sBAAKA,MAAO,CAAC4L,KAAK,GAAlB,SACI,eAAC,IAAD,CACIC,IAAK,SAAAC,GACD,EAAKA,UAAYA,GAErBC,kBAAgB,EAChB/L,MAAO,CAAEC,MAAO,OAAQqL,OAAQ,QAChC1E,KAAMrG,KAAKf,MAAM5C,KAAK2N,OAAO3D,KAC7BD,OAAM,aAAGqF,UAAU,EAAMC,MAAO,IAAOtF,GACvCE,OAAQtG,KAAKf,MAAM5C,KAAK2N,OAAO1D,OAC/B9F,QAASR,KAAK6I,gBACd8C,WAAY3L,KAAK+I,mBACjB6C,SAAU,SAAC5B,KACf6B,OAAQ,CAACrC,SAAUxJ,KAAKtE,MAAM8N,SAAUsC,YAAY,OAI5D,uBAAKrM,MAAO,CAAEuL,QAAS,OAAQe,YAAa,GAAIC,aAAc,GAAIb,WAAYlB,EAAWgC,aAAc,GAAInC,UAAU,cAArH,UACI,gBAAC,KAAYoC,SAAb,CAAsBhN,MAAO,CAAEiN,KAAM,GAAI1M,MAAO,CAAE2M,OAAQ,GAAKC,MAAO,WAAtE,UACI,sBAAK5M,MAAO,CAAC4L,KAAK,EAAGiB,UAAW,QAAhC,SACI,eAACC,GAAA,EAAD,CAAYJ,KAAK,QAAQ,WAAS,kBAAkB3L,QAASR,KAAK6F,mBAAlE,SAAsF,eAAC,IAAD,QAG1F,iCACI,eAAC0G,GAAA,EAAD,CACIJ,KAAK,QACL,WAAS,eACT3L,QAASR,KAAKwI,wBAHlB,SAG2C,eAAC,KAAD,MAC3C,eAAC+D,GAAA,EAAD,CACIJ,KAAK,QACL,WAAS,cACT3L,QAASR,KAAKyI,gBAHlB,SAGmC,eAAC,KAAD,MACnC,eAAC8D,GAAA,EAAD,CACIJ,KAAK,QACL,WAAS,WACT3L,QAAS,kBAAM,EAAKH,SAAS,CAACmJ,UAAW,EAAK9N,MAAM8N,YAHxD,SAGoE,eAAC,KAAD,MACpE,eAAC+C,GAAA,EAAD,CACIJ,KAAK,QACL,WAAS,kBACT3L,QAASR,KAAKuI,sBAHlB,SAGyC,eAAC,IAAD,MACzC,eAACgE,GAAA,EAAD,CAAYJ,KAAK,QAAQ,WAAS,0BAAlC,SAA4D,eAAC,KAAD,CAAQE,MAAM,WAC1E,eAACE,GAAA,EAAD,CAAYJ,KAAK,QAAQ,WAAS,4BAAlC,SAA8D,eAAC,IAAD,CAAiBE,MAAM,WACrF,eAACE,GAAA,EAAD,CAAYJ,KAAK,QAAQ,WAAS,gBAAgB3L,QAASR,KAAKuF,WAAhE,SAA4E,eAAC,IAAD,CAAiB8G,MAAM,gBAG3G,eAAC,KAAD,CAAcG,OAAO,QAAQC,MAAM,SAASC,UAAS1M,KAAKf,MAAMxD,QAAQsK,WAAY/F,KAAKf,MAAMxD,QAAQsK,SAAS4G,yB,GApNzGlM,aAgOjBmM,GAAqB,CACvBhO,kBACAC,iBACA0G,WLzNsB,SAACnJ,EAAQyI,GAAT,MAAoB,CAC1CjJ,KAAMd,EACNsB,SACAyI,UKuNA9F,iBACAL,aAGWuC,gBAdS,SAAAvF,GAAK,MAAK,CAC9BG,MAAOH,EAAMG,MACbc,OAAQjB,EAAMiB,OACdlB,QAASC,EAAMD,WAWqBmR,GAAzB3L,CAA6CkH,I,+CCtO7C0E,GAZwB,SAAC,GAAqC,IAApCC,EAAmC,EAAnCA,YAAazN,EAAsB,EAAtBA,SAAUI,EAAY,EAAZA,MACtDsN,EAASC,uBAAY,SAACC,GAAD,OAAmB5N,EAAS4N,KAAQ,CAAC5N,IAChE,EAAwC6N,uBAAY,CAAEH,WAA9CI,EAAR,EAAQA,aAAcC,EAAtB,EAAsBA,cAEtB,OACI,iDAASD,KAAT,IAAyB1N,MAAOA,EAAhC,UACI,sCAAW2N,MACX,6BAAIN,S,4CCHVO,GAAYC,cAAW,SAACC,GAAD,MAAY,CACrCC,KAAM,CACFC,UAAW,kBACXC,SAAU,GAEdC,eAAgB,CACZC,SAAU,WACVC,UAAWN,EAAMO,QAAQ,IAE7BC,WAAY,CACR3B,OAAQmB,EAAMO,QAAQ,EAAG,IAE7BE,UAAW,CACPJ,SAAU,WACV,2DAA4D,CACxDK,OAAQV,EAAMO,QAAQ,GACtBI,MAAOX,EAAMO,QAAQ,IAEzB,8DAA+D,CAC3DK,IAAKZ,EAAMO,QAAQ,GACnBM,KAAMb,EAAMO,QAAQ,SAKhC,SAASO,GAAWpP,GAChB,IAAMqP,EAAUjB,KACVkB,EAAYC,IAAMC,SAAS,QAAQ,GACzC,EAAwBD,IAAMC,UAAS,GAAvC,mBAAOC,EAAP,KAAaC,EAAb,KACMC,EAASJ,IAAMC,UAAS,GAAO,GAUrC,OACI,eAACI,GAAA,EAAD,CACIC,UAAU,oBACVhF,UAAWwE,EAAQN,UACnBY,OAAQA,EACRG,KAAM,eAACC,GAAA,EAAD,IACNlO,QAdY,WAChB6N,GAAQ,IAcJM,OAXW,WACfN,GAAQ,IAWJD,KAAMA,EACNH,UAAWA,EARf,SAUKtP,EAAMiQ,QAAQC,KAAI,SAACxT,GAAD,OACf,eAACyT,GAAA,EAAD,CAEIL,KAAMpT,EAAOoT,KACbM,aAAc1T,EAAO2T,KAAO3T,EAAOiI,KACnC2L,iBAAkB,MAClB/O,QAAS7E,EAAO6E,QAChBgP,KAAM7T,EAAO6T,MALR7T,EAAOiI,W,IAY1B6L,G,4MAEFC,eAAiB,CACbtI,aAAc,kBAAM,EAAKuI,sBACzBrI,aAAc,kBAAM,EAAK7D,gB,EAG7BmM,gBAAkB,SAACnU,GACfsH,SAASC,cAAc,IAAIC,YAAY,kBAAmB,CAACC,OAAQ,CAACzH,e,EAGxEoU,SAAW,SAAC1S,GACR,EAAK8B,MAAMF,cAAc5B,I,EAG7BwS,mBAAqB,WACjB,IAAInM,EAAO9C,OAAO,oEAAsE,EAAKzB,MAAMxD,QAAQsK,SAASuD,SAC/G9F,GAELoF,GAAU1D,YAAY1B,I,EAG1BC,YAAc,WAEV,IAAID,EAAO9C,OAAO,qEAAuE,EAAKzB,MAAMxD,QAAQsK,SAASuD,SAChH9F,GAELoF,GAAUnF,YAAYD,I,4CAG1B,WAEI,IAAM0L,EAAU,CAAC,CACbtL,KAAM,eACNmL,KAAM,eAAC,KAAD,CAAQ5C,KAAM,KACpB3L,QAASR,KAAK2P,oBACf,CACC/L,KAAM,eACFmL,KAAM,eAAC,IAAD,CAAiB5C,KAAM,KACjC3L,QAASR,KAAKyD,cAGlB,OAAO,eAAC4K,GAAD,CAAYa,QAASA,Q,GA1CbzO,aA8CVqP,GAAb,4JAEI,WAEI,OAAO,eAACvP,GAAA,EAAD,CACK,WAAUP,KAAKf,MAAM8Q,QACrBtQ,MAAOO,KAAKf,MAAMQ,MAClBuQ,UAAQ,EACRjB,KAAM/O,KAAKf,MAAM8P,KACjBvO,QAASR,KAAKf,MAAMuB,QACpBsJ,UAAW9J,KAAKf,MAAM6K,gBAV1C,GAA6BrJ,aAmBvBmM,GAAqB,CACvB7N,kB,IAGWkC,aATS,SAAAvF,GAAK,MAAK,CAC9BD,QAASC,EAAMD,QACfkB,OAAQjB,EAAMiB,UAOsBiQ,GAAzB3L,CAA6CwO,I,QC7I/CQ,GAAS,CAClBlK,SAAU,CACNnC,KAAM,WACNmL,KAAM,eAAC,KAAD,CAAc5C,KAAM,KAC1BE,MAAO,OACP6D,OAAQ,aAEZrU,MAAO,CACH+H,KAAM,YACNmL,KAAM,eAAC,KAAD,IACN1C,MAAO,OACP6D,OAAQ,cAIVC,G,4MAEFN,SAAW,WACP,EAAK5Q,MAAMF,cAAc,EAAKE,MAAM0G,K,4CAGxC,WAEI,IAAMyK,EAAQH,GAAOjQ,KAAKf,MAAM0G,IAEhC,OAAO,eAAC,GAAD,aACHoJ,KAAMqB,EAAMrB,KACZjF,UAAWsG,EAAM/D,MACjB0D,QAAS,SAAW/P,KAAKf,MAAM0G,GAAK,KAAOyK,EAAMF,OAAS,IAC1D1P,QAASR,KAAK6P,UACV7P,KAAKf,Y,GAfQwB,aAmBvBmM,GAAqB,CACvB7N,kBAGWkC,eAAQ,KAAM2L,GAAd3L,CAAkCkP,IChCpCE,GAAmC,SAACpR,GAC7C,OACI,uBACI6K,UAAW,gBAAkB7K,EAAMqR,SAAW,SAAW,IACzD9P,QAASvB,EAAMsR,OACf,WAAUtR,EAAMuR,SAAShN,KACzB,cAAY,QAJhB,UAKI,+BAAMvE,EAAMuR,SAAS5M,OACrB,sBAAKnE,MAAO,CAAEgR,SAAU,QAASpE,MAAO,QAAxC,SAAmD,OAASpN,EAAMuR,SAAShN,KAAKkN,MAAM,KAAKC,OAAO,GAAI,GAAG,SASxGC,GAAqC,SAAC3R,GAE/C,OACI,uBACI6K,UAAW,cAAgB7K,EAAMqR,SAAW,SAAW,IACvD9P,QAASvB,EAAMsR,OACf,WAAUtR,EAAM4R,UAAUrN,KAC1B,cAAY,QAJhB,UAKI,+BAAMvE,EAAM4R,UAAUjN,KAAK4G,QAAQ,OAAQ,MAC3C,sBAAK/K,MAAO,CAAEgR,SAAU,QAASpE,MAAO,QAAxC,SAAmD,OAASpN,EAAM4R,UAAUrN,KAAKkN,MAAM,KAAKC,OAAO,GAAI,GAAG,SC1BzGG,GAAoC,CAC7CC,aAAc,GACdC,mBAAmB,EACnBC,iBAAiB,EACjBC,gBAAgB,EAChBC,mBAAmB,EACnBC,kBAAkB,GAGTC,GAAsBC,wBAAc,CAC7CC,aAAcT,GACdU,gBAAiB,SAAC5R,KAClB6R,YAAa,SAAC7N,OAQL8N,GAAiD,CAC1DC,WAAY,GACZlV,UAAW,IAeR,IAAMmV,GAAwBN,wBAAc,CAC/CO,eAAgBH,GAChBI,SAAU,EACVC,kBAAmB,SAACF,KACpBG,qBAAsB,SAACC,EAAqCC,KAC5DC,eAXJ,SAAuDF,EAASG,GAG5D,OAFoBV,GAAsBO,GAEvB9C,KAAI,SAAAjS,GAAE,OAAIkV,EAAQlV,MAAKmV,QAAO,SAAAC,GAAG,YAAYhW,IAARgW,MASxDC,SAAU,SAACN,EAAkCO,OA6ElCC,GA1EqB,SAACxT,GACjC,MAAwCwP,mBAASqC,IAAjD,mBAAOS,EAAP,KAAqBC,EAArB,KACMkB,EAAmBC,iBAAO,GAChC,EAA4ClE,mBAASiD,IAArD,mBAAOG,EAAP,KAAuBE,EAAvB,KAMMa,EAAcC,mBAAQ,WAgBxB,MAAO,CACHtB,eACAC,gBAAiB,SAAC5R,GAAD,OAAmC4R,EAAgB,2BAAKD,GAAiB3R,KAC1F6R,YAhBgB,SAAC7N,GACjB,IAAIkP,EACJ,GAAa,sBAATlP,EAA8B,CAC9B,IAAMmP,EAAUxB,EAAaP,mBACb,IAAZ+B,EAAmBD,EAAS,MACX,QAAZC,EAAmBD,EAAS,OAChB,SAAZC,IAAoBD,GAAS,QAEtCA,GAAUvB,EAAa3N,GAE3B4N,EAAgB,2BAAKD,GAAN,kBAAqB3N,EAAOkP,SAShD,CAACvB,EAAcC,IAGZwB,EAAgBH,mBAAQ,WAC1BH,EAAiBO,QAAUP,EAAiBO,QAAU,EAqBtD,MAAO,CACHpB,iBACAC,SAAUY,EAAiBO,QAC3BlB,kBAAmB,SAACmB,GAAD,OAAgDnB,EAAkB,2BAAKF,GAAmBqB,KAC7GlB,qBAvByB,SAACC,EAAkC/U,GAC5D,IAAMgW,EAAWhX,IAAEiX,IAAItB,EAAeI,GAAO,CAAC/U,IAC9C6U,EAAkB,2BAAKF,GAAN,kBAAuBI,EAAOiB,MAsB/Cf,eAnBJ,SAAgDF,EAASG,GAGrD,OAFoBP,EAAeI,GAEhB9C,KAAI,SAAAjS,GAAE,OAAIkV,EAAQlV,MAAKmV,QAAO,SAAAC,GAAG,YAAYhW,IAARgW,MAiBxDC,SAda,SAACN,EAAkCO,GAC7B,kBAARA,IAAkBA,EAAM,CAACA,IACpCzW,QAAQC,IAAI,cAAewW,EAAK,OAAQX,GACxC9V,QAAQC,IAAR,2BAAiB6V,GAAjB,kBAAkCI,EAAOJ,EAAeI,GAAM9C,KAAI,SAAAjS,GAAE,OAAKsV,EAAItJ,SAAShM,SAEtF6U,EAAkB,2BAAIF,GAAL,kBAAsBI,EAAOJ,EAAeI,GAAMI,QAAO,SAAAnV,GAAE,OAAKsV,EAAItJ,SAAShM,aAYnG,CAAC2U,EAAgBE,IAEpB,OAAO,eAACV,GAAoBnF,SAArB,CAA8BhN,MAAO0T,EAArC,SACH,eAAChB,GAAsB1F,SAAvB,CAAgChN,MAAO8T,EAAvC,SACK/T,EAAMmU,cC5GnB,IAAMC,GAAgB,SAClB1B,EAAmDlV,EACnD8U,GAGA,IAAIR,EAAeQ,EAAaR,aAEhCA,EAAeA,EAAa7H,SAAS,MAAQ6H,EAAa7H,SAAS,KAAO6H,EAAe,IAAMA,EAAe,IAE9G,IAAIuC,EAAU,CAAC/B,EAAaJ,kBAAmBI,EAAaH,kBAI5D,MAHwE,CAACO,EAAYlV,GAGzE4N,QAA0C,SAAC7N,EAAS+W,EAAQC,GAEpE,IAAKF,EAAQE,GAAQ,OAAOhX,EAE5B,IAAMiX,EAAuB,IAAVD,EAiBnB,OAfAvK,OAAOD,KAAKuK,GAAQ/R,SAAQ,SAACkS,GAEzB,IA9BwBC,EA8BlBC,EAASL,EAAOG,GAEhBG,EAAStC,EAAaL,eAAiB0C,EAAOpQ,KAAKkN,MAAM,KAAKC,OAAO,GAAI,GAAG,GAAKiD,EAAOhQ,KAhCtE+P,EAkCGE,EAjCxB,IAAIC,OAAJ,WAiCU/C,EAjCcvG,QAAQ,MAAM,MAAMA,QAAQ,MAAM,KAA1D,KAAkE,KACnEuJ,KAAKJ,KAkCHnX,EAAQkX,GAAR,2BACOE,GADP,IAEIH,mBAKLjX,IAER,KAIDwX,GAAyB,SAAC/U,GAC5B,OAAO,iCACH,sBAAKQ,MAAO,CAAE4M,MAAO,WAArB,0DACA,uHACA,eAAC,GAAD,CAAgB1G,GAAG,WAAWlG,MAAO,CAAEoO,UAAW,UAIpDoG,GAAiC,SAAChV,GACpC,OAAO,iCACH,sBAAKQ,MAAO,CAAE4M,MAAO,WAArB,oDACA,uHACA,eAAC,GAAD,CAAgB1G,GAAG,WAAWlG,MAAO,CAAEoO,UAAW,UAkH3CqG,GAxGkC,SAACjV,GAC9C,MAAqDkV,qBAAW9C,IAAzDE,EAAP,EAAOA,aAAcC,EAArB,EAAqBA,gBAAiBC,EAAtC,EAAsCA,YACtC,EAAkE0C,qBAAWvC,IAAtEC,EAAP,EAAOA,eAAgBE,EAAvB,EAAuBA,kBAAmBC,EAA1C,EAA0CA,qBAEpCoC,EAAef,GAAcpU,EAAM0S,YAAc,GAAI1S,EAAMxC,WAAa,GAAI8U,GAE9E8C,EAAsBpL,OAAOqL,OAAOF,GAIxC,GAHI7C,EAAaP,oBACbqD,EAAsBnY,IAAEqY,QAAQF,EAAqB,OAAQ9C,EAAaP,oBAE1EO,EAAaN,gBAAiB,CAE9BoD,EAAsBnY,IAAEqY,QAAQF,GADV,SAACT,GAAD,MAAgC,sBAAI/B,EAAeF,YAAnB,YAAkCE,EAAepV,YAAWyM,SAAS0K,EAAO1W,MAC9D,QAGxE,IAAMsX,EAAa,SAACtX,GAAD,MAAgB,sBAAI2U,EAAeF,YAAnB,YAAkCE,EAAepV,YAAWyM,SAAShM,IAwBxG,OACI,uBAAKuC,MAAK,aAAIsL,OAAQ,OAAQC,QAAS,OAAQC,cAAe,SAAUwJ,gBAAiB,SAAYxV,EAAMQ,OAA3G,UACI,uBAAKA,MAAO,CAAEuL,QAAS,OAAQC,cAAe,MAAOyJ,eAAgB,SAAUC,WAAY,SAAU9G,UAAW,GAAI5B,aAAc,IAAlI,UACI,eAAC7L,GAAD,CACIZ,MAAM,gBACNC,MAAO,CAAEmV,YAAa,IACtB1V,MAAOqS,EAAaR,aACpB1R,SAAU,SAAC0R,GAAD,OAAkBS,EAAgB,CAACT,oBACjD,sBACI,WAAS,mBACTjH,UAAW,uBAAyByH,EAAaL,eAAiB,SAAW,IAC7E1Q,QAAS,kBAAMiR,EAAY,mBAAmBhS,MAAO,CAAEoV,OAAQ,WAHnE,SAGiFtD,EAAaL,eAAiB,eAAC,KAAD,IAAe,eAAC,KAAD,SAElI,uBAAKzR,MAAO,CAAEuL,QAAS,OAAQ0J,eAAgB,gBAAiBzI,aAAc,GAA9E,UACI,uBACI,WAAS,kBACTnC,UAAW,uBAAyByH,EAAaJ,kBAAoB,SAAW,IAChF3Q,QAAS,kBAAMiR,EAAY,sBAAsBhS,MAAO,CAAEoV,OAAQ,WAHtE,oBAIA,uBACI,WAAS,iBACT/K,UAAW,uBAAyByH,EAAaH,iBAAmB,SAAW,IAC/E5Q,QAAS,kBAAMiR,EAAY,qBAAqBhS,MAAO,CAAEoV,OAAQ,WAHrE,0BAKJ,uBAAKpV,MAAO,CAAEuL,QAAS,OAAQ0J,eAAgB,gBAAiBzI,aAAc,GAA9E,UACI,uBACInC,UAAW,uBAAyByH,EAAaP,kBAAoB,SAAW,IAChFxQ,QAAS,kBAAMiR,EAAY,sBAAsBhS,MAAO,CAAEoV,OAAQ,WAFtE,iBAGA,uBACI,WAAS,sBACT/K,UAAW,uBAAyByH,EAAaN,gBAAkB,SAAW,IAC9EzQ,QAAS,kBAAMiR,EAAY,oBAAoBhS,MAAO,CAAEoV,OAAQ,WAHpE,iBAIA,uBACI/K,UAAU,qBACVtJ,QAvDU,WACtB,IAAMsU,EAAY7L,OAAOD,KAAKoL,GAExBW,EAAsH,IAAlG7Y,IAAE8Y,aAAF,sBAAmBnD,EAAeF,YAAlC,YAAiDE,EAAepV,YAAYqY,GAAW7X,OAE3GgY,EAAmB/Y,IAAE8Y,aAAa/L,OAAOD,KAAK/J,EAAM0S,YAAamD,GACjEI,EAAqBhZ,IAAE8Y,aAAa/L,OAAOD,KAAK/J,EAAMxC,WAAYqY,GAElEK,EAAqBJ,EAAiB,sBACpCE,GADoC,YACfpD,EAAeF,aAExCE,EAAeF,WAAWU,QAAO,SAAAqB,GAAQ,OAAKuB,EAAiB/L,SAASwK,MAEtE0B,EAAuBL,EAAiB,sBACtCG,GADsC,YACfrD,EAAepV,YAE1CoV,EAAepV,UAAU4V,QAAO,SAAAgD,GAAU,OAAKH,EAAmBhM,SAASmM,MAE/EtD,EAAkB,CAAEJ,WAAYwD,EAAoB1Y,UAAW2Y,KAqCvB3V,MAAO,CAAEoV,OAAQ,WAFjD,oBAKiE,IAApE5L,OAAOD,KAAPC,OAAA,IAAAA,QAAA,IAAAA,CAAA,GAAiBhK,EAAM0S,YAAe1S,EAAMxC,YAAaQ,OACtD,eAAC,GAAD,IAAuE,IAA9CgM,OAAOqL,OAAOD,GAAqBpX,OACxD,eAAC,GAAD,IAAiC,KAGzC,sBAAKwC,MAAO,CAAE4L,KAAM,GAAKvB,UAAU,aAAnC,SACKb,OAAOqL,OAAOD,GAAqBlF,KAAI,SAAAmD,GACpC,OAAIA,EAAImB,WACG,eAAC,GAAD,CAAavW,GAAIoV,EAAIpV,GACxBsT,SAAU8B,EACVhC,SAAUkE,EAAWlC,EAAIpV,IACzBqT,OAAQ,kBAAMyB,EAAqB,YAAaM,EAAIpV,OAGjD,eAAC,GAAD,CAAcA,GAAIoV,EAAIpV,GACzB2T,UAAWyB,EACXhC,SAAUkE,EAAWlC,EAAIpV,IACzBqT,OAAQ,kBAAMyB,EAAqB,aAAcM,EAAIpV,gBCvJ3EoY,GAA4BC,yBAAcC,eAE1CC,GAAqB,CAAEhB,gBAAiB,UAAYrJ,WAAY,EAAGyC,WAAY,GAE/E6H,G,kDAEJ,WAAYzW,GAAO,IAAD,8BAChB,cAAMA,IAiBRvD,MAAQ,CACNia,kBAAmB,KACnBC,YAAa,WACbC,SAAS,EACT5Q,QAAS,CAAE6Q,GAAI,KAtBC,EA8BlBC,eAAiB,WACf,OAAO,MA/BS,EAkClBC,cAAgB,WACd,OAAO,MAnCS,EAsClBC,eAAiB,WAEf,OAAO,uBAAKxW,MAAO,CAACuL,QAAS,OAAQC,cAAe,SAAUyJ,eAAgB,SAAUC,WAAY,SAAU5J,OAAQ,QAA/G,UACL,sBAAKtL,MAAO,CAACgR,SAAU,MAAOyF,WAAY,QAA1C,0CACA,sBAAKzW,MAAO,CAACgR,SAAU,SAAvB,gGACA,sBAAKhR,MAAO,CAACgV,gBAAiB,QAAUhE,SAAU,MAAOrE,OAAQ,GAAI+J,QAAS,GAAIpK,YAAa,GAAIC,aAAc,GAAIjC,aAAc,IAAnI,2EA3Cc,EAmElBqM,eAAiB,SAACha,GAEhB,IAAIkU,EAGFA,EADE,EAAK5U,MAAM4U,SAASpH,SAAS9M,GACpB,EAAKV,MAAM4U,SAAS+B,QAAO,SAAAnV,GAAE,OAAIA,IAAOd,KAE3C,sBAAO,EAAKV,MAAM4U,UAAlB,CAA4BlU,IAGtC,EAAKiE,SAAS,CAACiQ,cA7EC,EAgFlB+F,mBAAqB,SAACC,GACpBvT,SAASC,cAAc,IAAIC,YAAY,aAAc,CAACC,OAAQ,CAAChG,GAAI,WAjFnD,EAoFlBqZ,aAAe,SAACtR,EAASuR,EAAQC,GAC/B1T,SAASC,cAAc,IAAIC,YAAY,aAAc,CAACC,OAAQ,CAAChG,GAAIuZ,EAAMC,EAAGC,OAAQH,EAAOI,EAAIH,EAAMG,OArFrF,EAwFlBC,sBAAwB,SAACC,GAEvB,IAAK,EAAKC,eAAiB,OAAO,EAElC,IACIC,EADEC,EAAiBH,EAASna,OAAOJ,MAAQ,EAAK0C,MAAMtC,OAAOJ,IAEjE,IAAK0a,EAAe,CAClB,IAAI1a,EAAML,IAAEY,KAAK,EAAKmC,MAAMlC,KAAM,CAAC,KAAM,EAAKkC,MAAMtC,OAAOJ,MACvD2a,EAAShb,IAAEY,KAAKga,EAAS/Z,KAAM,CAAC,KAAM+Z,EAASna,OAAOJ,MAE1D,IAAKA,IAAQ2a,EAAQ,OAAO,EACvB,IAAK3a,EAAI0I,UAAYiS,EAAOjS,QAAS,OAAO,EAC5C,GAAI/I,IAAEib,QAAQ5a,EAAI0I,QAASiS,EAAOjS,SAAU,OAAO,EACnD,IAAM/I,IAAEib,QAAQ,EAAKJ,eAAgBG,EAAOrb,OAAQ,OAAO,EAEhEmb,GAAsB9a,IAAEib,QAAQ5a,EAAIV,MAAOqb,EAAOrb,OAGpD,OAAOob,GAAkBD,GA1GT,EA6GlBI,eAAiB,SAAChR,EAAQnB,GACxB,EAAKhG,MAAMmY,eAAehR,EAAQnB,GAElC2D,GAAU5D,cAAc,EAAK/F,MAAMtC,OAAOJ,IAAK0I,IAhH/B,EAmHlB8H,OAAS,SAACsK,GACRC,MAAM,uBAAD,OAAwBC,KAAKC,UAAUH,MApH5B,EAuHlBI,UAAY,SAACC,GACXA,EAAclW,SAAQ,SAAAmC,GAClBiF,GAAUhC,SAASjD,OAzHP,EA6HlBgU,UAAY,WACV,IAAK,EAAK1Y,MAAMtC,OAAOJ,IAAM,OAAO,EAAKyZ,gBAEzC,IAAIzZ,EAAML,IAAEY,KAAK,EAAKmC,MAAMlC,KAAM,CAAC,KAAM,EAAKkC,MAAMtC,OAAOJ,MAE3D,IAAKA,EAAK,OAAO,EAAKyZ,gBACtB,GAAyB,IAArBzZ,EAAIV,MAAMoB,OAAc,OAAO,EAAKgZ,iBAExC,IAAIpa,EAAQU,EAAIV,MAAMsT,KAAI,SAAA/S,GAAM,OAAI,EAAK6C,MAAMpD,MAAMO,MAMrD,IAJAP,EAAQA,EAAMwW,QAAQ,SAAAhW,GAAI,OAAIA,MAIpBY,SAAWV,EAAIV,MAAMoB,OAAQ,OAAO,KAE9C,IAAIgI,EAAU1I,EAAI0I,QAWlB,OATIA,EAAQ6Q,GAAG7Y,SAAWpB,EAAMoB,SAC9BgI,EAAQ6Q,GAAKja,EAAMsT,KAAI,SAAA9S,GAErB,OADaH,IAAEY,KAAKmI,EAAQ6Q,GAAI,CAAC,IAAKzZ,EAAKa,MAC1BwY,EAAckC,cAAcvb,EAAM4I,OAIvD,EAAK8R,eAAiBxa,EAAIV,MAGxB,eAACyZ,GAAD,2BACM,EAAKrW,OADX,IAEEgG,QAASA,EACToR,mBAAoB,EAAKA,mBACzBe,eAAgB,EAAKA,eACrBrK,OAAQ,EAAKA,OACbwJ,aAAc,EAAKA,aACnBsB,gBAAgB,8CAEhBC,oBAAoB,EAGpBC,iBAAkB,EAAKrc,MAAMma,QAC7BD,YAAa,EAAKla,MAAMka,YACxBoC,kBAAmB,EAAKtc,MAAMka,YAC9BqC,UAAW,GAfb,SAiBG,EAAKC,YAAYjT,EAAQ6Q,GAAIja,EAAO,EAAKH,MAAM4U,SAAU,EAAK8F,oBA1KnD,EAgLlB3Q,WAAa,SAACE,GACZiD,GAAUnD,WAAW,EAAK/J,MAAM4U,SAAU3K,GAC1C,EAAKtF,SAAS,CAACiQ,SAAU,MAlLT,EAqLlB6H,YAAc,WACZ,EAAKzc,MAAM4U,SAAS9O,SAAQ,SAAApF,GAAM,OAAIwM,GAAUrD,WAAWnJ,MAC3D,EAAKiE,SAAS,CAAEiQ,SAAU,MAvLV,EA0LlB8H,UAAY,WAGV,IAAIC,EAAOnc,IAAEoc,UAAU,EAAKrZ,MAAMlC,KAAM,CAAC,KAAM,EAAKkC,MAAMtC,OAAOJ,MAAS,EACtE,EAAK0C,MAAMlC,KAAKE,SAAWob,IAAMA,EAAO,GAE5C,EAAK3c,MAAM4U,SAAS9O,SAAQ,SAAApF,GAAM,OAAIwM,GAAUpD,SAASpJ,EAAQ,EAAK6C,MAAMlC,KAAKsb,GAAMnb,OACvF,EAAKmD,SAAS,CAAEiQ,SAAU,MAjMV,EAoMlBiI,sBAAwB,WAEtB,IAAMC,EAAY,EAAK9c,MAAM4U,SAASrT,OAEtC,GAAkB,IAAdub,EAAiB,OAAO,KAM5B,OAAO,gBAACC,GAAA,EAAD,CAAOhZ,MAAO,CAAC0W,QAAS,GAAIlK,aAAc,IAAKtB,UAAW,EAA1D,6BACQ6N,EADR,4CAEL,uBAAK/Y,MAAO,CAACuL,QAAS,OAAQ0J,eAAgB,SAAUC,WAAY,UAApE,UACG6D,EAAY,EAPO,CACtB,CAAC,GAAM,YAAa,CAAC,GAAM,YAAa,CAAC,GAAM,cAMZrJ,KAC/B,SAAAuJ,GAAK,OAAI,eAACnY,GAAA,EAAD,CAAQC,QAAS,kBAAM,EAAKiF,WAAWiT,EAAM/S,KAA7C,4BAA+D+S,EAAM/S,SAC9E,KACF,eAACpF,GAAA,EAAD,CAAQC,QAAS,EAAK2X,YAAtB,oBACA,eAAC5X,GAAA,EAAD,CAAQC,QAAS,EAAK4X,UAAtB,sCAlNJ,EAAKrB,gBAAiB,EAEtB,EAAKrb,MAAQ,CACX4U,SAAU,IANI,E,qDAyBlB,WACEtQ,KAAKK,SAAS,CAAEwV,SAAS,IACzB7V,KAAKf,MAAMJ,mBAAcvC,K,yBA8B3B,SAAY2I,EAASpJ,EAAOyU,EAAUqI,GACpC,OAAOzc,IAAEiT,IAAIlK,GAAS,SAAS2T,EAAGlC,GAChC,OAAO,sBAAuBlW,QAAS,SAAClB,GAAD,OAAOA,EAAEuZ,QAAUF,EAAa9c,EAAM6a,GAAGxZ,IAAM,MAA/E,SACL,eAAC,GAAD,CACEb,KAAMR,EAAM6a,GACZjX,MAAO6Q,EAASpH,SAASrN,EAAM6a,GAAGxZ,IAAMuY,GAAqB,MAHhD5Z,EAAM6a,GAAGxZ,S,oBA+J9B,WAKE,OAII,eAHA,CAGA,OAAKuC,MAAK,2BAAMO,KAAKf,MAAMQ,OAAjB,IAAwBuL,QAAS,OAAQ8N,SAAU,OAAQ/N,OAAQ,SAA7E,UAEI,eAAC,GAAD,CACItL,MAAO,CAAEsM,YAAa,GAAIC,aAAc,GAAItM,MAAO,OAAQqZ,SAAU,IAAKC,YAAa,kBACvFrH,WAAY3R,KAAKf,MAAM0S,WAAYlV,UAAWuD,KAAKf,MAAMxC,YAE7D,uBAAKgD,MAAO,CAAC4L,KAAM,EAAGN,OAAQ,OAAQC,QAAS,OAAQC,cAAc,UAArE,UACI,uBAAKxL,MAAO,CAAC0W,QAAS,GAAI9K,KAAM,GAAIvB,UAAU,aAA9C,UACK9J,KAAKuY,wBACLvY,KAAK2X,eAEV,eAACsB,GAAD,CAAYnM,YAAY,+CAA+CzN,SAAUW,KAAKyX,sB,GAhP1EjJ,IAAM/N,WAA5BiV,GAaGwD,aAAe,CACpBpP,UAAW,SACXmO,UAAW,GACXb,eAAgB,aAChB+B,KAAM,CAAErD,GAAI,GAAIsD,GAAI,GAAIC,GAAI,EAAGC,GAAI,EAAGC,IAAK,IAjBzC7D,GAiDGkC,cAAgB,SAACvb,EAAM4I,GAC5B,MAAO,CACLuU,EAAGnd,EAAKod,UAAU,GAAIxU,EAAQ6Q,GAAG7Y,OACjCyc,EAAG,EACHC,EAAGtd,EAAKod,UAAU,GAClB7C,EAAGva,EAAKod,UAAU,GAClB/C,EAAGra,EAAKa,KAiMd,IAQM0P,GAAqB,CACzBhO,kBACAgb,YZvOyB,SAAC/U,EAAOhJ,GAAR,MAAmB,CAC1CD,KRlDyB,gBQmDzBiJ,QACAhJ,UYqOFgD,kBAGaoC,gBAdS,SAAAvF,GAAK,MAAK,CAChCG,MAAOH,EAAMG,MACbY,UAAWf,EAAMD,QAAQgB,UACzBkV,WAAYjW,EAAMD,QAAQkW,WAC1B5U,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,UASwBiQ,GAAzB3L,CAA6C4Y,uBAAYnE,K,WC3MzDoE,GArEoB,SAAA7a,GAE/B,IAAM8a,GAAqB9a,EAAMU,WAAWC,OAAOoa,YAC7CC,EAAWhb,EAAMU,WAAWC,OAAOsa,YACnCC,EAAWlb,EAAMU,WAAWC,OAAOwa,QACnCC,EAAUpb,EAAMU,WAAWC,OAAOya,QASlCC,EAAkB,SAAlBA,EAAmBhI,GACrB,IAAIpT,EAUJ,OATIib,GAAYI,MAAMC,QAAQlI,GAC1BpT,EAAQoT,EAAInD,IAAImL,GACM,kBAARhI,EAEdpT,EAAQoT,EACO,OAARA,IACPpT,EAAQoT,EAAIpT,OAGTub,EAAcvb,IAkBnBub,EAAgB,SAACvb,GAInB,OAHc,OAAVA,IACAA,EAAQib,EAAW,GAAK,MAErBjb,GAGLA,EAtBkB,SAAlBwb,EAAmBxb,GACrB,IAAIoT,EAAM,KAWV,OAVI6H,GAAYI,MAAMC,QAAQtb,GAC1BoT,EAAMpT,EAAMiQ,IAAIuL,GACA,MAATxb,GAEI,OADXoT,EAAMpW,IAAEY,KAAKud,EAAS,CAAEnb,MAAOA,OAG3BoT,EAAM,CAACpT,MAAMA,EAAOM,MAAMN,IAI3Bub,EAAcnI,GAUXoI,CAAgBzb,EAAMC,OAEpC,OACQ,eAACyb,GAAA,EAAD,CACIC,WAAS,EACTX,SAAUA,EACVE,SAAUA,EACVJ,iBAAkBA,EAClB7a,MAAOA,EACPG,SApDS,SAACqH,EAAWxH,EAAWwD,GAExCxD,EAAQob,EAAgBpb,GAExBD,EAAMI,SAASH,IAiDP2b,eAAgB,SAACC,GAAD,OAAYA,EAAOtb,OACnC6a,QAASA,EAETU,YAAa,SAACnb,GAAD,OAAY,eAACT,GAAA,EAAD,yBAAWM,MAAO,CAACC,MAAO,SAAaE,GAAvC,IAA+CJ,MAAOP,EAAMO,MAAOJ,QAAQ,kBC1CrG6B,gBAJS,SAACvF,GAAD,MAAiB,CACrCD,QAASC,EAAMD,WAGJwF,EAzBgC,SAAChC,GAC5C,IAEMU,EAAa,CACf/D,KAAM,WACNgE,OAAQ,CACJya,QALYpb,EAAMob,SAAWpb,EAAMxD,QAAQuf,YAM3ChB,aAAa,EAAMI,SAAS,IAIpC,OACI,eAAC,GAAD,CACIlb,MAAOD,EAAMC,MACbS,WAAYA,EACZN,SAAUJ,EAAMI,SAChBG,MAAM,iBCuBHyB,gBALS,SAACvF,GAAD,MAAiB,CACrCqB,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,UAGHsE,EAlCsB,SAAChC,GAElC,IAAMob,EAAUpb,EAAMlC,KAAKoS,KAAK,SAAC5S,GAAD,MAAU,CAACiD,MAAOjD,EAAIqH,KAAM1E,MAAO3C,EAAIW,OAEjEgC,EAAQD,EAAMC,MACP,MAATA,GACID,EAAMtC,OAAOJ,KAAOL,IAAEY,KAAKmC,EAAMlC,KAAM,CAAC,KAAMkC,EAAMtC,OAAOJ,OAC3D0C,EAAMI,SAASJ,EAAMtC,OAAOJ,KAIpC,IAAMoD,EAAa,CACf/D,KAAM,WACNgE,OAAQ,CACJya,QAASA,EACTL,aAAa,EAAOI,SAAS,IAIrC,OACI,eAAC,GAAD,CACIlb,MAAOA,EACPS,WAAYA,EACZN,SAAUJ,EAAMI,SAChBG,MAAM,WCRHyb,GAvB4B,SAAChc,GACxC,IAAQsT,EAAa4B,qBAAWvC,IAAxBW,SAEFqB,EAAS3U,EAAM4R,UACfqK,EAAcjc,EAAMic,YAE1B,OACI,uBAAKzb,MAAO,CAACuL,QAAS,OAAQC,cAAe,MAAOyJ,eAAgB,aAAcC,WAAY,SAAU9G,UAAW,GAAI5B,aAAc,IAArI,UACI,sBACIxM,MAAO,CAAC4M,MAAO,UAAWwI,OAAQ,UAAW7J,QAAS,OAAQ0J,eAAgB,SAAUC,WAAW,UACnGnU,QAAS,kBAAM+R,EAAS,aAAcqB,EAAO1W,KAFjD,SAGI,eAAC,KAAD,MAEJ,sBACIuC,MAAO,CAACoV,OAAQqG,EAAc,UAAY,UAAWtG,YAAa,GAAIuG,WAAY,GAAIhF,QAAS,GAAI1B,gBAAiByG,EAAc,aAAe,OAAQnR,aAAc,GACvKvJ,QAAS0a,OAAc5e,EAAY2C,EAAMmc,wBAF7C,SAGKxH,EAAOhQ,KAAK4G,QAAQ,OAAQ,MAEjC,sBAAK,WAAUoJ,EAAOpQ,KAAtB,SAA6B,OAASoQ,EAAOpQ,KAAKkN,MAAM,KAAKC,OAAO,GAAG,GAAG,SC1BhF0K,GAAU,CACZ,CAAC7b,MAAO,oBAAqBN,MAAM,gBACnC,CAACM,MAAO,uBAAwBN,MAAM,aACtC,CAACM,MAAO,kBAAmBN,MAAM,kBACjC,CAACM,MAAO,qBAAsBN,MAAM,sBAiCzBoc,GAzBsC,SAACrc,GAElD,IAAMC,EAAQD,EAAMC,MACP,MAATA,GACAD,EAAMI,SAASgc,GAAQ,GAAGnc,OAG9B,IAAMS,EAAa,CACf/D,KAAM,WACNgE,OAAQ,CACJya,QAASgB,GACTrB,aAAa,EAAOI,SAAS,IAIrC,OACI,eAAC,GAAD,CACIlb,MAAOA,EACPS,WAAYA,EACZN,SAAUJ,EAAMI,SAChBG,MAAM,qB,WC6BH+b,GAtCkC,SAACtc,GAC9C,MAA4CA,EAAMuc,oBAA1C3W,EAAR,EAAQA,MAAO4W,EAAf,EAAeA,YAAaC,EAA5B,EAA4BA,YACtBC,EAAmB1c,EAAMtC,OAAS,CACpC8X,gBAAiB,QACjB,CACAA,gBAAiB,cAGrB,OACI,iCACI,uBAAKhV,MAAO,CAAEuL,QAAS,OAAQC,cAAe,MAAOmB,QAAS,GAA9D,UACI,sBAAKtC,UAAU,oBAAoBrK,MAAOkc,EAAkBnb,QAASvB,EAAM2c,WAA3E,mBACA,sBAAK9R,UAAU,oBAAoBrK,MAAOkc,EAAkBnb,QAASvB,EAAM4c,YAA3E,oBACC5c,EAAMtC,OACH,KAEA,sBAAKmN,UAAU,oBAAoBrK,MAAOkc,EAAkBnb,QAASvB,EAAM6c,iBAA3E,+BAEJ,sBAAKrc,MAAO,CAAE4L,KAAM,QAExB,gBAAC0Q,GAAA,EAAD,CAAMC,WAAS,EAAClO,QAAS,EAAGrO,MAAK,aAAIwc,WAAY,YAAajR,QAAS,OAAQ8N,SAAU,OAAQ3C,QAAS,GAAItI,UAAW,EAAG5B,aAAc,GAAIlC,aAAc,EAAGmS,oBAAqB,EAAGxH,eAAgB,SAAUC,WAAY,UAAagH,GAA1O,UACI,eAACI,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAGtD,GAAI,EAA9B,SACK7W,EAAMzC,QAAQ2S,KAAI,SAAAyE,GAAM,OAAI,eAAC,GAAD,CAAc/C,UAAW+C,EAAQsH,YAAajc,EAAMtC,OAAQye,wBAAyB,kBAAMnc,EAAMmc,wBAAwBxH,EAAO1W,YAEjK,eAAC6e,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAGtD,GAAI,EAA9B,SACI,eAAC,GAAD,CAAgB5W,MAAOuc,EAAapc,SAAU,SAAC+c,GAAD,OAASnd,EAAMod,kBAAkB,cAAeD,QAElG,eAACL,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAGtD,GAAI,EAA9B,SACI,eAAC,GAAD,CAAW5W,MAAO2F,EAAOxF,SAAU,SAAC+c,GAAD,OAASnd,EAAMod,kBAAkB,QAASD,QAEjF,eAACL,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAGtD,GAAI,EAA9B,SACI,eAAC,GAAD,CAAmB5W,MAAOwc,EAAarc,SAAU,SAAC+c,GAAD,OAASnd,EAAMod,kBAAkB,cAAeD,eChBtGE,GA5B0B,SAACrd,GAKtC,OAJKA,EAAMpD,OAASoD,EAAMuR,SAAS+L,cAC/Btd,EAAMud,YAAY,CAACvd,EAAMuR,SAAS+L,eAIlC,uBAAK9c,MAAO,CAAEuL,QAAS,OAAQC,cAAe,MAAO0J,WAAY,SAAU9G,UAAW,IAAtF,UACI,uBAAKpO,MAAO,CAAEuL,QAAS,OAAQC,cAAe,MAAO0J,WAAY,UAAjE,UACI,sBAAKlV,MAAO,CAAE4M,MAAO,UAAWwI,OAAQ,UAAW7J,QAAS,OAAQ0J,eAAgB,SAAUC,WAAY,UAAYnU,QAASvB,EAAMsT,SAArI,SACI,eAAC,KAAD,MAEJ,sBAAK,WAAUtT,EAAMuR,SAAShN,KAAM/D,MAAO,CAAE0b,WAAY,IAAzD,SAAgE,QAAUlc,EAAMuR,SAAShN,KAAKkN,MAAM,KAAKC,OAAO,GAAI,GAAG,GAAK,MAC5H,sBAAKlR,MAAO,CAAE0b,WAAY,GAAIhF,QAAS,GAAI1B,gBAAiB,aAAc1K,aAAc,GAAxF,SACK9K,EAAMuR,SAAS5M,UAGxB,sBAAKnE,MAAO,CAAE4L,KAAM,EAAGU,YAAa,GAAIC,aAAc,IAAtD,SACI,eAAC,GAAD,CACIqO,QAASpb,EAAMuR,SAAS3U,MAAMsT,KAAI,SAAAsN,GAAU,MAAK,CAAEvd,MAAOud,EAAYjd,MAAOid,MAC7Evd,MAAOD,EAAMpD,OAAS,CAAC,IACvBwD,SAAUJ,EAAMud,oBCf9BE,GAAW,SAAClgB,EAA+BqI,EAAgB8X,GAAhD,oBACbngB,QAASA,EACTgf,oBAAqB,CAAE3W,MAAOA,EAAO4W,YAAa,GAAIC,YAAa,iBAChEiB,IAgBDC,GAAkB,SAACC,EAAgBC,GAAjB,OAA8CA,EAAO3N,KAAI,SAAC4N,EAAOrG,GAAR,mBAAC,eAAmBqG,GAApB,IAA2BpgB,OAAQ+Z,IAAMmG,QAGpHG,GAA0B,SAAC/d,GAC7B,OAAO,iCACH,sBAAKQ,MAAO,CAAE4M,MAAO,UAAWoE,SAAU,QAASyF,WAAY,QAA/D,+CACA,gFAwPFtJ,GAAqB,CACvB9N,gBACAJ,YACAue,kBpBvN6B,SAAC5gB,GAAD,MAAW,CACxCT,KAAMP,EACNgB,SoBsNA6gB,iBpBnN4B,SAAC9gB,GAAD,MAAa,CACzCR,KAAMN,EACNc,YoBoNW6E,gBAZS,SAACvF,GAAD,MAAiB,CACrCqB,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,UAUsBiQ,GAAzB3L,EApPkC,SAAChC,GAC9C,IA/B+B6d,EAA0BK,EA+BzD,EAAgFhJ,qBAAWvC,IAApFC,EAAP,EAAOA,eAAgBC,EAAvB,EAAuBA,SAAUC,EAAjC,EAAiCA,kBAAmBI,EAApD,EAAoDA,eAAgBI,EAApE,EAAoEA,SACpE,EAA8C9D,mBAA2B,IAAzE,mBAAO2O,EAAP,KAAwBC,EAAxB,KACA,EAA4C5O,mBAA2C,IAAvF,mBAAO6O,EAAP,KAAuBC,EAAvB,KAEMC,EAAeve,EAAMtC,OAAOJ,IAAM0C,EAAMtC,OAAOJ,IAAM0C,EAAMlC,KAAKE,QAAUgC,EAAMlC,KAAKE,OAAS,EAAIgC,EAAMlC,KAAK,GAAGG,QAAKZ,EAGrHmhB,EAAetL,EAAe,YAAalT,EAAMxD,QAAQgB,WACzDihB,EAAgBvL,EAAe,aAAclT,EAAMxD,QAAQkW,YAmD3DyJ,EAA0B,SAAC1H,GAG7B,IAAME,EAAS1X,IAAEY,KAAK4gB,EAAe,CAAC,KAAMhK,IAC5C,GAAKE,EAAL,CAKA,IAAM+J,EAAqBP,EAAgBjO,KAAI,SAAA4N,GAE3C,IAAIvgB,EAAUugB,EAAMpgB,OAAN,sBAAmBogB,EAAMvgB,SAAzB,CAAkCoX,IAAUmJ,EAAMvgB,QAAQ6V,QAAO,qBAAGnV,KAAgBwW,KAElG,OAAO,2BAAKqJ,GAAZ,IAAmBvgB,eAGvB6gB,EAAmBM,KAgBjBC,EAAcjL,iBAAO,GAC3B,GAAIiL,EAAY3K,UAAYnB,EAAU,CAClC8L,EAAY3K,QAAUnB,EACtB,IAAI6L,EAAuC,GAErCE,EAAyBT,EAAgB/S,QAAO,SAACyT,EAAuBf,GAAxB,4BAC9Ce,GAD8C,YAC9Bf,EAAMvgB,QAAQ2S,KAAI,qBAAGjS,UAC1C,IAEG6gB,EAAaL,EAAcrL,QAAO,gBAAOqB,EAAP,EAAGxW,GAAH,OAAuB2gB,EAAuB3U,SAASwK,MAKvFiK,EAHJI,EAAW9gB,OAAS,EACW,IAA3BmgB,EAAgBngB,OAEK2f,GAAgB,EAAG,CAACF,GAASgB,EAAeF,KAG5CJ,EAAgBjO,KAAI,SAAC4N,GAAD,OAAWA,EAAMpgB,OAAN,2BAAoBogB,GAApB,IAA2BvgB,QAASugB,EAAMvgB,QAAQwhB,OAAOD,KAAgBhB,KAG/G,YAAOK,GA9IFN,EAiJoBa,EAjJMR,EAiJctL,EAAeF,WAAlFgM,EA/IGb,EAAOzS,QAAO,SAAC4T,EAA8BlB,GAOhD,OANAA,EAAK,2BAAQA,GAAR,IAAevgB,QAASugB,EAAMvgB,QAAQ6V,QAAO,gBAAOqB,EAAP,EAAGxW,GAAH,OAAsBigB,EAAmBjU,SAASwK,SAE1FlX,QAAQS,OAAS,GACvBghB,EAAY5b,KAAK0a,GAGdkB,IACR,IA2IM/hB,IAAEY,KAAK6gB,EAAoB,YAC5BA,EAAqBf,GAAgBe,EAAmB1gB,OAAS,EAAG0gB,IAGxE5hB,QAAQC,IAAI,qBAAsB2hB,GAClCN,EAAmBM,GAqCvB,OAA0B,IAAtB1e,EAAMlC,KAAKE,OAAqB,MAEpClB,QAAQiF,KAAK,mBAAoBoc,GAG7B,uBAAKtT,UAAU,kBAAkBrK,MAAK,2BAAOR,EAAMQ,OAAb,IAAoBuL,QAAS,SAAnE,UACI,eAAC,GAAD,CACI2G,WAAY1S,EAAMxD,QAAQkW,WAC1BlV,UAAWwC,EAAMxD,QAAQgB,UACzBgD,MAAO,CAAEsM,YAAa,GAAIC,aAAc,GAAItM,MAAO,OAAQqZ,SAAU,IAAKC,YAAa,oBAC3F,gBAACnP,EAAA,EAAD,CACIpK,MAAO,CAAE4L,KAAM,EAAGe,OAAQ,GAAI+J,QAAS,GAAIhL,WAAY,YAAaD,SAAU,WADlF,UAEKwS,EAAczgB,OAAS,EAAI,iCACxB,sBAAK6M,UAAU,gBAAf,wBAGCsT,EAAgBjO,KAAI,SAAC4N,EAAOrG,GACzB,OAAO,eAAC,GAAD,2BACCqG,GADD,IAEHV,kBAAmB,SAAC7e,EAAa4e,GAAd,OApGb,SAACS,EAAgBrf,EAAa4e,GAExD,IAAMuB,EAAqBP,EAAgBjO,KAAI,SAAC4N,EAAOrG,GACnD,OAAOA,IAAMmG,EAAN,2BAAoBE,GAApB,IAA2BvB,oBAAoB,2BAAMuB,EAAMvB,qBAAb,kBAAmChe,EAAM4e,MAAUW,KAG5GM,EAAmBM,GA8F+CO,CAAsBxH,EAAGlZ,EAAK4e,IAC5EN,iBAAkB,kBAAMuB,EAAmBT,GAAgBlG,EAAG0G,KAC9DvB,YAAa,kBAlKjB,SAACgB,GAEjB,IAAME,EAAQK,EAAgBP,GAE9B,GAAIE,EAAMvgB,QAAQS,OAAS,EAEvBsV,EAAS,aAAcwK,EAAMvgB,QAAQ2S,KAAI,SAAAyE,GAAM,OAAIA,EAAO1W,WACvD,CAEH,IAAIygB,EAAqBP,EAAgB/K,QAAO,SAAC8L,EAAGzH,GAAJ,OAAUA,IAAMmG,KAG5DE,EAAMpgB,SACNghB,EAAqBf,GAAgBQ,EAAgBngB,OAAS,EAAGmgB,IAGrEC,EAAmBM,IAkJgB9B,CAAYnF,IAC/BkF,WAAY,kBA9IjB,SAACiB,GAChB,IAAME,EAAQK,EAAgBP,GAGxBuB,EAAWrB,EAAMvgB,QAAQ2S,KAAI,SAAAyE,GAAM,OAAI8I,GAAS,CAAC9I,GAAS4J,EAActhB,IAAEC,KAAK4gB,EAAO,CAAC,gBAGzFY,EAAqBP,EAAgB/K,QAAO,SAAC8L,EAAGzH,GAAJ,OAAUA,IAAMmG,KAGhEc,EAAkB,sBAAOA,EAAmBhN,MAAM,EAAGkM,IAAnC,YAA+CuB,GAA/C,YAA4DT,EAAmBhN,MAAMkM,KAGnGE,EAAMpgB,SAAQghB,EAAqBf,GAAgBC,EAAQc,IAE/DN,EAAmBM,GA+HmB/B,CAAWlF,IAC7B0E,wBAAyBA,QAGjC,sBAAK5a,QAAS,kBA9Kb,SAAC,GAAmD,IAAjDhE,EAAgD,EAAhDA,QAEVmhB,EAAqBf,GAAgBQ,EAAgBngB,OAAjB,sBAA6BmgB,GAA7B,CAA8CV,GAASlgB,GAAW,GAAIghB,MAEhHH,EAAmBM,GA0KaU,CAAS,KAA7B,0BACK,KAERZ,EAAaxgB,OAAS,EAAI,sBAAK6M,UAAU,gBAAf,uBAElB,KAET,+BACK2T,EAAatO,KAAI,SAAAqB,GAAQ,OAAI,eAAC,GAAD,CAC1BA,SAAUA,EACV3U,MAAOyhB,EAAe9M,EAAStT,IAC/Bsf,YAAa,SAACvgB,GAAD,OAAwBshB,EAAkB,2BAAID,GAAL,kBAAsB9M,EAAStT,GAAKjB,MAC1FsW,SAAU,kBAAMA,EAAS,YAAa/B,EAAStT,YAKP,IAA/C,sBAAIugB,GAAJ,YAAqBC,IAAezgB,OAAe,eAAC,GAAD,IAA0B,KAE9E,uBAAKwC,MAAO,CAAEuL,QAAS,OAAQC,cAAe,MAAOyJ,eAAgB,SAAUC,WAAY,SAAUvJ,WAAY,IAAjH,UAEI,eAAC7K,GAAA,EAAD,CACId,MAAO,CAAEmV,YAAa,IACtBpU,QAzHJ,kBAAMuR,EAAkB,CAAEJ,WAAY,GAAIlV,UAAW,MA0HjD6hB,QAAS,eAAC,KAAD,IAHb,qBAQA,eAAC/d,GAAA,EAAD,CACId,MAAO,CAAE0b,WAAY,IACrB3a,QA3FD,WACfuR,EAAkB,CAAEJ,WAAY,GAAIlV,UAAW,KAG/CghB,EAAajc,SAAQ,SAAAgP,GACjB8M,EAAe9M,EAAStT,IAAIsE,SAAQ,SAAA+c,GAChC3V,GAAUvD,QAAQ,CAAER,MAAO2Y,EAAcgB,cAAehO,EAAShN,KAAMib,YAAaF,UAK5FnB,EAAgB5b,SAAQ,YAAuC,IAApChF,EAAmC,EAAnCA,QAASgf,EAA0B,EAA1BA,oBAEhC,GAAIA,EAAoBE,YAAYxS,SAAS,YAAa,CAEtD,IAAMwV,EAAYlD,EAAoBE,YAAYxS,SAAS,aAE3D1M,EAAQgF,SAAQ,SAAAoS,GAEZ4H,EAAoBC,YAAYja,SAAQ,SAAAmd,GAEpC/V,GAAUvD,QACN,CAAER,MAAO2W,EAAoB3W,MAAO6O,SAAUE,EAAO1W,GAAIwhB,YAAWC,UAAWA,eAsEnFL,QAAS,eAAC,KAAD,IAHb,2C,uDC5PLM,GAdkC,SAAA3f,GAC7C,IAAM/B,EAAK+B,EAAM/B,KAAO+B,EAAM4f,QAAU5f,EAAM4f,QAAQrhB,IAAM,IAC5D,OACI,uBAAKsM,UAAU,YAAf,UACI,sBAAKrK,MAAO,CAACS,cAAe,IAA5B,SAAkCjB,EAAMO,QACxC,eAACsf,GAAA,EAAD,aACI5hB,GAAIA,EACJ6hB,QAAS9f,EAAMC,MACfG,SAAU,SAACC,GAAD,OAAOL,EAAMI,SAASC,EAAEC,OAAOwf,WACpC9f,EAAMU,WAAaV,EAAMU,WAAWC,YAAStD,Q,UCmBnD0iB,GA5BiC,SAAC/f,GAC7C,MAAkCwP,wBAA6BnS,GAA/D,mBAAO2iB,EAAP,KAAkBC,EAAlB,KACA,EAA8CzQ,oBAAS,GAAvD,mBAAO0Q,EAAP,KAAwBC,EAAxB,KAEIC,EAAcF,EACd,sBAAK1f,MAAO,CAACmO,SAAU,WAAYK,OAAQ,IAA3C,SACI,eAAC,gBAAD,aACI5B,MAAO4S,GAAahgB,EAAMC,OAAS,QACnCG,SAAU,SAACgN,GAAW6S,EAAa7S,EAAMiT,MACzCC,iBAAkB,SAAClT,GAAWpN,EAAMI,SAASgN,EAAMiT,KAAMJ,OAAa5iB,KACjE2C,EAAMU,WAAaV,EAAMU,WAAWC,YAAStD,MAE1D,KAEJ,OACI,uBAAKmD,MAAO,CAACmO,SAAU,WAAW5C,QAAQ,OAAQC,cAAc,SAAUyJ,eAAe,SAAUC,WAAW,UAA9G,UACI,sBAAKlV,MAAO,CAACS,cAAe,IAA5B,SAAkCjB,EAAMO,QACxC,sBACIsK,UAAU,sBACVtJ,QAAS,kBAAM4e,GAAoBD,IACnC1f,MAAO,CAACC,MAAO,GAAIqL,OAAQ,GAAIhB,aAAc,GAAIoB,WAAYlM,EAAMC,SAEtEmgB,M,WCGEG,GAxB0C,SAAAvgB,GAErD,IAAMW,EAASX,EAAMU,WAAaV,EAAMU,WAAWC,OAAS,GACtD6f,EAAyB7f,EAAzB6f,IAAKC,EAAoB9f,EAApB8f,IAAKC,EAAe/f,EAAf+f,KAAMC,EAAShgB,EAATggB,MACtBA,EAAQrF,MAAMC,QAAQoF,GAASA,OAAQtjB,EAEvC,IAAM4C,EAAQD,EAAMC,OAAS,CAAC,EAAE,GAEhC,OACI,uBAAK4K,UAAU,YAAf,UACI,sBAAKrK,MAAO,CAACS,cAAe,IAA5B,SAAkCjB,EAAMO,QACxC,eAACqgB,GAAA,EAAD,CACIC,aAAc,kBAAM7gB,EAAMO,OAC1BN,MAAOA,EACPG,SAAU,SAACqH,EAAOxH,GAAR,OAAkBD,EAAMI,SAASH,IAC3C6gB,kBAAkB,OAClBN,IAAKA,EAAKC,IAAKA,EAAKC,KAAMA,EAC1BC,MAAOA,QC4BRI,GA9C2C,SAAA/gB,GACtD,IAAMC,EAAuB,MAAfD,EAAMC,MAAgBD,EAAMC,MAAQ,CAAC,GAAI,IAEjD+gB,EAAe,SACjB3gB,EACAoX,EAAUwJ,GAEV,IAAMpN,EAASqN,GAAO7gB,EAAEC,OAAOL,OAC3BkhB,GAAQ,EAMZ,GALsB,kBAAXtN,IACG,IAAN4D,GAAkC,kBAAhBwJ,EAAS,KAAiBE,EAAQtN,GAAUoN,EAAS,IACjE,IAANxJ,GAAkC,kBAAhBwJ,EAAS,KAAiBE,EAAQtN,GAAUoN,EAAS,KAG3EE,EAAO,CACP,IAAMC,EAAiB,IAAN3J,EAAU,CAAC5D,EAAQoN,EAAS,IAAM,CAACA,EAAS,GAAIpN,GACjE7T,EAAMI,SAASghB,KAIvB,OACI,iCACI,sBAAK5gB,MAAO,CAACS,cAAe,IAA5B,SAAkCjB,EAAMO,QACxC,uBAAKC,MAAO,CAACuL,QAAS,QAAtB,UACI,eAAC7L,GAAA,EAAD,aACIM,MAAO,CAACmV,YAAa,GAAIvJ,KAAK,GAC9BzP,KAAK,SACLwD,QAAQ,WACRI,MAAM,MACNN,MAAOA,EAAM,GACbG,SAAU,SAACC,GAAD,OAAO2gB,EAAa3gB,EAAG,EAAGJ,KAC/BD,EAAMU,WAAaV,EAAMU,WAAWC,YAAStD,IACtD,eAAC6C,GAAA,EAAD,aACIM,MAAO,CAAC0b,WAAY,GAAI9P,KAAK,GAC7BzP,KAAK,SACLwD,QAAQ,WACRI,MAAM,MACNN,MAAOA,EAAM,GACbG,SAAU,SAACC,GAAD,OAAO2gB,EAAa3gB,EAAG,EAAGJ,KAC/BD,EAAMU,WAAaV,EAAMU,WAAWC,YAAStD,WCVvDgkB,GAlBkB,SAAArhB,GAC7B,IAAMshB,EAAkBthB,EAAMU,WAAaV,EAAMU,WAAWC,OAAS,GAC/DV,OAAwB5C,IAAhB2C,EAAMC,MAAsB,GAAKD,EAAMC,MAErD,OACI,+BACI,eAACC,GAAA,EAAD,CACIvD,KAAK,SACL4D,MAAOP,EAAMO,MACbN,MAAOA,EACPG,SAAU,SAACC,GAAD,OAAOL,EAAMI,SAAU8gB,GAAO7gB,EAAEC,OAAOL,SACjDO,MAASR,EAAMQ,MACfL,QAAQ,WACRkB,WAAYigB,OC0BbC,GA3CwB,SAACvhB,GAEpC,IAcMwhB,EAAa,WACf,OAAOlG,OAAOtb,EAAMU,WAAWC,OAAO8gB,OAAS,CAAC,IAAI,IAAIC,KAAK,OAI3DC,EAAoB3hB,EAAMU,WAAWC,OAAOihB,SAAW,CACzD1F,WAAY,GAAIvG,YAAa,GAAI3I,aAAc,EAAGvM,MAAO,IACzD,CACAyb,WAAY,EAAGvG,YAAa,EAAG3I,aAAc,EAAGvM,MAAO,KAErDohB,EAAU,2BAAQF,GAAR,IAA2BtU,UAAW,WAElDpN,EAAQD,EAAMC,MAMlB,OAJKA,IACDA,EAAQuhB,KAIR,uBAAKhhB,MAAO,CAACuL,QAAS,OAAQC,cAAe,SAAUyJ,eAAgB,SAAUC,WAAY,UAA7F,UACI,sBAAKlV,MAAO,CAACS,cAAe,IAA5B,SAAkCjB,EAAMO,QACxC,sBAAKC,MAAO,CAACuL,QAAS,OAAQC,cAAehM,EAAMU,WAAWC,OAAOihB,SAAW,SAAW,MAAOnM,eAAgB,SAAUC,WAAY,UAAW7K,UAAU,iBAA7J,SACK5K,EAAMiQ,KAAI,SAACiN,EAAK1F,GAAN,OAAY,eAAC,GAAD,CAAsBxX,MAAOkd,EAAK/c,SAAU,SAAC+c,GAAD,OApC3D,SAACtJ,EAAqC4D,GACtD,IAAIxX,EAAQhD,IAAE6kB,UAAU9hB,EAAMC,OAER,kBAAX4T,GAAkC,OAAXA,QAA8BxW,IAAXwW,IAEjD5T,IACAA,EAAQuhB,KAGZvhB,EAAMwX,GAAK5D,EAEX7T,EAAMI,SAASH,IAyBqE8hB,CAAY5E,EAAK1F,IAAIjX,MAAOqhB,GAA9DpK,Y,UClCpDuK,GAAaC,cAAe,kBAAM,eAAC,KAAD,CAAc/U,KAAM,GAAIE,MAAM,YAOhE8U,GAAeC,cAAgB,SAACniB,GAAD,OACjC,uBAAK6K,UAAU,WAAf,UACK7K,EAAMoiB,SAAW,eAACJ,GAAD,IAAgB,KAClC,eAAC,GAAD,eAAgBhiB,IACfA,EAAMqiB,OAAS,eAAC/U,GAAA,EAAD,CAAYzC,UAAU,eAAetJ,QAASvB,EAAMqiB,OAApD,SAA4D,eAAC,IAAD,CAAiBjV,MAAM,UAAuB,WAQ5HkV,GAAeC,cAAkB,SAACviB,GACpC,OAAO,sBAAK6K,UAAU,gBAAf,SAAgC7K,EAAMmU,cAK3CqO,GAAc,SAACviB,GAEjB,OAAIA,EAESqb,MAAMC,QAAQtb,GAGhBA,EAFA,CAACA,GAPS,IChBZwiB,GAAmB,CAC5BC,UAAWvhB,GACXwhB,KAAM9C,GACNzE,QAASP,GACT,oBCtBuC,SAAC7a,GAExC,OADAA,EAAMU,WAAWC,OAAOsa,aAAc,EAC/B,eAAC,GAAD,eAAcjb,KDqBrB4iB,KEdiC,SAAA5iB,GAEjC,IAIMC,EAAQD,EAAMC,OAAS,GACnB4iB,EAAS7iB,EAAM4f,QAAQlf,WAAWmiB,QAAU,GAElD,OACI,uBAAKhY,UAAU,YAAYrK,MAAOR,EAAMQ,MAAxC,UACI,sBAAKqK,UAAU,UAAf,SAA0B7K,EAAM4f,QAAQjb,OACxC,sBAAKkG,UAAU,kBAAf,SACKgY,EAAO3S,KAAI,SAAC4S,GAAD,OAA0B,eAAC,GAAD,CAGlClD,QAASkD,EACT7iB,MAAOA,EAAM6iB,EAAMvkB,KACnBwkB,cAAe,SAAC5F,GAAD,OAhBP6F,EAgBmCF,EAAMvkB,IAhBxB0kB,EAgB6B9F,OAftEnd,EAAMI,SAAN,2BAAoBJ,EAAMC,OAA1B,kBAAkC+iB,EAAWC,KADtB,IAACD,EAAiBC,IAapBH,EAAMvkB,cFA/B,iBGTyC,SAAAyB,GACzC,MAAwCwP,wBAA6BnS,GAArE,mBAAO6lB,EAAP,KAAsBC,EAAtB,KAEM5iB,EAAQP,EAAMO,QAAUP,EAAM4f,QAAU5f,EAAM4f,QAAQjb,KAAO,IAG7Dye,EADSpjB,EAAM4f,QAAQlf,WAAWmiB,QAAU,GAG9C5iB,EAAQD,EAAMC,OAAS,GAErBojB,EAAW,SAAC9kB,GACd,OAAOtB,IAAEY,KAAKmC,EAAM4f,QAAQlf,WAAWmiB,QAAU,GAAI,CAAC,MAAOtkB,KAG3D+kB,EAAe,SAAC/kB,EAAY0B,GAC9BD,EAAMI,SAAN,2BACOJ,EAAMC,OADb,kBACqB1B,EAAM0B,MAiBzBsjB,EAAa,SAAChlB,EAAa0B,GAE7B,IAAMujB,EAAQH,EAAS9kB,GAEvB,OAAKilB,EAGE,sCACH,yBAAQhjB,MAAO,CACXsM,YAAa,GAAIC,aAAc,GAAIZ,WAAY,EAAGlL,cAAe,EAAG6J,aAAc,EAClF0K,gBAAiB,SAFrB,SAGIgO,EAAM7e,OACV,eAAC,GAAD,2BACQ3E,GADR,IAEI4f,QAAO,2BAAM4D,GAAN,IAAa7e,KAAM,KAC1B1E,MAAOA,EACP8iB,cAAe,SAAC9iB,GAAD,OAAWqjB,EAAa/kB,EAAK0B,OAEhD,eAACqN,GAAA,EAAD,CAAY/L,QAAS,kBAtBV,SAAChD,GAChByB,EAAMI,SAASnD,IAAEC,KAAK8C,EAAMC,MAAO1B,IAqBJklB,CAAWllB,IAAtC,SAA4C,eAAC,IAAD,CAAiB6O,MAAM,aAdpD,MAkBvB,OACI,uBAAKvC,UAAU,YAAf,UACI,sBAAKA,UAAU,UAAf,SACKtK,IAEL,sBAAKsK,UAAU,gBAAf,SACKb,OAAOD,KAAK9J,GAAOiQ,KAAI,SAAA3R,GAAG,OAAIglB,EAAWhlB,EAAK0B,EAAM1B,SAEzD,uBAAKsM,UAAU,cAAf,UACI,eAAC,GAAD,CACI5K,MAAOijB,EACP9iB,SAAU,SAAC+c,GAAD,OAASgG,EAAehG,IAClC5c,MAAM,yBACNG,WAAY,CACR/D,KAAM,GACNgE,OAAQ,CACJya,QAASgI,EAAiBlT,KAAI,SAACsT,GAAD,MAAuC,CAAEjjB,MAAOijB,EAAM7e,KAAM1E,MAAOujB,EAAMjlB,YAGnH,eAAC+O,GAAA,EAAD,CAAY/L,QAAS,kBAtDd,SAAChD,GAChB,GAAKA,EAAL,CAEA,IAAMilB,EAAQH,EAAS9kB,GAClBilB,GAELF,EAAa/kB,EAAKilB,EAAME,UAgDWC,CAAWT,IAAtC,SAAsD,eAAC,KAAD,CAAe9V,MAAM,mBHhEvFA,MAAO2S,GACP6D,YAAarD,GACbsD,MAAO9C,GACPG,OAAQG,GACRyC,OAAQvC,GACRwC,KDqBiC,SAAA/jB,GACjC,IAAIC,EAAQuiB,GAAYxiB,EAAMC,OA0B9B,OACI,uBAAK4K,UAAU,YAAYrK,MAAOR,EAAMQ,MAAxC,UACI,sBAAKqK,UAAU,UAAUrK,MAAO,CAAES,cAAe,IAAjD,SAAwDjB,EAAM4f,QAAQjb,OACtE,eAAC2d,GAAD,CAAc0B,UAXJ,SAAC7gB,GAEfnD,EAAMI,SACF6jB,aAAUzB,GAAYxiB,EAAMC,OAAQkD,EAAK+gB,SAAU/gB,EAAKghB,YAQpBC,eAAa,EAAjD,SACKnkB,EAAMiQ,KAAI,SAACiN,EAAK1F,GAAN,OACP,eAACyK,GAAD,CACsB3N,MAAOkD,EAAGxX,MAAOkd,EACnC4F,cAAe,SAAC5F,GAAD,OAvBf,SAACtJ,EAAY4D,GAC7B,IAAIxX,EAAK,YAAOuiB,GAAYxiB,EAAMC,QAElCA,EAAMwX,GAAK5D,EAEX7T,EAAMI,SAASH,GAkB8B8hB,CAAY5E,EAAK1F,IAC9C4K,OAAQ,kBA5BT,SAAC5K,GAChBzX,EAAMI,SAASoiB,GAAYxiB,EAAMC,OAAOmT,QAAO,SAAC+J,EAAK5I,GAAN,OAAgBA,IAAUkD,MA2B3C4M,CAAW5M,IACzB2K,SAAUpiB,EAAM4f,QAAQlf,WAAWC,OAAOyhB,SAC1CxC,QAAS5f,EAAM4f,QAAQlf,WAAWC,OAAO2jB,WAL7C,eACiB7M,SAOzB,eAACnK,GAAA,EAAD,CACI,WAAS,iBACT/L,QAvCI,WACZvB,EAAMI,SAAN,sBAAmBoiB,GAAYxiB,EAAMC,QAArC,CAA6CD,EAAM4f,QAAQ8D,SAAW,SAoClE,SAGQ,eAAC,KAAD,CAAetW,MAAM,iBC7D5B8T,GAAS,SAACjhB,GACnB,GAAqB,kBAAVA,EAAoB,CAC3B,GAAc,KAAVA,EAAc,OAAO,KACzB,GAAI,CAAC,IAAK,KAAKgK,SAAShK,GAAQ,OAAOA,EAE3C,OAAOskB,OAAOtkB,IAGLukB,GAAqB,SAC9BC,EACAzkB,GAGIA,EAAM+iB,cACN/iB,EAAM+iB,cAAc0B,GACbzkB,EAAM0kB,gBAAkB1kB,EAAM2kB,qBAAuB3kB,EAAM4kB,2BAClE5kB,EAAM0kB,eAAe1kB,EAAM2kB,oBAAqB3kB,EAAM4f,QAAQrhB,IAAKkmB,EAAUzkB,EAAM4kB,4BAEnF9nB,QAAQ+G,MAAM,sCA2EhB8J,GAAqB,CACvB+W,e5B9F0B,SAACG,EAAYC,EAAY7kB,EAAO8kB,GAAhC,MAAiD,CAC3EpoB,KAAMkoB,EACNC,aACA7kB,QACA8kB,iB4B6FW/iB,gBARS,SAACvF,GAAD,MAAiB,CACrCoC,QAASpC,EAAMoC,WAOqB8O,GAAzB3L,EAtD8B,SAAChC,GAE1C,IAAIU,EAAaV,EAAM4f,QAAQlf,WAGzBskB,EAAiBvC,GAAa/hB,EAAW/D,MAE/C,IAAKqoB,EAAgB,OAAO,KAE5B,IAAMzkB,EAAQP,EAAM4f,QAAU5f,EAAM4f,QAAQjb,KAAO,GAC7CsgB,EAAc,eAACD,EAAD,2BACZhlB,GADY,IAEhBO,MAAOA,EACPG,WAAYA,EACZN,SAAU,SAACH,GAAD,OAAgBukB,GAAmBvkB,EAAOD,OAUpDklB,EAAgB,CAChB,YAAallB,EAAM4f,QAAQuF,KAAOnlB,EAAM4f,QAAQuF,KAAO,OAAS,IAAM,aAAenlB,EAAM4f,QAAQ8D,SAAW,QAC9G,kBAAkB,EAClB,cAAe,QACf,aAAkC,UAApBhjB,EAAW/D,KAAmB,SAAW,OAGvDkO,EAAS,0CAAsCnK,EAAW/D,KAAK4O,QAAQ,KAAM,KAApE,yBAAyFvL,EAAM4f,QAAQrhB,IAAvG,KAGb,OAFmB,MAAfyB,EAAMC,QAAe4K,GAAwB,oBAE1C,8CACHA,UAAWA,EACXtJ,QAnBgB,SAAClB,GACbA,EAAEuZ,UACFvZ,EAAE+kB,kBACFZ,GAAkC,MAAfxkB,EAAMC,MAAgBD,EAAM4f,QAAQ8D,QAAU,KAAM1jB,KAiB3EQ,MAAOR,EAAMQ,OACT0kB,GAJD,aAMED,Q,oBI1FPI,GAAqC,SAAArlB,GACvC,MAA0CwP,mBAAmB,IAA7D,mBAAO8V,EAAP,KAAsBC,EAAtB,KAEMC,EAAaxlB,EAAMwlB,WAInBC,EAHgBzlB,EAAM0lB,cAEXF,EAAWjnB,IAAMinB,EAAWjnB,IAAM,QAGnD,IAAKknB,EAAe,OAAO,KAE3B,IAAME,EAAa1oB,IAAE2oB,QAAQH,EAAe,YAEtCI,EAAe,CAACtnB,IAAK,OAAQoG,KAAM,KAAMmL,KAAM,GAAIgW,YAAY,IAC/DC,EAAYP,EAAWO,UAAX,CAAwBF,GAAxB,mBAA0CL,EAAWO,YAAa,CAACF,GAErF,OACI,eAAC,KAAD,CACIG,oBAAkB,EAClBC,cAAejmB,EAAM8G,SACrBof,SAAU,SAAC7Q,GACPrV,EAAMmmB,eAAenc,OAAOoc,YACxBpc,OAAOqc,QAAQhR,GAAQjC,QAAO,mCAAE7U,EAAF,iBAAkB+mB,EAAcrb,SAAS1L,SALnF,SASS,gBAAE8W,EAAF,EAAEA,OAAsBiR,GAAxB,EAAUtF,aAAV,EAAwBsF,cAAcC,EAAtC,EAAsCA,cAAeC,EAArD,EAAqDA,UAArD,OACG,wBAAM3b,UAAS,0CAAqC2a,EAAWjnB,KAAO2nB,SAAUI,EAAhF,UACI,6BAAY9lB,MAAO,CAAE6M,UAAW,QAAhC,SACKoZ,aAAMjB,EAAWM,eAEtB,sBAAKjb,UAAU,qBAAf,SACKkb,EAAU7V,KAAI,YAAkB,IAAhB3R,EAAe,EAAfA,IAAKoG,EAAU,EAAVA,KAElB,OAAOghB,EAAWpnB,GAEX,uBAAesM,UAAS,gDAA2CtM,GAAnE,UACH,sBAAKsM,UAAU,UAAUrK,MAAO,CAACS,cAAe,GAAIgW,WAAW,OAAQzF,SAAU,QAASnE,UAAW,QAArG,SAA+G1I,IAC/G,sBAAKkG,UAAU,kBAAf,SAAmC8a,EAAWpnB,GAAK2R,KAAI,SAAA0P,GAEvD,OAAKA,EAAQlf,WAEN,eAAC,GAAD,CAECqiB,cAAe,SAAC9iB,GACZslB,EAAiB,GAAD,mBAAKD,GAAL,CAAoB1F,EAAQrhB,OAC5CgoB,EAAc3G,EAAQrhB,IAAK0B,IAE/B2f,QAASA,EACT3f,MAAOoV,EAAOuK,EAAQrhB,MANjBqhB,EAAQrhB,KAHW,YAJnBA,GAFe,UAqBxC,uBAAKiC,MAAO,CAAEuL,QAAS,OAAQ8N,SAAU,OAAQpE,eAAgB,gBAAjE,UASI,gBAACnU,GAAA,EAAD,CACIC,QAAS,kBAAMilB,KACf,WAAS,qDACThmB,MAAO,CAAE2M,OAAQ,IAHrB,UAG2B,eAAC,KAAD,IAH3B,aAKA,gBAAC7L,GAAA,EAAD,CACI3E,KAAK,SACL,WAAS,qIACT6D,MAAO,CAAE2M,OAAQ,IAHrB,4BAImB,eAAC,KAAD,iBAWzCuZ,GAAuD,SAAA1mB,GACzD,IAAMwlB,EAAaxlB,EAAMwlB,WAEnBmB,EAAWnB,EAAWjnB,IAAMinB,EAAWjnB,IAAM,OAEnD,OACI,gBAAC,KAAD,WAEI,gBAAC,KAAD,CAA0BiC,MAAO,CAAEuL,QAAS,OAAQ0J,eAAgB,SAAUC,WAAY,UAA1F,UACI,eAACkR,GAAA,EAAD,UAAOpB,EAAW1V,OAClB,uBAAMtP,MAAO,CAACsM,YAAa,IAA3B,SAAiC0Y,EAAW7gB,UAEhD,eAAC,KAAD,UACI,eAAC,GAAD,eAAkB3E,QANjB2mB,IAwCFE,GAlBsC,SAAA7mB,GACjD,IAAI0lB,EAAgBzoB,IAAE2oB,QAAQ5lB,EAAMW,OAAQ,SAE5C,OACI,sBAAKH,MAAOR,EAAMQ,MAAOqK,UAAW7K,EAAM6K,UAA1C,SACK7K,EAAM8mB,YAAY5W,KAAI,SAACsV,EAAYuB,GAAb,OACnB,eAAC,GAAD,aAEIxS,MAAOwS,EACPvB,WAAYA,EACZE,cAAeA,GACX1lB,GAJC+mB,SCvFV/kB,gBAPS,SAACvF,GAAD,MAAiC,CACrDG,MAAOH,EAAMG,MACboqB,WAAY/nB,EAAiBxC,GAC7BD,QAASC,EAAMD,QACfqC,QAASpC,EAAMoC,WAGJmD,EAvC4B,SAAChC,GACxC,IAAMgnB,EAAahnB,EAAMgnB,WAEzB,IAAMA,EAAa,OAAO,KAC1B,IAAMC,EAAeD,EAAWlgB,SAEhChK,QAAQiF,KAAKilB,GAEb,IAAIE,EAAW,eAAC,GAAD,CACKrc,UAAW,0BAA4Bmc,EAAWtH,UAClD5Y,SAAUmgB,EACVtmB,OAAQqmB,EAAWrmB,OACnBmmB,YAAaE,EAAWF,YACxBX,eAAgB,SAACrf,GAAD,OAAc6C,GAAU9C,mBAAmBmgB,EAAW/oB,GAAI6I,IAC1E2C,aAAc,kBAAME,GAAU5C,iBAAiBigB,EAAW/oB,OAE9E,OACI,uBAAKuC,MAAK,eAAMR,EAAMQ,OAAtB,UACI,gBAACsc,GAAA,EAAD,CAAMC,WAAS,EAACvc,MAAO,CAACsM,YAAa,QAArC,UACI,eAACgQ,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAG3Z,MAAO,CAACsL,OAAO,OAAQC,QAAS,OAAQC,cAAe,SAAUyJ,eAAgB,SAAUC,WAAW,UAAhI,SACI,eAAC,GAAD,CAAUtY,KAAM4pB,EAAYxmB,MAAO,CAACsL,OAAQ,YAEhD,eAACgR,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAG3Z,MAAO,CAAE0W,QAAS,GAAInL,QAAS,OAAQC,cAAe,UAAhF,SACiC,aAA5BhM,EAAMnB,QAAQsoB,UAA2B,sBAAKtc,UAAU,aAAarK,MAAO,CAAE4mB,UAAW,QAAhD,SAA0DF,IAAkBA,OAG9H,eAAC,KAAD,CAAc3Z,OAAO,QAAQ8Z,WAAS,EAAC5Z,UAASzN,EAAMxD,QAAQsK,WAAY9G,EAAMxD,QAAQsK,SAAS4G,qB,gCCrB9F4Z,GAlBgB,SAAAtnB,GAC3B,OACI,gBAACunB,GAAA,EAAD,WACI,gBAACC,GAAA,EAAD,CACIhnB,MAAO,CAACuL,QAAS,OAAQ6J,OAAQ,UAAWH,eAAgB,gBAAiBC,WAAY,UAD7F,UAEI,uBAAMlV,MAAO,CAAC4M,MAAO,OAAQuI,YAAa,IAA1C,SAAgD3V,EAAMqF,WACtD,uBAAM7E,MAAO,CAACyW,WAAY,QAA1B,SAAoCjX,EAAMsL,SAAS3G,UAEvD,eAAC8iB,GAAA,EAAD,CAAuBjnB,MAAO,CAACgR,SAAU,IAAzC,SACI,eAAC,KAAD,UAAgBxR,EAAMsL,SAASwa,gBAEnC,eAAC4B,GAAA,EAAD,UACI,eAACpmB,GAAA,EAAD,CAAQC,QAASvB,EAAM2nB,YAAvB,gCCFDC,GAZkB,SAAA5nB,GAC7B,OACI,sBAAK6K,UAAU,aAAarK,MAAO,CAAC6M,UAAW,OAAQvC,aAAc,EAAGsc,UAAW,QAAnF,SACKpd,OAAOD,KAAK/J,EAAM0J,WAAWwG,KAAI,SAAC7K,GAAD,OAC9B,eAAC,GAAD,CACIA,SAAUA,EAAUiG,SAAUtL,EAAM0J,UAAUrE,GAC9CsiB,YAAa,kBAAM3nB,EAAM2nB,YAAYtiB,YC8B1CrD,gBALS,SAACvF,GAAD,MAAiB,CACrCuqB,WAAY/nB,EAAiBxC,GAC7BD,QAASC,EAAMD,WAGJwF,EAzB0B,SAAAhC,GACrC,OACI,uBAAKQ,MAAK,2BAAMR,EAAMQ,OAAZ,IAAmBsM,YAAa,SAA1C,UAEI,gBAACgQ,GAAA,EAAD,CAAMC,WAAS,EAAf,UACI,eAACD,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAG3Z,MAAO,CAAEsL,OAAQ,OAAQC,QAAS,OAAQC,cAAe,SAAUyJ,eAAgB,SAAUC,WAAY,UAAnI,SACI,eAAC,GAAD,CAAUtY,KAAM4C,EAAMgnB,WAAYxmB,MAAO,CAAEsL,OAAQ,YAEvD,eAACgR,GAAA,EAAD,CAAMI,MAAI,EAAC9C,GAAI,GAAID,GAAI,EAAG3Z,MAAO,CAAE0W,QAAS,GAAInL,QAAS,OAAQC,cAAe,UAAhF,SACI,eAAC,GAAD,CACItC,UAAW1J,EAAMgnB,WAAWtd,UAC5Bie,YAAa,SAACppB,GAAD,OAAgBoL,GAAUpC,iBAAiBvH,EAAMgnB,WAAW/oB,GAAIM,WAGzF,eAAC,KAAD,CAAc8oB,WAAS,EAAC5Z,UAASzN,EAAMxD,QAAQsK,WAAY9G,EAAMxD,QAAQsK,SAAS4G,qB,0CCXxFd,I,QAAS,CAAErC,UAAU,IAErBsd,G,kDAEF,WAAY7nB,GAAQ,IAAD,uBACf,cAAMA,IAKVqJ,gBAAkB,CACdye,cAAe,kBAAM,EAAKre,gBAC1Bse,oBAAqB,kBAAM,EAAK5B,eAAe,SARhC,EAWnBA,eAAiB,SAACrf,GAEG,QAAbA,IACAA,EAAW,EAAK9G,MAAMgnB,WAAWgB,qBAGrCre,GAAU9C,mBAAmB,EAAK7G,MAAMgnB,WAAW/oB,GAAI6I,IAjBxC,EAgCnB2C,aAAe,WAEXE,GAAU5C,iBAAiB,EAAK/G,MAAMgnB,WAAW/oB,KAhCjD,IAAM+oB,EAAahnB,EAAMgnB,WAFV,OAGf,EAAKvqB,MAAQuqB,EAAWjc,OAHT,E,wDAqBnB,WAEIpB,GAAUzC,aAAanG,KAAKf,MAAMgnB,WAAW/oB,GAA7C,2BAAqD8C,KAAKtE,OAA1D,IAAiE6K,WAAW,O,oBAehF,WAAU,IAAD,OAIL,OAFmBvG,KAAKf,MAAMgnB,WAQ1B,cAHA,CAGA,OAAKxmB,MAAK,2BAAMO,KAAKf,MAAMQ,OAAjB,IAAwBsL,OAAQ,SAA1C,SACI,eAAC,KAAD,CACA1E,KAAMrG,KAAKtE,MAAM2K,KACjBD,OAAQpG,KAAKtE,MAAM0K,OACnByF,OAAQA,GACRvF,OAAQtG,KAAKtE,MAAM4K,OACnB4gB,OAAQA,KACRznB,MAAK,eAAMO,KAAKf,MAAMQ,OACtBmM,SAAU,SAACvF,EAAMD,EAAQE,GAAf,OACN,EAAKjG,SAAS,CAAEgG,OAAMD,SAAQE,YAElCkF,kBAAgB,EAChB2b,OAAK,EACLC,2BAAyB,MAnBT,S,GA5CP3mB,aA2EVQ,gBAJS,SAAAvF,GAAK,MAAK,CAC9BuqB,WAAY/nB,EAAiBxC,MAGO,KAAzBuF,CAA+B6lB,IC7D/BO,GA1BuB,SAACpoB,GAEnC,IAKA,EAAmCA,EAAM1C,IAA9BsI,EAAX,EAAO3H,GAAiByH,EAAxB,EAAkBf,KAElB,OACI,uBAEQkG,UAAW7K,EAAMqR,SAAW,iBAAmB,UAC/C9P,QAASvB,EAAMqR,cAAWhU,EAAY2C,EAAMqoB,UAHpD,UAII,sBACIpqB,GAAI2H,EACJ0iB,gBAAiBtoB,EAAMqR,SAEvBkX,OAhBU,SAACloB,GACfA,EAAEC,OAAOkoB,MAAMnoB,EAAEC,OAAOkoB,OAC5B,IAAM7jB,EAAOtE,EAAEC,OAAOmoB,YAClB9jB,GAAM3E,EAAM0oB,cAAc/jB,IAS1B,SAMMe,IACL1F,EAAMqR,SAAW,sBAAKxG,UAAU,eAAetJ,QAASvB,EAAM2F,UAA7C,SAAwD,eAAC,KAAD,CAAgBuH,KAAM,OAAc,OAVrGtH,ICdR+iB,GAAb,4MAEItf,gBAAkB,CACdb,iBAAkB,kBAAM,EAAKogB,gBAAgB,UAC7CngB,qBAAsB,kBAAM,EAAKmgB,gBAAgB,SACjDlgB,QAAS,kBAAM,EAAKuP,UACpBtP,IAAK,kBAAM7L,QAAQiF,KAAK,SANhC,EASI6mB,gBAAkB,SAACtZ,GAEf,IAGIuZ,EAHE/qB,EAAO,EAAKkC,MAAMlC,KAClB2Z,EAAIxa,IAAEoc,UAAUvb,EAAM,CAAC,KAAM,EAAKkC,MAAMtC,OAAOJ,MAGnC,SAAdgS,EACAuZ,EAAa,IAANpR,EAAUA,EAAE,EAAI3Z,EAAKE,OAAQ,EACf,UAAdsR,IACPuZ,EAAOpR,IAAM3Z,EAAKE,OAAS,EAAIyZ,EAAE,EAAI,GAGzC,EAAKzX,MAAMH,aAAa/B,EAAK+qB,GAAM5qB,KArB3C,EAwBI6qB,WAAa,SAAChrB,GACVgG,SAASC,cAAc,IAAIC,YAAY,aAAc,CAACC,OAAQ,CAACnG,KAAMA,OAzB7E,EA4BIma,OAAS,WAELtO,GAAUlE,UA9BlB,EAkCIsR,cAAgB,WACZ,OAAO,sBAAKvW,MAAO,CAACsM,YAAa,IAA1B,SACH,uBAAMtM,MAAO,CAAC4M,MAAO,WAArB,iDApCZ,4CAwCI,WAAU,IAAD,OAECtP,EAAOiD,KAAKf,MAAMlC,MAAQ,GAC1BirB,EAAehoB,KAAKf,MAAMgpB,cAAgBZ,GAC1Ca,EAAkBloB,KAAKf,MAAMkpB,iBAAoB,SAAClpB,GAAD,OAAW,MAC5DmpB,EAAkBpoB,KAAKf,MAAMmpB,iBAAmBpoB,KAAKgW,gBAE3D,OACI,uBAAKvW,MAAK,aAAGuL,QAAS,OAAQ8N,SAAU,OAAQnE,WAAW,UAAa3U,KAAKf,MAAMQ,OAAnF,UACI,eAAC,iBAAD,CAAemL,OAAQrD,GAAcC,OAAQqD,SAAU7K,KAAKsI,kBAC3C,IAAhBvL,EAAKE,OACFmrB,EAEArrB,EAAKoS,KACD,SAAA5S,GAAG,OAAI,eAACyrB,EAAD,CACHzrB,IAAKA,EACL+T,SAAU,EAAKrR,MAAMtC,OAAOJ,MAAQA,EAAIW,GACxCoqB,UAAW,kBAAM,EAAKroB,MAAMH,aAAavC,EAAIW,KAC7C0H,UAAW,kBAAMgE,GAAUhE,UAAUrI,EAAIW,KACzCyqB,cAAe,SAAC/jB,GAAD,OAAUgF,GAAU9D,UAAUvI,EAAIW,GAAI,CAAC0G,KAAMA,UAIxE,eAACskB,EAAD,CAAiB1nB,QAASR,KAAKkX,gBA/D/C,GAA0BzW,aA0EpBmM,GAAqB,CACvB9N,iBAGWmC,gBATS,SAAAvF,GAAK,MAAK,CAC9BqB,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,UAOsBiQ,GAAzB3L,CAA6C2mB,IC9D5DS,qBAAU,CAACC,SAAU,QAASC,+BAA+B,IAE7D,IAAMlB,GAAM,SAACpoB,GACT,MAAgCwP,oBAAS,GAAzC,mBAAOjF,EAAP,KAAiBgf,EAAjB,KAEIhf,IAAavK,EAAMqR,UAAUkY,GAAY,GAE7C,IAOa7jB,EAAW1F,EAAM1C,IAAvBqH,KAEP,OAAI4F,EACO,eAACrK,GAAA,EAAD,CAAWK,MAAM,WAAWipB,aAAc9jB,EAAS+jB,WAVxC,SAACppB,GACL,UAAVA,EAAE9B,MACFyB,EAAM0oB,cAAcroB,EAAEC,OAAOL,OAC7BspB,GAAY,OAST,eAACjoB,GAAA,EAAD,CACH8L,MAAM,UACN5M,MAAO,CAACgV,gBAAiBxV,EAAMqR,SAAW,kBAAehU,EAAWsY,YAAa,IACjFpU,QAASvB,EAAMqR,cAAWhU,EAAY2C,EAAMqoB,UAC5CqB,cAAe,kBAAMH,GAAY,IACjClK,QAASrf,EAAMqR,SAAW,eAAC,KAAD,CAAgBxG,UAAU,eAAetJ,QAASvB,EAAM2F,iBAAetI,EAL9F,SAMDqI,KAIRikB,GAAe,SAAC3pB,GAClB,OAAO,eAACsN,GAAA,EAAD,CAAYF,MAAM,UAAU,aAAW,cAAc3B,UAAU,OAAOlK,QAASvB,EAAMuB,QAArF,SACH,eAAC,KAAD,CAAa6L,MAAM,QAAQvC,UAAU,kBAIvC+e,GAAQ,SAAC5pB,GACX,IAAO4S,EAAkBsC,qBAAWvC,IAA7BC,eAED2G,EAAYvP,OAAOD,KAAK6I,GAAgBxH,QAAO,SAACye,EAAGC,GAAJ,OAAUD,EAAIjX,EAAekX,GAAG9rB,SAAQ,GACvF+rB,EAAcrW,iBAAO6F,GAGvBwQ,EAAY/V,UAAYuF,IACxBzc,QAAQiF,KAAKwX,EAAWvZ,EAAMtC,OAAOD,MACnB,IAAd8b,GAAyC,oBAAtBvZ,EAAMtC,OAAOD,KAChCuC,EAAMF,cAAc,SACbyZ,EAAY,GAA2B,oBAAtBvZ,EAAMtC,OAAOD,MACrCuC,EAAMF,cAAc,mBAExBiqB,EAAY/V,QAAUuF,GAG1B,IAAM5b,EAAYV,IAAEY,KAAKmC,EAAMlC,KAAM,CAAC,KAAMkC,EAAMtC,OAAOJ,MACrDK,GAEAA,EAAUf,MAAM2F,SAAQ,SAAApF,GAEf6C,EAAMpD,MAAMO,IAEbwM,GAAUzD,QAAQ/I,MAM9B,IAAMkM,EAAkB,CACpBpB,gBAAiB,kBAAMjI,EAAMF,cAAc,UAC3CiI,mBAAoB,kBAAMjL,QAAQiF,KAAKioB,qCAGtChqB,EAAMtC,OAAON,MAAS,CAAC,kBAAmB,SAAS6M,SAASjK,EAAMtC,OAAOD,OAC1EuC,EAAMF,cAAc,SAGxB,IAAMmqB,EAAgB,CAClB,MAASxT,GACT,iBAAoBoR,GACpB,aAAgBqC,GAChB,YAAeC,GACf,gBAAmBC,IACrBpqB,EAAMtC,OAAOD,MAEf,OACI,uBAAK+C,MAAO,CAAEsL,OAAQ,OAAQC,QAAS,OAAQC,cAAe,UAA9D,UACI,eAAC,iBAAD,CAAeL,OAAM,eAAO7D,IAAmB8D,SAAUvC,IACzD,gBAACghB,GAAA,EAAD,CAAS7pB,MAAO,CAAEgV,gBAAiB,WAAnC,UACK,CAAC,SAASvL,SAASjK,EAAMtC,OAAOD,MAAQ,KACrC,eAAC6D,GAAA,EAAD,CAAQ8L,MAAM,UAAU7L,QAAS,kBAAMvB,EAAMF,cAAc,UAA3D,+BAEmB,UAAtBE,EAAMtC,OAAOD,KAAmB,eAAC,GAAD,CAAMurB,aAAcZ,GAAKc,gBAAiBS,KAAmB,QAElG,eAACM,EAAD,CACIzpB,MAAO,CAAE4L,KAAM,GACf5P,QAASwD,EAAMxD,QACf8tB,KAAMtqB,EAAMF,oBAoBtB6N,GAAqB,CACvB/N,iBACAE,kBAGWkC,gBAZS,SAAAvF,GAAK,MAAK,CAC9BG,MAAOH,EAAMG,MACbkB,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,OACdlB,QAASC,EAAMD,WAQqBmR,GAAzB3L,EAlBW,SAAChC,GACvB,OAAO,eAAC,GAAD,UACH,eAAC,GAAD,eAAWA,SC/HnB,SAASuqB,KACP,MAAmDC,OACnD,MAAO,CACL/pB,MAFF,EAAQgqB,WAGN3e,OAHF,EAA2B4e,aAsB7B,IASeC,GATE,SAAA3qB,GACb,IAAQ8L,EAhBZ,WACE,MAAgD0D,mBAAS+a,MAAzD,mBAAOK,EAAP,KAAyBC,EAAzB,KAWA,OATAC,qBAAU,WACR,SAASC,IACPF,EAAoBN,MAItB,OADAC,OAAOhgB,iBAAiB,SAAUugB,GAC3B,kBAAMP,OAAOQ,oBAAoB,SAAUD,MACjD,IAEIH,EAIcK,GAAXnf,OAER,OAAO,yBACHof,IAAK,kCAAmCze,MAAM,qBAAqB,aAAW,qBAC9EjM,MAAO,CAACsL,OAAQA,EAAS,GAAIrL,MAAO,U,UC3B5C,SAAS0qB,GAAInrB,GAET,IAAMorB,EAAO1X,mBAGb,EAA4BlE,oBAAS,GAArC,mBAAO6b,EAAP,KAAgBC,EAAhB,KACA,EAA4B9b,oBAAS,GAArC,mBAAO9R,EAAP,KAAe6tB,EAAf,KAOA,OAJAC,cAAS,WACLJ,EAAKpX,QAAQyX,SAASlR,EAAI6Q,EAAKpX,QAAQyX,SAAShR,GAAK,OAIrD,kDACQza,GADR,IAEIqM,IAAK+e,EACLM,MAAOhuB,EAAS,CAAC,IAAK,IAAK,KAAO,CAAC,EAAG,EAAG,GACzC6D,QAAS,SAAClB,GAAD,OAAOkrB,GAAW7tB,IAC3BiuB,cAAe,SAACtrB,GAAD,OAAOirB,GAAS,IAC/BM,aAAc,SAACvrB,GAAD,OAAOirB,GAAS,IANlC,UAOI,oCAAmBO,OAAO,WAAW1oB,KAAM,CAAC,EAAG,EAAG,KAClD,uCAAsB0oB,OAAO,WAAWze,MAAOie,EAAU,UAAY,eAKlE,SAASS,GAAa9rB,GAEjC,OAAO,gBAAC,KAAD,yBAAQQ,MAAOR,EAAMQ,OAAWR,GAAhC,cACH,kCACA,6BAAY2O,SAAU,CAAC,GAAI,GAAI,MAC/B,eAAC,GAAD,CAAKA,SAAU,EAAE,IAAK,EAAG,GAAIod,MAAO,IACpC,eAAC,GAAD,CAAKpd,SAAU,CAAC,IAAK,EAAG,SCdhC,IAOMnK,GAAc,SAACiU,GACjB,IAAMuT,EAAcvT,EAAc,GAClC9O,GAAUlF,oBAAoBunB,IAG5BC,GAAkB,WACpBtiB,GAAU/E,gBAAe,SAACF,GACtB,IAAIwnB,EAAO,IAAIC,KAAK,CAACznB,IACf0nB,EAAM5B,OAAO6B,IAAIC,gBAAgBJ,GAEjCK,EAAOzoB,SAAS0oB,cAAc,KACpCD,EAAKhc,KAAO6b,EACZG,EAAKE,aACL,WADA,sBAKAF,EAAKG,YA6EE1qB,gBAJS,SAACvF,GAAD,MAAkC,CACtDD,QAASC,EAAMD,WAGJwF,EAzEkC,SAAAhC,GAC7C,MAAkCwP,sBAAS7F,KAAaA,GAAUvH,SAASuH,GAAUvH,OAAOW,WAA5F,mBAAOA,EAAP,KAAkB4pB,EAAlB,KACA,EAA4Bnd,mBAAS,YAArC,mBAAOod,EAAP,KAAeC,EAAf,KAMA,GAJAljB,GAAUzG,WAAU,WAChBypB,GAAa,OAGZ5pB,EACD,OAAO,uBAAKvC,MAAK,2BAAMR,EAAMQ,OAAZ,IAAmBsL,OAAO,OAAQC,QAAQ,OAAQC,cAAe,WAA3E,UACH,sBAAKxL,MAAO,CAAE2L,WAAY,KAA1B,SACI,sBAAK3L,MAAO,CAAEgR,SAAU,QAASyF,WAAY,QAA7C,yDAEJ,eAAC6U,GAAD,CAActrB,MAAO,CAAC4L,KAAM,GAAI0gB,OAAQ,CAAEne,SAAU,CAAC,EAAG,EAAG,MAC3D,sBAAKnO,MAAO,CAAES,cAAe,IAAKuQ,SAAU,SAA5C,0EAIR,GAAKvU,IAAE8vB,QAAQ/sB,EAAMxD,SAAW,OAAO,KAEvC,IAAIiP,EAAY,KAmBhB,MAlBe,aAAXmhB,EACAnhB,EAAY,sBAAKjL,MAAO,CAAC0W,QAAS,GAAI9K,KAAM,GAAIvB,UAAU,aAA9C,SACR,eAAC,GAAD,CACIA,UAAS,yDAAoD7K,EAAMxD,QAAQwwB,cAC3ElmB,SAAU9G,EAAMxD,QAAQsK,SACxBnG,OAAQX,EAAMxD,QAAQmE,OACtBmmB,YAAa9mB,EAAMxD,QAAQsqB,YAC3BX,eAAgBxc,GAAUrE,sBAC1BmE,aAAcE,GAAUnE,wBAEd,YAAXonB,IACPnhB,EAAY,sBAAKjL,MAAO,CAAC0W,QAAS,GAAI9K,KAAM,GAAIvB,UAAU,aAA9C,SACR,eAAC,GAAD,CACInB,UAAW1J,EAAMxD,QAAQkN,UACzBie,YAAa,SAACppB,GAAD,OAAgBoL,GAAUvE,oBAAoB7G,SAKnE,uBAAKiC,MAAK,2BAAMR,EAAMQ,OAAZ,IAAmBsL,OAAQ,OAAQC,QAAS,OAAQC,cAAe,WAA7E,UACI,gBAACqe,GAAA,EAAD,CAAS7pB,MAAO,CAACgV,gBAAiB,UAAWC,eAAgB,iBAA7D,UACI,iCACI,eAACnU,GAAA,EAAD,CACI8L,MAAM,UACN5M,MAAO,CAACgV,gBAA4B,aAAXoX,EAAwB,kBAAevvB,EAAWsY,YAAa,IACxFpU,QAAS,kBAAMsrB,EAAU,aAH7B,sBAIA,eAACvrB,GAAA,EAAD,CACI8L,MAAM,UACN5M,MAAO,CAACgV,gBAA4B,YAAXoX,EAAuB,kBAAevvB,GAC/DkE,QAAS,kBAAMsrB,EAAU,YAH7B,wBAKJ,iCACI,eAACvrB,GAAA,EAAD,CAAQ8L,MAAM,UAAU,WAAS,qCAAqC7L,QAAS0qB,GAA/E,sBACA,eAAC3qB,GAAA,EAAD,CAAQ8L,MAAM,UAAU,WAAS,uBAAuB7L,QAAS,kBAlF1D,SAAC0rB,GACxB,IAAM1oB,EAAO9C,OAAO,oEAAsEwrB,EAAenmB,SAASomB,UAC7G3oB,GAELoF,GAAU1D,YAAY1B,GA8EiEmM,CAAmB1Q,EAAMxD,UAAhG,kBACA,eAAC8E,GAAA,EAAD,CAAQ8L,MAAM,UAAd,SAGI,eAAC4M,GAAD,CAAYnM,YAAY,OAAOzN,SAAUoE,aAIpDiH,EACD,eAAC,KAAD,CAAc4b,WAAS,EAAC9Z,OAAO,QAAQE,UAASzN,EAAMxD,QAAQsK,WAAY9G,EAAMxD,QAAQsK,SAAS4G,qB,UC7GxFyf,G,kDAEjB,WAAYntB,GAAO,IAAD,8BACd,cAAMA,IAEDvD,MAAQ,CAAEsG,UAAW4G,GAAUvH,OAAOW,WAH7B,E,qDAMlB,WAAqB,IAAD,OAChB4G,GAAUzG,WAAU,kBAAM,EAAK9B,SAAS,CAAC2B,WAAW,OACpD4G,GAAUtG,cAAa,kBAAM,EAAKjC,SAAS,CAAE2B,WAAW,S,oBAG5D,WAEI,IAAMvC,EAAQO,KAAKtE,MAAMsG,UAAY,CAAEyS,gBAAiB,cAAiB,CAAEA,gBAAiB,UAEtF4X,EAAYrsB,KAAKtE,MAAMsG,UAAYhC,KAAKf,MAAMqtB,eAAiBtsB,KAAKf,MAAMstB,kBAEhF,OAAO,gDAASvsB,KAAKf,OAAd,IAAqBQ,MAAK,uCAAMA,GAAUO,KAAKf,MAAMQ,OAAU4sB,GAC9D,WAAUrsB,KAAKtE,MAAMsG,UAAX,uBAAuC4G,GAAUzH,YAAe,0BAC1E,aAAW,OACX,wBAAuB1B,EAAMgV,gBAH9B,SAIFzU,KAAKtE,MAAMsG,UAAY,eAAC,KAAD,CAAQqK,MAAM,QAAQF,KAAM,KAAS,eAAC,KAAD,CAAWE,MAAM,UAAUF,KAAM,Y,GAvB5D1L,a,0CCS9C,SAAS+rB,GAASvtB,GAChB,IAAQmU,EAAqCnU,EAArCmU,SAAUlU,EAA2BD,EAA3BC,MAAOsU,EAAoBvU,EAApBuU,MAAUiZ,EAAnC,YAA6CxtB,EAA7C,IAEA,OACE,8CACEytB,KAAK,WACL9d,OAAQ1P,IAAUsU,EAClBtW,GAAE,0BAAqBsW,GACvB,uCAA+BA,GAC/B/T,MAAO,CAAC4L,KAAM,EAAGN,OAAQ,SACrB0hB,GANN,aAQGvtB,IAAUsU,GACT,eAAC4W,EAAA,EAAD,CAAKuC,GAAI,CAACjtB,MAAO,OAAQqL,OAAQ,QAAjC,SACGqI,OAaX,SAASwZ,GAAUpZ,GACjB,MAAO,CACLtW,GAAG,cAAD,OAAgBsW,GAClB,gBAAgB,mBAAhB,OAAoCA,IAIzB,SAASqZ,KACtB,MAA0Bre,WAAe,GAAzC,mBAAOtP,EAAP,KAAc4tB,EAAd,KAMA,OACE,gBAAC1C,EAAA,EAAD,CACAuC,GAAI,CAAEjf,SAAU,EAAG1C,QAAS,OAAQD,OAAQ,SAD5C,UAEA,gBAACqf,EAAA,EAAD,CAAKuC,GAAI,CAACI,QAAQ,oBAAlB,UACI,eAAC,GAAD,CACIT,eAAgB,CAAE7X,gBAAiB,aAAczJ,QAAS,QAC1DvL,MAAO,CAAC0W,QAAS,MACrB,gBAAC,IAAD,CACA6W,YAAY,WACZ5tB,QAAQ,aACRF,MAAOA,EACPG,SAfe,SAACqH,EAAOgd,GAC3BoJ,EAASpJ,IAeL,aAAW,gBACXiJ,GAAI,CAAE3T,YAAa,EAAGiU,YAAa,WANnC,UAQI,eAAC,IAAD,aAAKztB,MAAM,WAAcotB,GAAU,KACnC,eAAC,IAAD,aAAKptB,MAAM,YAAeotB,GAAU,KACpC,eAAC,IAAD,aAAKptB,MAAM,aAAgBotB,GAAU,WAG7C,eAACJ,GAAD,CAAUttB,MAAOA,EAAOsU,MAAO,EAA/B,SACA,eAAC,GAAD,MAEA,eAACgZ,GAAD,CAAUttB,MAAOA,EAAOsU,MAAO,EAA/B,SACA,eAAC,GAAD,MAEA,eAACgZ,GAAD,CAAUttB,MAAOA,EAAOsU,MAAO,EAA/B,SACA,eAAC,GAAD,MAEA,eAAC,KAAD,O,IC3EE0Z,G,kDAEF,WAAYjuB,GAAO,IAAD,8BACd,cAAMA,IA6BV2Q,gBAAkB,SAACnU,GAEf,IAAKA,EACD,OAAOmN,GAAUukB,gBAGrB,EAAKluB,MAAMmuB,kBAAkB3xB,IAjC7BsH,SAAS0G,iBAAiB,mBAAmB,SAACnK,GAAD,OAAO,EAAKsQ,gBAAgBtQ,EAAE4D,OAAOzH,YAElFsH,SAAS0G,iBAAiB,cAAc,kBAAM,EAAKmG,qBAMnD7M,SAAS0G,iBAAiB,QAAQ,SAACnK,GAC/B,IAAMjD,EAAOiD,EAAE4D,OAAO7G,KACtB4C,EAAMP,SAAN,eAAkBrC,EAAKa,GAAKb,OAIhC0G,SAAS0G,iBAAiB,WAAW,kBAAM,EAAKmG,qBAEhD7M,SAAS0G,iBAAiB,iBAAiB,SAACnK,GACxCA,EAAE4D,OAAOmqB,YAAY7rB,SAAS,SAAApF,GAE1BwM,GAAUzD,QAAQ/I,SAtBZ,E,0CAwClB,WACI,OAAO,S,GA3CWqE,aAuDpBmM,GAAqB,CACvBwgB,kB9C/C6B,SAAC3xB,GAE9B,MAAO,CACHG,KAAMT,EACNM,Y8C4CJqD,gBACAF,kBACAC,iBACAH,YACA4uB,iB9CpB4B,SAACC,GAAD,MAAoB,CAChD3xB,KAAMb,EACNwyB,kB8CmBAC,gB9CwB2B,SAACC,GAAD,MAAmB,CAC9C7xB,KAAMZ,EACNyyB,iB8CzBA1uB,kBAGWkC,gBAnBS,SAAAvF,GAAK,MAAK,CAC9BG,MAAOH,EAAMG,MACb8V,WAAYjW,EAAMD,QAAQkW,WAC1B5U,KAAMrB,EAAMD,QAAQsB,KACpBJ,OAAQjB,EAAMiB,OACdlB,QAASC,EAAMD,WAcqBmR,GAAzB3L,CAA6CisB,IC9D5D,GAA2B/uB,IAApBC,GAAP,GAAOA,MAAOI,GAAd,GAAcA,UAiBCkvB,OAff,WACE,OACE,eAAC,IAAD,CAAUtvB,MAAOA,GAAjB,SACE,gBAAC,IAAD,CAAaI,UAAWA,GAAxB,UACE,eAAC,GAAD,IACA,sBAAKsL,UAAU,MAAMrK,MAAO,CAACuL,QAAS,OAAQC,cAAe,UAA7D,SACE,sBAAKnB,UAAY,aAAarK,MAAO,CAACsL,OAAQ,SAA9C,SACE,eAAC8hB,GAAD,cCTQc,QACW,cAA7BlE,OAAOmE,SAASC,UAEe,UAA7BpE,OAAOmE,SAASC,UAEhBpE,OAAOmE,SAASC,SAASC,MACvB,2DCZNC,IAASC,OAAO,eAAC,GAAD,IAASjrB,SAASkrB,eAAe,SD2H3C,kBAAmBC,WACrBA,UAAUC,cAAcC,MAAMC,MAAK,SAAAC,GACjCA,EAAaC,iB","file":"static/js/main.839575ce.chunk.js","sourcesContent":["export const ADD_PLOTS = 'ADD_PLOTS'\nexport const REMOVE_PLOT = 'REMOVE_PLOT'\nexport const ADD_TABS = 'ADD_TABS'\nexport const SET_STRUCTURES = 'SET_STRUCTURES'\nexport const SET_PLOTABLES = 'SET_PLOTABLES'\nexport const SET_TAB_PLOTS = 'SET_TAB_PLOTS'\nexport const SET_SESSION_TABS = 'SET_SESSION_TABS'\n//Activate\nexport const SET_ACTIVE_PLOT = 'SET_ACTIVE_PLOT'\nexport const SET_ACTIVE_TAB = 'SET_ACTIVE_TAB'\n//Deactivate\nexport const SET_SESSION = 'SET_SESSION'\nexport const CLEAR_SESSION = 'CLEAR_SESSION'\nexport const START_LOADING_PLOT = 'START_LOADING_PLOT'\nexport const END_LOADING_PLOT = 'END_LOADING_PLOT'\nexport const SET_ACTIVE_PAGE = 'SET_ACTIVE_PAGE'\n\n\n","import { CLEAR_SESSION, SET_SESSION } from '../actions/actionTypes'\n\nconst defaultState = {}\n\nconst session = (state = defaultState, action) => {\n    let newState;\n    switch (action.type) {\n        case SET_SESSION:\n            newState = action.session\n\n            return newState\n        \n        case CLEAR_SESSION:\n            return defaultState\n\n        default:\n            return state\n    }\n}\n\nexport default session","import { ADD_PLOTS, CLEAR_SESSION, REMOVE_PLOT } from '../actions/actionTypes'\nimport _ from \"lodash\"\n\nconst defaultState = {};\n\nconst plots = (state = defaultState, action) => {\n    let newState;\n    switch (action.type) {\n        case ADD_PLOTS:\n            console.log(\"REDUX: Storing a new plot...\")\n            newState = {\n                ...state,\n                ...action.newPlots,\n            }\n            console.log(newState)\n            return newState\n        \n        case REMOVE_PLOT:\n            return _.omit(state, [action.plotID])\n        \n        case CLEAR_SESSION:\n            return defaultState\n            \n        default:\n            return state\n    }\n}\n\nexport default plots","import { \n    SET_ACTIVE_PLOT,\n    SET_ACTIVE_TAB,\n    CLEAR_SESSION,\n    SET_ACTIVE_PAGE,\n    SET_STRUCTURES,\n    SET_PLOTABLES,\n    SET_SESSION\n} from '../actions/actionTypes'\n\nimport _ from \"lodash\"\n\nconst defaultState = {plot: undefined, tab: undefined, structs: [], plotables:[], page: \"plots\"};\n\nconst active = (state = defaultState, action) => {\n    let newState;\n    switch (action.type) {\n        case SET_ACTIVE_PLOT:\n            console.log(\"REDUX: Setting active plot...\")\n            newState = {\n                ...state,\n                plot: action.plotID,\n            }\n            console.log(newState)\n            return newState\n\n        case SET_ACTIVE_TAB:\n            console.log(\"REDUX: Setting active tab...\")\n            newState = {\n                ...state,\n                tab: action.activeTab,\n            }\n            console.log(newState)\n            return newState\n        \n        case SET_SESSION:\n\n            const activeTabInSession = _.find(action.session.tabs, [\"id\", state.tab])\n            const anyTab = action.session.tabs.length > 0\n            \n            if (activeTabInSession) {\n                return state\n            } else if (anyTab){\n                return {...state, tab: action.session.tabs[0].id}\n            } else {\n                return { ...state, tab: null}\n            }\n        \n        case SET_STRUCTURES:\n\n            return { ...state, structs: []}\n        \n        case SET_ACTIVE_PAGE:\n\n            newState = {\n                ...state,\n                page: action.pageName,\n            }\n\n            return newState\n        \n        case SET_PLOTABLES:\n\n            return { ...state, plotables: [] }\n        \n        case CLEAR_SESSION:\n            return defaultState\n                \n        default:\n            return state\n    }\n}\n\nexport default active","import { \n    START_LOADING_PLOT,\n    END_LOADING_PLOT\n} from '../actions/actionTypes'\n\nimport _ from 'lodash';\n\nconst loading = (state = {plots:{}}, action) => {\n    let newState;\n    switch (action.type) {\n        case START_LOADING_PLOT:\n            console.log(\"REDUX: Setting active plot...\")\n            newState = {\n                ...state,\n                plots: {\n                    ...state.plots,\n                    [action.plot.id]: {\n                        ...action.plot,\n                        from: new Date()\n                    }\n                }\n            }\n            console.log(newState)\n            return newState\n        \n        case END_LOADING_PLOT:\n            console.log(\"REDUX: Changing plot settings (not submitting yet)...\")\n            newState = {\n                ...state,\n                plots: _.omit(state.plots, [action.plotID]),\n            }\n            console.log(newState)\n            return newState\n                \n        default:\n            return state\n    }\n}\n\nexport default loading","import storage from \"redux-persist/lib/storage\"\nimport { persistReducer } from 'redux-persist';\nexport function persist(key, whitelist, reducer) {\n    return persistReducer({\n        key,\n        storage,\n        whitelist,\n    }, reducer);\n}","import { combineReducers } from 'redux'\nimport {createResponsiveStateReducer} from 'redux-responsive'\n\nimport session from './session'\nimport plots from './plots'\nimport active from './active'\nimport loading from './loading'\nimport { persist } from './persist'\n\nexport default combineReducers({\n    session,\n    plots,\n    loading: persist('loading', ['plots'], loading),\n    active: persist( 'active', ['tab', 'plot'], active),\n    browser: createResponsiveStateReducer({\n        small: 600,\n        medium: 992,\n    })\n})\n\nexport const selectActivePlot = (state) => {\n    return state.plots[state.active.plot]\n}","import { createStore } from 'redux'\nimport {responsiveStoreEnhancer} from 'redux-responsive'\nimport { persistStore} from 'redux-persist'\n\nimport rootReducer from '../reducers'\n\nconst getStoreAndPersistor = () => {\n  let store = createStore(rootReducer, responsiveStoreEnhancer)\n  let persistor = persistStore(store)\n  //persistor.purge()\n  return { store, persistor }\n}\n\nexport default getStoreAndPersistor","import { \n    ADD_PLOTS,\n    REMOVE_PLOT,\n    ADD_TABS,\n    SET_STRUCTURES,\n    SET_TAB_PLOTS,\n    SET_SESSION_TABS,\n    SET_ACTIVE_PLOT,\n    SET_ACTIVE_TAB,\n    CLEAR_SESSION,\n    SET_SESSION,\n    START_LOADING_PLOT,\n    END_LOADING_PLOT,\n    SET_ACTIVE_PAGE,\n    SET_PLOTABLES,\n} from './actionTypes'\n\nexport const setCurrentSession = (session) => {\n\n    return {\n        type: SET_SESSION,\n        session\n    }\n}\n    \nexport const addPlots = (newPlots, tabsIDs) => ({\n    type: ADD_PLOTS,\n    newPlots,\n    tabsIDs\n})\n\nexport const removePlot = (plotID, tabID) => ({\n    type: REMOVE_PLOT,\n    plotID,\n    tabID\n})\n\nexport const changeSettings = (actionType, settingKey, value, extraParams) => ({\n    type: actionType, //Valid action types are all of type CHANGE_<something>_SETTINGS\n    settingKey,\n    value,\n    extraParams // Here the plotID is passed, for example, if the actionType is CHANGE_PLOT_SETTINGS\n})\n\nexport const addTabs = (newTabs) => ({\n    type: ADD_TABS,\n    newTabs\n})\n\nexport const setNewStructures = (newStructures) => ({\n    type: SET_STRUCTURES,\n    newStructures\n})\n\nexport const setTabPlots = (tabID, plots) => ({\n    type: SET_TAB_PLOTS,\n    tabID,\n    plots\n})\n\nexport const setSessionTabs = (tabs) => ({\n    type: SET_SESSION_TABS,\n    tabs\n})\n\nexport const setActivePlot = (plot) => ({\n    type: SET_ACTIVE_PLOT,\n    plotID: plot ? typeof(plot) == \"string\" ? plot : plot.id : undefined\n})\n\nexport const setActiveTab = (tab) => ({\n    type: SET_ACTIVE_TAB,\n    activeTab: tab\n})\n\nexport const clearSession = () => ({\n    type: CLEAR_SESSION,\n})\n\nexport const informLoadingPlot = (plot) => ({\n    type: START_LOADING_PLOT,\n    plot\n})\n\nexport const informLoadedPlot = (plotID) => ({\n    type: END_LOADING_PLOT,\n    plotID\n})\n\nexport const setActivePage = (pageName) => ({\n    type: SET_ACTIVE_PAGE,\n    pageName\n})\n\nexport const setNewPlotables = (newPlotables) => ({\n    type: SET_PLOTABLES,\n    newPlotables\n})\n\n\n\n","import { FC } from 'react'\nimport TextField from '@material-ui/core/TextField'\nimport { InputFieldProps } from '../InputField'\n\nconst Text:FC<InputFieldProps<string>> = props => {\n    const value = props.value || \"\"\n\n    return (\n        <TextField\n            variant=\"outlined\"\n            value={value}\n            onChange={(e) => props.onChange(e.target.value)}\n            label={props.label}\n            style={{width: \"100%\", ...props.style}}\n            {...(props.inputField ? props.inputField.params : {})}/>\n    )\n}\n\nexport default Text;\n","import React, { Component } from 'react'\nimport { toast } from 'react-toastify'\n\nimport TextInput from \"../settings/inputFields/TextInput\"\nimport { Button } from '@material-ui/core'\n\nexport class Prompt extends Component {\n\n    constructor(props){\n        super(props)\n\n        this.state = {\n            value: \"\"\n        }\n\n        if (props.controlClose){\n            props.controlClose(props.closeToast)\n        }\n    }\n\n    componentWillUnmount(){\n        this.props.callback(this.state.value)\n    }\n\n    render() {\n        return (\n            <div>\n                <div style={{paddingBottom: 10}}>{this.props.content}</div>\n                <TextInput value={this.state.value} onChange={(value) => {this.setState({value})}} label={this.props.inputProps.label}/>\n                <Button onClick={this.props.closeToast}>Submit</Button>\n            </div>\n        )\n    }\n\n}\n\nconst prompt = (content, callback, props) => {\n\n    toast(<Prompt content={content} callback={callback} {...props}/>, {autoClose: false, closeOnClick: false, onClose: (arg) => {console.warn(arg)} })\n\n}\n\nexport const connectionPrompt = (currentAddress, callback, props) => {\n\n    const content = <div>\n        <div>{\"Couldn't connect to \" + currentAddress}</div>\n        <div>Do you want to specify a different address for the API?</div>\n        <div> (http(s)://host:port)</div>\n    </div>\n\n    prompt(content, callback, {inputProps: {label: \"New address\" }, ...props})\n\n}\n\nexport const authPrompt = (callback, props) => {\n\n    const content = <div>\n        <div>Authorization is required</div>\n        <div>We need you to provide your username:</div>\n    </div>\n\n    prompt(content, callback, { inputProps: { label: \"Username\" }, ...props })\n\n} \n\nexport default prompt;\n","import io from 'socket.io-client';\nimport { toast } from 'react-toastify';\nimport { v4 as uuidv4 } from 'uuid';\nimport toastPrompt, {connectionPrompt} from '../components/prompts/Prompt';\n\nexport class PythonApi {\n\n    constructor() {\n\n        this.apiAddress = 'http://localhost:4000'\n        this.user = undefined\n\n        this.listeners = []\n        this.setupListeners()\n\n        this.connect()\n\n        /*This can be dangerous in the browser if the user let's other websites\n        access this tab. By default it is not possible, one would have to download\n        an extension to make it possible, but still. */ \n        document.api = this\n\n    }\n\n    connect = (address) => {\n\n        if (address) this.apiAddress = address\n\n        this.externalListeners = {}\n\n        this.socket = io(this.apiAddress);\n        this.listeners.forEach(listener => this.socket.on(...listener))\n\n        // Timeout to prompt the user for a new api address if the socket fails to connect\n        this.connectionTimeOut = setTimeout(() => {\n\n            connectionPrompt(this.apiAddress, (newAddress) => {\n                if (newAddress) {\n                    this.apiAddress = newAddress.trim()\n                }\n                if (!this.socket.connected){\n                    this.disconnect()\n                    this.connect()\n                }\n\n            }, {controlClose: (close) => this.onConnect(close)})\n            \n        }, 3000)\n\n        this.socket.connect()\n\n    }\n\n    disconnect = () => {\n        this.socket.disconnect()\n    }\n\n    on = (...args) => {\n\n        if (this.socket){\n            this.socket.on(...args)\n        }\n        // In this way all the listeners are registered each time\n        // The socket changes\n        this.listeners.push(args)\n    }\n\n    onConnect = (...args) => {\n        this.on('connect', ...args)\n    }\n\n    onDisconnect = (...args) => {\n        this.on('disconnect', ...args)\n    }\n\n    setupListeners = () => {\n\n        this.on('connect', () => {\n            //document.dispatchEvent(new Event('socket_connect'))\n            clearTimeout(this.connectionTimeOut)\n            this.requestSession()\n        });\n\n        this.on('disconnect', (reason) => {\n            console.warn(reason)\n            this.disconnect()\n            this.connect()\n        });\n\n        this.on('auth_required', this.askForAuth)\n\n        this.on('logged_in', this.requestSession)\n\n        this.on('error', (err) => this.handleError(err, \"socket\"));\n\n        this.on('server_error', (err) => this.handleError(err, \"server\"));\n        \n        this.on('current_session', (session) => {\n            console.error(session)\n            document.dispatchEvent(new CustomEvent(\"syncWithSession\", { detail: { session } }))\n        })\n\n        this.on('loading_plot', (info) => {\n            document.dispatchEvent(new CustomEvent(\"loadingPlot\", { detail: info }))\n        })\n\n        this.on('plot', (plot) => {\n            document.dispatchEvent(new CustomEvent(\"plot\", { detail: { plot } }))\n        })\n\n    }\n\n    handleError = (err, type) => {\n        if (type === \"server\"){\n            toast.error(\"THERE WAS A PYTHON ERROR:\\n\" + err)\n        } else {\n            toast.error(err)\n        }\n        \n    }\n\n    askForAuth = () => {\n\n        if (this.authenticating) return\n\n        this.authenticating = true\n        toastPrompt((username) => {\n            this.socket.emit(\"login\", username)\n            this.authenticating = false\n        })\n    }\n\n    requestSession = (path) => {\n        this.socket.emit('request_session', path)\n    }\n\n    loadSession = (path) => {\n        this.requestSession(path)\n    }\n\n    loadSessionFromFile = (file) => {\n        this.socket.emit('load_session_from_file', file, file.name)\n    }\n\n    getSessionFile = (callback) => {\n\n        this.socket.once(\"session_file\", (sessionfile) => {\n            callback(sessionfile)\n        })\n\n        this.socket.emit('get_session_file')\n    }\n\n    newProcessId = uuidv4\n\n    _sessionMethod = (methodName, kwargs, callback, ...args) => {\n        /* With this you can call any session method\n        \n        However this method should not be directly used.\n        A new method should be defined in this class to avoid \n        headaches with changes in method names in sisl.viz.Session\n        \n        You have the possibility to set up a callback, but remember that \n        by default the session will be emitted by the server and its update\n        is automatic. Therefore, only use the callback if you are using a\n        \"getter\" method and you want to act according to the results. You may\n        want also to inform the user that the process has finished. But again,\n        this behavior should also be taken care of automatically.*/\n\n        if (callback) {\n            \n        }\n\n        this.socket.emit(\"apply_method_on_session\", methodName, kwargs, ...args)\n    }\n\n    callSessionShortcut = (sequence) => {\n        this._sessionMethod(\"call_shortcut\", null, null, sequence)\n    }\n\n    updateSessionSettings = (newSettings) => {\n        this._sessionMethod(\"update_settings\", newSettings)\n    }\n\n    undoSessionSettings = () => {\n        this._sessionMethod(\"undo_settings\")\n    }\n\n    addTab = (tabName) => {\n        this._sessionMethod(\"add_tab\", {name: tabName})\n    }\n\n    removeTab = (tabID) => {\n        this._sessionMethod(\"remove_tab\", {tabID})\n    }\n\n    updateTab = (tabID, newParams) => {\n        this._sessionMethod(\"update_tab\", { tabID, newParams })\n    }\n\n    setTabLayouts = (tabID, layouts) => {\n        this.updateTab(tabID, {layouts})\n    }\n\n    saveSession = (path) => {\n        this._sessionMethod(\"save\", {path})\n    }\n\n    getPlot = (plotID) => {\n        document.dispatchEvent(new CustomEvent(\"updatingPlot\", {detail: {plot_id: plotID}}))\n        this.socket.emit(\"get_plot\", plotID)\n    }\n\n    newPlot = (newPlotKwargs) => {\n        this._sessionMethod(\"new_plot\", newPlotKwargs)\n    }\n\n    removePlot = (plotID) => {\n        this._sessionMethod(\"remove_plot\", null, null, plotID)\n    }\n\n    movePlot = (plotID, tab) => {\n        this._sessionMethod(\"move_plot\", null, null, plotID, tab)\n    }\n\n    mergePlots = (plotIDs, to) => {\n        this._sessionMethod(\"merge_plots\", {to}, null, plotIDs)\n    }\n\n    _plotMethod = (plotID, methodName, kwargs, callback, ...args) => {\n        this._sessionMethod(\"_run_plot_method\", kwargs, callback, plotID, methodName, ...args)\n    }\n\n    showPlotFullScreen = (plotID) => {\n        this._plotMethod(plotID, \"show\")\n    }\n\n    updatePlotSettings = (plotID, settings) => {\n        this._plotMethod(plotID, \"update_settings\", settings)\n    }\n\n    undoPlotSettings = (plotID) => {\n        this._plotMethod(plotID, \"undo_settings\")\n    }\n\n    updatePlotLayout = (plotID, layoutUpdates) => {\n        this._plotMethod(plotID, \"update_layout\", layoutUpdates)\n    }\n\n    updateFigure = (plotID, {layout, data, frames, overwrite}) => {\n        this._plotMethod(plotID, \"update\", {layout, data, frames, overwrite})\n    }\n\n    callPlotShortcut = (plotID, sequence) => {\n        this._plotMethod(plotID, \"call_shortcut\", null, null, sequence)\n    }\n\n    dispatchPlotEvent = (plotID, event, data) => {\n        this._plotMethod(plotID, 'dispatch_event', data, null, event)\n    }\n\n    savePlot = (plotID, path) => {\n        this._plotMethod(plotID, \"save\", { path: path })\n    }\n\n    plotFile = (file) => {\n        this.socket.emit(\"plot_file\", file, file.name)\n    }\n\n}\n\nexport default new PythonApi();","\nexport const GLOBAL_HOT_KEYS = {\n\n    //HELP\n    SHOW_AVAIL_HOTKEYS:{\n        name: \"Show available hotkeys\",\n        sequence: \"shift+?\"\n    },\n\n    //NAVIGATION\n    GO_TO_SETTINGS: {\n        name: \"Go to settings\",\n        sequence: \"shift+s\",\n    },\n    GO_TO_DASHBOARD: {\n        name: \"Go to the plot's dashboard\",\n        sequence: \"shift+d\",\n    },\n    GO_TO_MOLECULEVIEWER: {\n        name: \"Go to the molecule viewer\",\n        sequence: \"shift+m\",\n    },\n\n    //SESSION\n    SAVE_SESSION: {\n        name: \"Save session\",\n        sequences: [\"ctrl+shift+s\", \"ctrl+alt+s\"]\n    },\n    LOAD_SESSION: {\n        name: \"Load session\",\n        sequences: [\"ctrl+shift+l\", \"ctrl+alt+l\"]\n    }\n\n}\n\nexport const ADDITIONAL_GLOBAL_HOT_KEYS = {\n    settings: {\n\n    },\n    plots:{\n        \n\n    }\n}\n\nexport const SETTINGS_HOT_KEYS = {\n\n}\n\nexport const TABS_HOT_KEYS = {\n    global: {\n        // TAB NAVIGATION\n        MOVE_TO_NEXT_TAB: {\n            name: \"Move to next tab\",\n            sequence: \"shift+t+right\",\n        },\n        MOVE_TO_PREVIOUS_TAB: {\n            name: \"Move to previous tab\",\n            sequence: \"shift+t+left\",\n        },\n        NEW_TAB: {\n            name: \"New tab\",\n            sequence: \"shift+t\",\n            action: \"keyup\"\n        },\n        TRY: \"shift+t+r\"\n    }\n}\n\nexport const PLOTS_HOT_KEYS = {\n    global: {\n        // TAB NAVIGATION\n        MOVE_TO_NEXT_TAB: {\n            name: \"Move to next tab\",\n            sequence: \"shift+right\",\n        },\n        MOVE_TO_PREVIOUS_TAB: {\n            name: \"Move to previous tab\",\n            sequence: \"shift+left\",\n        },\n    }\n}\n\nexport const PLOT_CARD_HOT_KEYS = {\n\n    GO_TO_PLOT_SETTINGSEDITING: {\n        name: \"Edit current plot's settings\",\n        sequence: \"s\"\n    },\n    GO_TO_PLOT_LAYOUTEDITING: {\n        name: \"Edit current plot's layout\",\n        sequence: \"e\"\n    },\n    GO_TO_PLOT_METHODS: {\n        name: \"Go to current plot methods\",\n        sequence: \"m\"\n    },\n    FULL_SCREEN: {\n        name: \"See current plot in full screen in a different browser's tab\",\n        sequence: \"f\"\n    },\n    REMOVE_PLOT: {\n        name: \"Remove current plot\",\n        sequences: [\"del\",\"backspace\"]\n    },\n    UNDO_PLOT_SETTINGS: {\n        name: \"Undo current plot settings\",\n        sequence: \"ctrl+z\"\n    },\n\n}\n\nexport const STRUCTURE_PICKER_HOT_KEYS = {\n\n}\n\nexport const SETTING_CONTAINER_HOT_KEYS = {\n\n    MOVE_EXPANDED_UP:{\n        name: \"Expand the previous settings group\",\n        sequence: \"up\"\n    },\n    MOVE_EXPANDED_DOWN:{\n        name: \"Expand the next settings group\",\n        sequence: \"down\"\n    }\n\n}\n\nexport const SETTING_GROUP_HOT_KEYS = {\n\n    SUBMIT_SETTINGS:{\n        name: \"Submit this group's settings\",\n        sequence: \"shift+enter\"\n    },\n    \n}\n\nexport const PLOT_TWEAKING_HOT_KEYS = {\n    global:{\n        UNDO_SETTINGS: {\n            name:\"Undo settings\",\n            sequence: \"ctrl+z\"\n        },\n\n        SUBMIT_ALL_SETTINGS: {\n            name: \"Submit all settings\",\n            sequence: \"shift+enter\"\n        }\n    }\n}","import React, { Component } from 'react'\nimport Plot from 'react-plotly.js';\nimport Card from \"@material-ui/core/Card\"\nimport { AiOutlineEdit, AiOutlineDelete, AiOutlineExport, AiOutlineFullscreen } from 'react-icons/ai'\nimport { FaHammer, FaSave } from 'react-icons/fa'\nimport { MdSettings } from 'react-icons/md'\nimport { IconContext } from 'react-icons'\n\nimport ReactTooltip from \"react-tooltip\"\n\nimport _ from \"lodash\"\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { setActivePlot, removePlot, setSessionTabs, setActivePage, addPlots} from \"../../redux/actions\"\nimport PythonApi from '../../apis/PythonApi';\nimport { HotKeys } from 'react-hotkeys';\nimport { PLOT_CARD_HOT_KEYS } from '../../utils/hotkeys';\nimport { toast } from 'react-toastify';\nimport { IconButton } from '@material-ui/core';\n\nclass PlotCard extends Component {\n\n    constructor(props){\n        super(props)\n        this.state = {\n            isLoading: false,\n            editable: false,\n        }\n\n    }\n\n    hotKeys = () => document.querySelectorAll(\".plotCardHotKeys\")\n\n    hotKeysHandlers = {\n        GO_TO_PLOT_LAYOUTEDITING: () => this.goToPlotLayoutEditing(),\n        GO_TO_PLOT_SETTINGSEDITING: () => this.goToPlotSettingsEditing(),\n        GO_TO_PLOT_METHODS: () => this.goToPlotMethods(),\n        FULL_SCREEN: () => this.showPlotFullScreen(),\n        UNDO_PLOT_SETTINGS: () => this.undoSettings(),\n        REMOVE_PLOT: () => this.removePlot(),\n    }\n\n    callPlotShortcut = (sequence) => {\n        toast.warn(\"Applying \" + this.props.plot.shortcuts[sequence].name + \" shortcut\")\n        PythonApi.callPlotShortcut(this.props.plot.id, sequence)\n    }\n\n    handlePlotClick = ({points}) => {\n        const data = _.omit(points[0], [\"data\", \"fullData\", \"xaxis\", \"yaxis\"])\n        console.warn(data)\n        PythonApi.dispatchPlotEvent(this.props.plot.id, \"click\", data)\n    }\n\n    handlePlotRelayout = (layoutUpdates) => {\n        if (layoutUpdates[\"scene.camera\"]) return\n\n        const keys = Object.keys(layoutUpdates)\n        if (keys.includes(\"autosize\")) return \n        else if (keys.length === 0) return\n        else {\n            PythonApi.updatePlotLayout(this.props.plot.id, layoutUpdates)\n        }\n    }\n\n    undoSettings = () => {\n\n        PythonApi.undoPlotSettings(this.props.plot.id)\n    }\n\n    componentDidMount(){\n        document.addEventListener(\"plotResize\", (e) => {\n            \n            if (e.detail.id === this.props.plot.id || e.detail.id === \"all\"){\n                this.setState({cou: Math.random()})          \n            }\n            \n        })\n    }\n\n    removePlot = () => {\n        PythonApi.removePlot(this.props.plot.id)   \n    }\n\n    goToPlotSettingsEditing = () => {\n        this.setPlotAsActive()\n        this.props.setActivePage(\"plotTweaking\")\n    }\n\n    goToPlotLayoutEditing = () => {\n        this.setPlotAsActive()\n        this.props.setActivePage(\"plotLayoutEditor\")\n    }\n\n    goToPlotMethods = () => {\n        this.setPlotAsActive()\n        this.props.setActivePage(\"plotMethods\")\n    }\n\n    setPlotAsActive = () => {\n        this.props.setActivePlot(this.props.plot)\n    }\n\n    togglePlotAsActive = () => {\n        if (this.isActivePlot){\n            this.props.setActivePlot(undefined)\n        } else {\n            this.setPlotAsActive()\n        }\n    }\n\n    savePlot = () => {\n        let path = prompt(\"Please provide the path to save the plot.\\n\\nRoot directory:\\n\" + this.props.session.settings.rootDir)\n        if (!path) return\n\n        PythonApi.savePlot(this.props.plot.id, path)\n    }\n\n    get isActivePlot(){\n        return this.props.plot.id === this.props.active.plot\n    }\n\n    showPlotFullScreen = () => {\n        PythonApi.showPlotFullScreen(this.props.plot.id)\n    }\n\n    render() {\n\n        if (this.state.isLoading || !this.props.plot) {\n            return (\n                <Card \n                    className=\"plotcard\"\n                    style={{borderRadius: 15}}>\n                    <div>We are working hard to load your plot.</div>\n                </Card>\n            )\n        }\n\n        if (! this.props.plot.figure){\n            return (\n                <Card\n                    className=\"plotcard\"\n                    style={{ borderRadius: 15 }}>\n                    <div>A figure could not be generated for this plot.</div>\n                </Card>\n            )\n        }\n\n        let layout = this.props.plot.figure.layout;\n        let backColor = layout.paper_bgcolor || \"white\"\n\n        const hotKeysKeyMap = {\n            ...PLOT_CARD_HOT_KEYS,\n            TESTING: \"shift+r\",\n            ...Object.keys(this.props.plot.shortcuts).reduce((plotShortcuts, sequence) => {\n                let shortcut = this.props.plot.shortcuts[sequence]\n                if ([\"ctrl+z\", \"ctrl+alt+l\"].includes(sequence)) return plotShortcuts\n                    plotShortcuts[shortcut.name.replace(/ /g, \"_\")] = {\n                    sequence: sequence,\n                    ...shortcut\n                }\n                return plotShortcuts\n            }, {})\n        }\n\n        const hotKeysHandlers = {\n            ...this.hotKeysHandlers,\n            ...Object.keys(this.props.plot.shortcuts).reduce((plotShortcuts, sequence) => {\n                let shortcut = this.props.plot.shortcuts[sequence]\n                if ([\"ctrl+z\", \"ctrl+alt+l\"].includes(sequence)) return plotShortcuts\n                plotShortcuts[shortcut.name.replace(/ /g, \"_\")] = () => this.callPlotShortcut(sequence)\n                return plotShortcuts\n            }, {})\n        }\n\n        const activeStyles = this.isActivePlot && false ? {\n            borderStyle: \"dashed\",\n            borderWidth: \"2px\",\n            borderColor: \"black\"\n        } : {}\n\n        return <HotKeys\n                 className=\"plotCardHotKeys\"\n                 //onClick={(e) => {if (e.ctrlKey && false){this.togglePlotAsActive()}}}\n                 component={Card}\n                 elevation={this.props.elevation || 1}\n                 keyMap={hotKeysKeyMap} handlers={hotKeysHandlers} allowChanges={true}\n                 style={ {width: \"100%\", height: \"100%\", display: \"flex\", flexDirection: \"column\", borderRadius: 3, overflow:\"hidden\", background: backColor, paddingTop: 5, ...activeStyles, ...this.props.style}}>\n                <div style={{flex:1}}>\n                    <Plot\n                        ref={plotlyRef => {\n                            this.plotlyRef = plotlyRef;\n                        }}\n                        useResizeHandler\n                        style={{ width: \"100%\", height: \"100%\"}}\n                        data={this.props.plot.figure.data}\n                        layout={{autosize: true, title: \"\", ...layout}}\n                        frames={this.props.plot.figure.frames}\n                        onClick={this.handlePlotClick}\n                        onRelayout={this.handlePlotRelayout}\n                        onUpdate={(figure) => {}}//PythonApi.updateFigure(this.props.plot.id, figure)}\n                    config={{editable: this.state.editable, responsive: true}}\n                    />\n                </div>\n                \n            <div style={{ display: \"flex\", paddingLeft: 10, paddingRight: 20, background: backColor, marginBottom: 5}} className=\"card-action\">\n                <IconContext.Provider value={{ size: 25, style: { margin: 5 }, color: \"#6eb6ff\"}}>\n                    <div style={{flex:1, textAlign: \"left\"}}>\n                        <IconButton size=\"small\" data-tip=\"Full screen (f)\" onClick={this.showPlotFullScreen}><AiOutlineFullscreen/></IconButton> \n                    </div>\n\n                    <div>\n                        <IconButton\n                            size=\"small\"\n                            data-tip=\"Settings (s)\"\n                            onClick={this.goToPlotSettingsEditing}><MdSettings /></IconButton>\n                        <IconButton\n                            size=\"small\"\n                            data-tip=\"Methods (m)\"\n                            onClick={this.goToPlotMethods}><FaHammer/></IconButton>\n                        <IconButton\n                            size=\"small\"\n                            data-tip=\"Editable\"\n                            onClick={() => this.setState({editable: !this.state.editable})}><MdSettings /></IconButton>\n                        <IconButton\n                            size=\"small\"\n                            data-tip=\"Edit layout (e)\"\n                            onClick={this.goToPlotLayoutEditing}><AiOutlineEdit/></IconButton>\n                        <IconButton size=\"small\" data-tip=\"Save plot (coming soon)\"><FaSave color=\"#ccc\"/></IconButton>\n                        <IconButton size=\"small\" data-tip=\"Export data (coming soon)\"><AiOutlineExport color=\"#ccc\"/></IconButton>\n                        <IconButton size=\"small\" data-tip=\"Remove (supr)\" onClick={this.removePlot}><AiOutlineDelete color=\"red\"/></IconButton>\n                    </div> \n                </IconContext.Provider>\n                <ReactTooltip effect=\"solid\" place=\"bottom\" disable={this.props.session.settings ? !this.props.session.settings.showTooltips : false} /> \n            </div>\n        </HotKeys>\n    }\n}\n\nconst mapStateToProps = state => ({\n    plots: state.plots,\n    active: state.active,\n    session: state.session\n})\n\nconst mapDispatchToProps = {\n    setSessionTabs,\n    setActivePlot,\n    removePlot,\n    setActivePage,\n    addPlots\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PlotCard);\n","import { FC, useCallback } from 'react'\nimport { useDropzone } from 'react-dropzone'\n\n// Files input is not yet an input field supported for parameters\n\ninterface FilesInputProps {\n    placeholder: string,\n    onChange: (files: File[]) => void,\n    style?: {[key:string]: any},\n}\n\nconst FilesInput:FC<FilesInputProps> = ({placeholder, onChange, style }) => {\n    const onDrop = useCallback((files: File[]) => onChange(files), [onChange])\n    const { getRootProps, getInputProps } = useDropzone({ onDrop })\n\n    return (\n        <div {...getRootProps()} style={style}>\n            <input {...getInputProps()} />\n            <p>{placeholder}</p>\n        </div>\n    )\n}\n\nexport default FilesInput;\n","import React, { Component } from 'react'\nimport { connect } from 'react-redux'\n\nimport SpeedDial from '@material-ui/lab/SpeedDial';\nimport SpeedDialIcon from '@material-ui/lab/SpeedDialIcon';\nimport SpeedDialAction from '@material-ui/lab/SpeedDialAction';\nimport { makeStyles } from '@material-ui/core/styles';\nimport { Button } from '@material-ui/core';\n\nimport { FaSave} from 'react-icons/fa'\nimport { AiOutlineUpload } from 'react-icons/ai'\nimport { setActivePage } from '../../redux/actions'\n\nimport PythonApi from '../../apis/PythonApi'\n\nconst useStyles = makeStyles((theme) => ({\n    root: {\n        transform: 'translateZ(0px)',\n        flexGrow: 1,\n    },\n    exampleWrapper: {\n        position: 'relative',\n        marginTop: theme.spacing(3),\n    },\n    radioGroup: {\n        margin: theme.spacing(1, 0),\n    },\n    speedDial: {\n        position: 'absolute',\n        '&.MuiSpeedDial-directionUp, &.MuiSpeedDial-directionLeft': {\n            bottom: theme.spacing(2),\n            right: theme.spacing(2),\n        },\n        '&.MuiSpeedDial-directionDown, &.MuiSpeedDial-directionRight': {\n            top: theme.spacing(2),\n            left: theme.spacing(2),\n        },\n    },\n}));\n\nfunction SpeedDials(props) {\n    const classes = useStyles();\n    const direction = React.useState('left')[0];\n    const [open, setOpen] = React.useState(false);\n    const hidden = React.useState(false)[0];\n\n    const handleClose = () => {\n        setOpen(false);\n    };\n\n    const handleOpen = () => {\n        setOpen(true);\n    };\n\n    return (\n        <SpeedDial\n            ariaLabel=\"SpeedDial example\"\n            className={classes.speedDial}\n            hidden={hidden}\n            icon={<SpeedDialIcon />}\n            onClose={handleClose}\n            onOpen={handleOpen}\n            open={open}\n            direction={direction}\n        >\n            {props.actions.map((action) => (\n                <SpeedDialAction\n                    key={action.name}\n                    icon={action.icon}\n                    tooltipTitle={action.tip || action.name}\n                    tooltipPlacement={\"top\"}\n                    onClick={action.onClick}\n                    href={action.href}\n                />\n            ))}\n        </SpeedDial>\n    );\n}\n\nclass Controls extends Component {\n\n    hotKeysHandler = {\n        SAVE_SESSION: () => this.saveCurrentSession(),\n        LOAD_SESSION: () => this.loadSession()\n    }\n\n    syncWithSession = (session) => {\n        document.dispatchEvent(new CustomEvent(\"syncWithSession\", {detail: {session}}))\n    }\n\n    showPage = (pageName) => {\n        this.props.setActivePage(pageName)\n    }\n\n    saveCurrentSession = () => {\n        let path = prompt(\"Please provide the path to save the session.\\n\\nRoot directory:\\n\" + this.props.session.settings.rootDir)\n        if (!path) return \n\n        PythonApi.saveSession(path)\n    }\n\n    loadSession = () => {\n\n        let path = prompt(\"Please provide the path of the saved session.\\n\\nRoot directory:\\n\" + this.props.session.settings.rootDir)\n        if (!path) return\n\n        PythonApi.loadSession(path)\n    }\n\n    render() {\n\n        const actions = [{\n            name: \"Save session\",\n            icon: <FaSave size={20} />,\n            onClick: this.saveCurrentSession\n        }, {\n            name: \"Load session\",\n                icon: <AiOutlineUpload size={20} />,\n            onClick: this.loadSession\n        }]\n\n        return <SpeedDials actions={actions} />\n    }\n}\n\nexport class Control extends Component {\n\n    render(){\n        \n        return <Button\n                    data-tip={this.props.tooltip}\n                    style={this.props.style}\n                    floating\n                    icon={this.props.icon}\n                    onClick={this.props.onClick}\n                    className={this.props.className} />\n    }\n}\n\nconst mapStateToProps = state => ({\n    session: state.session,\n    active: state.active\n})\n\nconst mapDispatchToProps = {\n    setActivePage\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Controls);\n","import React, { Component } from 'react'\nimport { Control } from './Controls'\nimport { connect } from 'react-redux'\nimport { setActivePage } from '../../redux/actions'\nimport { IoMdSettings } from 'react-icons/io'\nimport { MdDashboard } from 'react-icons/md'\n\nexport const ROUTES = {\n    settings: {\n        name: \"Settings\",\n        icon: <IoMdSettings size={20}/>,\n        color: \"grey\",\n        hotKey: \"Shift + s\",\n    },\n    plots: {\n        name: \"Dashboard\",\n        icon: <MdDashboard/>,\n        color: \"grey\",\n        hotKey: \"Shift + d\"\n    }\n}\n\nclass NavigateButton extends Component {\n\n    showPage = () => {\n        this.props.setActivePage(this.props.to)\n    }\n\n    render() {\n\n        const route = ROUTES[this.props.to]\n\n        return <Control \n            icon={route.icon} \n            className={route.color}\n            tooltip={\"Go to \" + this.props.to + \" (\" + route.hotKey + \")\"}\n            onClick={this.showPage}\n            {...this.props}/>\n    }\n}\n\nconst mapDispatchToProps = {\n    setActivePage\n}\n\nexport default connect(null, mapDispatchToProps)(NavigateButton);\n","import { FC } from \"react\";\nimport { StructOrPlotableInterface} from \"../../interfaces\";\n\ninterface TagProps {\n    id: string,\n    selected: boolean,\n    toggle: () => void,\n}\n\ninterface PlotableTagProps extends TagProps {\n    plotable: StructOrPlotableInterface\n}\n\nexport const PlotableTag:FC<PlotableTagProps> = (props) => {\n    return (\n        <div\n            className={\"plotableTag \" + (props.selected ? \"active\" : \"\")}\n            onClick={props.toggle}\n            data-tip={props.plotable.path}\n            data-effect=\"solid\">\n            <div>{props.plotable.name}</div>\n            <div style={{ fontSize: \"0.7em\", color: \"gray\" }}>{\".../\" + props.plotable.path.split(\"/\").slice(-2, -1)[0]}</div>\n        </div>\n    )\n}\n\ninterface StructureTagProps extends TagProps {\n    structure: StructOrPlotableInterface\n}\n\nexport const StructureTag:FC<StructureTagProps> = (props) => {\n\n    return (\n        <div\n            className={\"structTag \" + (props.selected ? \"active\" : \"\")}\n            onClick={props.toggle}\n            data-tip={props.structure.path}\n            data-effect=\"solid\">\n            <div>{props.structure.name.replace(\".fdf\", \"\")}</div>\n            <div style={{ fontSize: \"0.7em\", color: \"gray\" }}>{\".../\" + props.structure.path.split(\"/\").slice(-2, -1)[0]}</div>\n        </div>\n    )\n}\n\nexport default PlotableTag;\n\n","import { FC, createContext, useMemo, useState, useRef} from 'react'\nimport _ from \"lodash\"\nimport { PlotableInterface, StructureInterface } from '../../interfaces'\n\nexport interface PickerParams {\n    searchString: string,\n    alphabeticSorting: false | \"asc\" | \"desc\",\n    selectedSorting: boolean,\n    searchByFolder: boolean,\n    displayStructures: boolean,\n    displayPlotables: boolean,\n}\n\nexport const defaultPickerParams: PickerParams = {\n    searchString: \"\",\n    alphabeticSorting: false,\n    selectedSorting: false,\n    searchByFolder: false,\n    displayStructures: true,\n    displayPlotables: true,\n}\n\nexport const PickerParamsContext = createContext({\n    pickerParams: defaultPickerParams,\n    setPickerParams: (params: Partial<PickerParams>) => { },\n    toggleParam: (name: keyof PickerParams) => { },\n})\n\nexport interface PickerSelectedInterface {\n    structures: string[],\n    plotables: string[],\n}\n\nexport const defaultPickerSelected: PickerSelectedInterface = {\n    structures: [],\n    plotables: [],\n}\n\ntype SelectedKeys = keyof PickerSelectedInterface\n\ntype ObjectInterface<T> = \n    T extends \"structures\" ? StructureInterface :\n    T extends \"plotables\" ? PlotableInterface : never\n\nfunction defaultFilterSelected<T extends SelectedKeys>(what: T, objects: { [id: string]: ObjectInterface<T> }): ObjectInterface<T>[] {\n    const selectedIds = defaultPickerSelected[what]\n\n    return selectedIds.map(id => objects[id]).filter(obj => obj !== undefined)\n}\n\nexport const PickerSelectedContext = createContext({\n    pickerSelected: defaultPickerSelected,\n    nChanges: 0,\n    setPickerSelected: (pickerSelected: Partial<PickerSelectedInterface>) => { },\n    toggleSelectedObject: (what: keyof PickerSelectedInterface, objectId: string) => { },\n    filterSelected: defaultFilterSelected,\n    unselect: (what: \"structures\" | \"plotables\", ids: string | string[]) => { },\n})\n\nconst StructurePickerProvider: FC = (props) => {\n    const [pickerParams, setPickerParams] = useState(defaultPickerParams)\n    const nChangesSelected = useRef(0)\n    const [pickerSelected, setPickerSelected] = useState(defaultPickerSelected)\n    \n    // Ensure that the consumers are not rerendered each time by memoizing the context value\n    // and then provide functions to alter the state\n\n    // For the picker parameters\n    const pickerValue = useMemo(() => {\n\n        // Function to toggle any parameter\n        const toggleParam = (name: keyof PickerParams) => {\n            let newVal;\n            if (name === \"alphabeticSorting\") {\n                const currVal = pickerParams.alphabeticSorting\n                if (currVal === false) newVal = \"asc\"\n                else if (currVal === \"asc\") newVal = \"desc\"\n                else if (currVal === \"desc\") newVal = false\n            } else {\n                newVal = !pickerParams[name]\n            }\n            setPickerParams({ ...pickerParams, [name]: newVal })\n        }\n\n        return {\n            pickerParams,\n            setPickerParams: (params: Partial<PickerParams>) => setPickerParams({ ...pickerParams, ...params }),\n            toggleParam\n        }\n\n    }, [pickerParams, setPickerParams])\n\n    // And for the selected values\n    const selectedValue = useMemo(() => {\n        nChangesSelected.current = nChangesSelected.current + 1\n\n        const toggleSelectedObject = (what: \"structures\" | \"plotables\", id: string) => {\n            const toSelect = _.xor(pickerSelected[what], [id])\n            setPickerSelected({ ...pickerSelected, [what]: toSelect})\n        }\n\n        function filterSelected<T extends SelectedKeys>(what: T, objects: { [id: string]: ObjectInterface<T> }): ObjectInterface<T>[]{\n            const selectedIds = pickerSelected[what]\n\n            return selectedIds.map(id => objects[id]).filter(obj => obj !== undefined)\n        }\n\n        const unselect = (what: \"structures\" | \"plotables\", ids: string | string[]) => {\n            if (typeof ids === \"string\") ids = [ids]\n            console.log(\"UNSELECTING\", ids, \"from\", pickerSelected)\n            console.log({ ...pickerSelected, [what]: pickerSelected[what].map(id => !ids.includes(id)) })\n\n            setPickerSelected({...pickerSelected, [what]: pickerSelected[what].filter(id => !ids.includes(id))})\n        }\n\n        return {\n            pickerSelected,\n            nChanges: nChangesSelected.current,\n            setPickerSelected: (toSelect: Partial<PickerSelectedInterface>) => setPickerSelected({ ...pickerSelected, ...toSelect }),\n            toggleSelectedObject,\n            filterSelected,\n            unselect\n        }\n\n    }, [pickerSelected, setPickerSelected])\n\n    return <PickerParamsContext.Provider value={pickerValue}>\n        <PickerSelectedContext.Provider value={selectedValue}>\n            {props.children}\n        </PickerSelectedContext.Provider>\n    </PickerParamsContext.Provider>\n}\n\nexport default StructurePickerProvider;","import { FC, useContext, CSSProperties } from 'react'\nimport _ from \"lodash\"\nimport { MdFolder, MdFolderOpen} from 'react-icons/md'\n\nimport NavigateButton from '../controls/NavigateButton'\nimport {PlotableTag, StructureTag} from './Tag'\nimport TextInput from '../settings/inputFields/TextInput'\nimport { PlotableInterface, StructureInterface, StructOrPlotableInterface } from '../../interfaces'\nimport { PickerParams, PickerParamsContext, PickerSelectedContext } from './pickerContext'\n\n\nfunction wildTest(wildcard: string, str: string) {\n    const re = new RegExp(`^${wildcard.replace(/\\*/g,'.*').replace(/\\?/g,'.')}$`,'i');\n    return re.test(str); // remove last 'i' above to have case sensitive\n}\n\ninterface FilteredObject extends StructOrPlotableInterface{\n    isPlotable: boolean,\n}\n\nconst filterStructs = (\n    structures: { [key: string]: StructureInterface }, plotables: {[key: string]: PlotableInterface }, \n    pickerParams: PickerParams,\n) => {\n\n    let searchString = pickerParams.searchString\n\n    searchString = searchString.includes(\"*\") || searchString.includes(\"?\") ? searchString : \"*\" + searchString + \"*\"\n\n    let toggles = [pickerParams.displayStructures, pickerParams.displayPlotables]\n    let objs: { [key: string]: StructureInterface | PlotableInterface }[] = [structures, plotables]\n\n    //Filter both structures and plotables\n    return objs.reduce<{ [key: string]: FilteredObject }>((structs, object, index: number) => {\n\n        if (!toggles[index]) return structs\n\n        const isPlotable = index === 1\n\n        Object.keys(object).forEach((structID) => {\n\n            const struct = object[structID]\n\n            const toTest = pickerParams.searchByFolder ? struct.path.split(\"/\").slice(-2, -1)[0] : struct.name//.replace(\".fdf\", \"\")\n\n            if (wildTest(searchString, toTest)) {\n\n                structs[structID] = {\n                    ...struct,\n                    isPlotable,\n                }\n            }\n        })\n\n        return structs\n\n    }, {})\n\n}\n\nconst NoStructuresMessage:FC = (props) => {\n    return <div>\n        <div style={{ color: \"darkred\" }}>No structures in the search scope right now.</div>\n        <div>Try to change file system settings or initialize the GUI from a different directory</div>\n        <NavigateButton to=\"settings\" style={{ marginTop: 10 }} />\n    </div>\n}\n\nconst NoMatchingStructuresMessage:FC = (props) => {\n    return <div>\n        <div style={{ color: \"darkred\" }}>No structure that matches your search.</div>\n        <div>Try to change file system settings or initialize the GUI from a different directory</div>\n        <NavigateButton to=\"settings\" style={{ marginTop: 10 }} />\n    </div>\n}\n\ninterface StructurePickerProps {\n    structures: { [key: string]: StructureInterface },\n    plotables: {[key: string]: PlotableInterface },\n    style?: CSSProperties\n}\n\nconst StructurePicker:FC<StructurePickerProps> = (props) => {\n    const {pickerParams, setPickerParams, toggleParam} = useContext(PickerParamsContext)\n    const {pickerSelected, setPickerSelected, toggleSelectedObject} = useContext(PickerSelectedContext)\n    \n    const filteredObjs = filterStructs(props.structures || {}, props.plotables || {}, pickerParams)\n\n    let structsAndPlotables = Object.values(filteredObjs)\n    if (pickerParams.alphabeticSorting) {\n        structsAndPlotables = _.orderBy(structsAndPlotables, \"name\", pickerParams.alphabeticSorting)\n    }\n    if (pickerParams.selectedSorting) {\n        const isObjSelected = (struct: StructureInterface) => [...pickerSelected.structures, ...pickerSelected.plotables].includes(struct.id)\n        structsAndPlotables = _.orderBy(structsAndPlotables, isObjSelected, \"desc\")\n    }\n\n    const isSelected = (id: string) => [...pickerSelected.structures, ...pickerSelected.plotables].includes(id)\n\n    const toggleAllSelected = () => {\n        const onDisplay = Object.keys(filteredObjs)\n\n        const onDisplaySelected = _.intersection([...pickerSelected.structures, ...pickerSelected.plotables], onDisplay).length === 0\n\n        const displayedStructs = _.intersection(Object.keys(props.structures), onDisplay)\n        const displayedPlotables = _.intersection(Object.keys(props.plotables), onDisplay)\n\n        const newSelectedStructs = onDisplaySelected ?\n            [...displayedStructs, ...pickerSelected.structures]\n            :\n            pickerSelected.structures.filter(structID => !displayedStructs.includes(structID))\n        \n        const newSelectedPlotables = onDisplaySelected ?\n            [...displayedPlotables, ...pickerSelected.plotables]\n            :\n            pickerSelected.plotables.filter(plotableID => !displayedPlotables.includes(plotableID))\n\n        setPickerSelected({ structures: newSelectedStructs, plotables: newSelectedPlotables })\n\n    }\n\n    return (\n        <div style={{ height: \"100%\", display: \"flex\", flexDirection: \"column\", backgroundColor: \"white\", ...props.style }}>\n            <div style={{ display: \"flex\", flexDirection: \"row\", justifyContent: \"center\", alignItems: \"center\", marginTop: 20, marginBottom: 20 }}>\n                <TextInput\n                    label=\"Search string\"\n                    style={{ marginRight: 10 }}\n                    value={pickerParams.searchString}\n                    onChange={(searchString) => setPickerParams({searchString})} />\n                <div\n                    data-tip=\"Search by folder\"\n                    className={\"structPickerToggle \" + (pickerParams.searchByFolder ? \"active\" : \"\")}\n                    onClick={() => toggleParam(\"searchByFolder\")} style={{ cursor: \"pointer\" }}>{pickerParams.searchByFolder ? <MdFolder /> : <MdFolderOpen />}</div>\n            </div>\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", marginBottom: 5 }}>\n                <span\n                    data-tip=\"Show structures\"\n                    className={\"structPickerToggle \" + (pickerParams.displayStructures ? \"active\" : \"\")}\n                    onClick={() => toggleParam(\"displayStructures\")} style={{ cursor: \"pointer\" }}>Struct</span>\n                <span\n                    data-tip=\"Show plotables\"\n                    className={\"structPickerToggle \" + (pickerParams.displayPlotables ? \"active\" : \"\")}\n                    onClick={() => toggleParam(\"displayPlotables\")} style={{ cursor: \"pointer\" }}>Plotables</span>\n            </div>\n            <div style={{ display: \"flex\", justifyContent: \"space-between\", marginBottom: 5 }}>\n                <span\n                    className={\"structPickerToggle \" + (pickerParams.alphabeticSorting ? \"active\" : \"\")}\n                    onClick={() => toggleParam(\"alphabeticSorting\")} style={{ cursor: \"pointer\" }}>A-Z</span>\n                <span\n                    data-tip=\"Show selected first\"\n                    className={\"structPickerToggle \" + (pickerParams.selectedSorting ? \"active\" : \"\")}\n                    onClick={() => toggleParam(\"selectedSorting\")} style={{ cursor: \"pointer\" }}>sel</span>\n                <span\n                    className=\"structPickerToggle\"\n                    onClick={toggleAllSelected} style={{ cursor: \"pointer\" }}>All</span>\n            </div>\n\n            {Object.keys({ ...props.structures, ...props.plotables }).length === 0 ?\n                <NoStructuresMessage/> : Object.values(structsAndPlotables).length === 0 ?\n                    <NoMatchingStructuresMessage/> : null\n            }\n\n            <div style={{ flex: 1 }} className=\"scrollView\" >\n                {Object.values(structsAndPlotables).map(obj => {\n                    if (obj.isPlotable) {\n                        return <PlotableTag id={obj.id}\n                            plotable={obj}\n                            selected={isSelected(obj.id)}\n                            toggle={() => toggleSelectedObject(\"plotables\", obj.id)}\n                        />\n                    } else {\n                        return <StructureTag id={obj.id}\n                            structure={obj}\n                            selected={isSelected(obj.id)}\n                            toggle={() => toggleSelectedObject(\"structures\", obj.id)}\n                        />\n                    }\n\n                })}\n            </div>\n        </div>\n\n    )\n\n}\n\nexport default StructurePicker;\n","import React from \"react\";\n\nimport _ from \"lodash\"\n\n//--Components\nimport PlotCard from \"./PlotCard\";\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { setTabPlots, setSessionTabs, setActivePlot} from \"../../redux/actions\"\nimport PythonApi from \"../../apis/PythonApi\";\n\nimport { Responsive, WidthProvider } from 'react-grid-layout';\nimport { Paper, Button } from '@material-ui/core';\n\nimport 'react-grid-layout/css/styles.css'\nimport'react-resizable/css/styles.css'\n\nimport { withHotKeys } from \"react-hotkeys\"; //GlobalHotKeys\n//import { PLOTS_HOT_KEYS } from \"../../utils/hotkeys\";\nimport FilesInput from \"../settings/inputFields/Files\";\nimport StructurePicker from \"../structures/StructurePicker\";\n\nconst ResponsiveReactGridLayout = WidthProvider(Responsive);\n\nconst selectedPlotStyles = { backgroundColor: \"#757eff\",  paddingTop: 5, marginTop: -5}\n\nclass PlotDashboard extends React.Component {\n\n  constructor(props){\n    super(props)\n\n    this._plotsInLayout = false\n\n    this.state = {\n      selected: []\n    }\n\n  }\n\n  static defaultProps = {\n    className: \"layout\",\n    rowHeight: 30,\n    onLayoutChange: function() {},\n    cols: { lg: 12, md: 12, sm: 6, xs: 4, xxs: 2 },\n  };\n\n  state = {\n    currentBreakpoint: \"lg\",\n    compactType: \"vertical\",\n    mounted: false,\n    layouts: { lg: [] }\n  };\n\n  componentDidMount() {\n    this.setState({ mounted: true });\n    this.props.setActivePlot(undefined)\n  }\n\n  emptyDashboard = () => {\n    return null\n  }\n\n  noTabsMessage = () => {\n    return null\n  }\n\n  noPlotsMessage = () => {\n    //className=\"attentionLeft\"\n    return <div style={{display: \"flex\", flexDirection: \"column\", justifyContent: \"center\", alignItems: \"center\", height: \"100%\"}}>\n      <div style={{fontSize: \"5em\", fontWeight: \"bold\"}}>This is the plots dashboard.</div>\n      <div style={{fontSize: \"1.2em\"}}>We would like to display your plots here, but currently you don't seem to have any</div>\n      <div style={{backgroundColor: \"white\",  fontSize: \"2em\", margin: 20, padding: 20, paddingLeft: 50, paddingRight: 50, borderRadius: 70}}> You can try to create one by clicking on your structures</div>\n    </div>\n  }\n\n  static newPlotLayout = (plot, layouts) => {\n    return {\n      x: plot.grid_dims[0]*(layouts.lg.length),\n      y: 2,\n      w: plot.grid_dims[0],\n      h: plot.grid_dims[1],\n      i: plot.id,\n    };\n  }\n\n  generateDOM(layouts, plots, selected, toggleSelect) {\n    return _.map(layouts, function(l, i) {\n      return <div key={plots[i].id} onClick={(e) => e.ctrlKey ? toggleSelect(plots[i].id) : null}> \n        <PlotCard \n          plot={plots[i]} \n          style={selected.includes(plots[i].id) ? selectedPlotStyles : {}}/>\n      </div>\n    });\n  }\n\n  toggleSelected = (plotID) => {\n\n    let selected;\n\n    if (this.state.selected.includes(plotID)){\n      selected = this.state.selected.filter(id => id !== plotID)\n    } else {\n      selected = [...this.state.selected, plotID]\n    }\n\n    this.setState({selected})\n  }\n\n  onBreakpointChange = (breakpoint) => {\n    document.dispatchEvent(new CustomEvent(\"plotResize\", {detail: {id: \"all\"}}))\n  };\n\n  onResizeStop = (layouts, finalL, initL) => {\n    document.dispatchEvent(new CustomEvent(\"plotResize\", {detail: {id: initL.i, higher: finalL.h > initL.h}}))\n  }\n\n  shouldComponentUpdate = (newProps) => {\n\n    if( !this._plotsInLayout ) return true\n\n    const isDifferentTab = newProps.active.tab !== this.props.active.tab\n    let hasDifferentPlots;\n    if (!isDifferentTab){\n      let tab = _.find(this.props.tabs, [\"id\", this.props.active.tab])\n      let newTab = _.find(newProps.tabs, [\"id\", newProps.active.tab])\n\n      if (!tab || !newTab) return true\n      else if (!tab.layouts || !newTab.layouts) return true\n      else if (_.isEqual(tab.layouts, newTab.layouts)) return true\n      else if (! _.isEqual(this._plotsInLayout, newTab.plots)) return true\n\n      hasDifferentPlots = ! _.isEqual(tab.plots, newTab.plots)\n    }\n    \n    return isDifferentTab || hasDifferentPlots\n  }\n\n  onLayoutChange = (layout, layouts) => {\n    this.props.onLayoutChange(layout, layouts);\n\n    PythonApi.setTabLayouts(this.props.active.tab, layouts)\n  };\n\n  onDrop = (elemParams) => {\n    alert(`Element parameters: ${JSON.stringify(elemParams)}`);\n  };\n\n  plotFiles = (acceptedFiles) => {\n    acceptedFiles.forEach(file => {\n        PythonApi.plotFile(file)\n    })\n  }\n\n  getLayout = () => {\n    if (!this.props.active.tab ) return this.noTabsMessage()\n\n    let tab = _.find(this.props.tabs, [\"id\", this.props.active.tab])\n\n    if (!tab) return this.noTabsMessage()\n    if (tab.plots.length === 0) return this.noPlotsMessage()\n    \n    let plots = tab.plots.map(plotID => this.props.plots[plotID])\n\n    plots = plots.filter( plot => plot)\n\n    // Wait for all plots to draw a first layout\n    // THIS IS KEY in order to avoid the layout going crazy\n    if (plots.length !== tab.plots.length) return null\n\n    let layouts = tab.layouts\n\n    if (layouts.lg.length !== plots.length){\n      layouts.lg = plots.map(plot => {\n        let layout = _.find(layouts.lg, [\"i\", plot.id])\n        return layout || PlotDashboard.newPlotLayout(plot, layouts)\n      })\n    }\n\n    this._plotsInLayout = tab.plots\n\n    return (\n      <ResponsiveReactGridLayout\n        {...this.props}\n        layouts={layouts}\n        onBreakpointChange={this.onBreakpointChange}\n        onLayoutChange={this.onLayoutChange}\n        onDrop={this.onDrop}\n        onResizeStop={this.onResizeStop}\n        draggableCancel=\".infolayer, .draglayer, .shapelayer, #scene\" //Avoids plot being dragged when zooming and other drag actions\n        // WidthProvider option\n        measureBeforeMount={false}\n        // I like to have it animate on mount. If you don't, delete `useCSSTransforms` (it's default `true`)\n        // and set `measureBeforeMount={true}`.\n        useCSSTransforms={this.state.mounted}\n        compactType={this.state.compactType}\n        preventCollision={!this.state.compactType}\n        rowHeight={10}\n      >\n        {this.generateDOM(layouts.lg, plots, this.state.selected, this.toggleSelected)}\n      </ResponsiveReactGridLayout>\n    )\n\n  }\n\n  mergePlots = (to) => {\n    PythonApi.mergePlots(this.state.selected, to)\n    this.setState({selected: []})\n  }\n\n  removePlots = () => {\n    this.state.selected.forEach(plotID => PythonApi.removePlot(plotID))\n    this.setState({ selected: [] })\n  }\n\n  movePlots = () => {\n    // For now, we will just move the plots to the next tab\n    // (testing if it works)\n    let iTab = _.findIndex(this.props.tabs, [\"id\", this.props.active.tab ]) + 1\n    if (this.props.tabs.length === iTab) iTab = 0\n\n    this.state.selected.forEach(plotID => PythonApi.movePlot(plotID, this.props.tabs[iTab].id ))\n    this.setState({ selected: [] })\n  }\n\n  renderSelectedManager = () => {\n\n    const nSelected = this.state.selected.length\n\n    if (nSelected === 0) return null\n\n    const availableMerges = [\n      {\"to\": \"multiple\"}, {\"to\": \"subplots\"}, {\"to\": \"animation\"}\n    ]\n\n    return <Paper style={{padding: 10, marginBottom: 10}} elevation={3}>\n      {`You have ${nSelected} plots selected. What do you want to do?`}\n      <div style={{display: \"flex\", justifyContent: \"center\", alignItems: \"center\"}}>\n        {nSelected > 1 ? availableMerges.map(\n          merge => <Button onClick={() => this.mergePlots(merge.to)}>{`Merge as ${merge.to}`}</Button>) \n        : null}\n        <Button onClick={this.removePlots}>Remove</Button>\n        <Button onClick={this.movePlots}>Move to other tab</Button>\n      </div>\n    </Paper>\n  }\n\n  render() {\n\n    // We will reuse some of the tabs hot keys handlers\n    //const handlers = {...this.hotKeysHandler, ..._.pick(tabs.hotKeysHandler, [\"MOVE_TO_NEXT_TAB\", \"MOVE_TO_PREVIOUS_TAB\"]) }\n\n    return (\n        // Note that 40vh here makes no sense, but if I don't set\n            // some (nonsense) height value, the content overflows vertically\n            // (to be solved)\n        <div style={{...this.props.style, display: \"flex\", flexWrap: \"wrap\", height: \"40vh\"}}>\n            {/* <GlobalHotKeys keyMap={PLOTS_HOT_KEYS.global} handlers={handlers}/> */}\n            <StructurePicker \n                style={{ paddingLeft: 15, paddingRight: 15, width: \"10vw\", minWidth: 200, borderRight: \"#ccc solid 1px\"}}\n                structures={this.props.structures} plotables={this.props.plotables}\n            />\n            <div style={{flex: 1, height: \"100%\", display: \"flex\", flexDirection:\"column\"}}>\n                <div style={{padding: 10, flex: 1}} className=\"scrollView\">\n                    {this.renderSelectedManager()}\n                    {this.getLayout()}\n                </div>\n                <FilesInput placeholder=\"Drop a file to plot, or click to select one.\" onChange={this.plotFiles}/>\n            </div>\n        </div>\n      \n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  plots: state.plots,\n  plotables: state.session.plotables,\n  structures: state.session.structures,\n  tabs: state.session.tabs,\n  active: state.active,\n})\n\nconst mapDispatchToProps = {\n  setSessionTabs,\n  setTabPlots,\n  setActivePlot\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(withHotKeys(PlotDashboard));","import { FC } from 'react'\n\nimport _ from 'lodash'\nimport Autocomplete from '@material-ui/lab/Autocomplete';\nimport { TextField } from '@material-ui/core';\nimport { ParamInterface, InputFieldInterface } from '../../../interfaces';\n\nexport interface DropdownProps{\n    id?: string,\n    inputField: InputFieldInterface,\n    value: any[]|any,\n    label?: string,\n    setting?: ParamInterface,\n    onChange: (value: any[]|any) => void,\n    style?: Object\n}\n\nconst Dropdown:FC<DropdownProps> = props => {\n    // Parameters that define the behavior of the dropdown\n    const disableClearable = ! props.inputField.params.isClearable\n    const freeSolo = props.inputField.params.isCreatable\n    const multiple = props.inputField.params.isMulti\n    const options = props.inputField.params.options\n\n    const handleChange = (event:any, value:any, reason: string) => {\n\n        value = getValueFromObj(value)\n\n        props.onChange(value)\n    }\n\n    const getValueFromObj = (obj:any):any => {\n        let value;\n        if (multiple && Array.isArray(obj)) {\n            value = obj.map(getValueFromObj)\n        } else if (typeof obj === 'string'){\n            // A new value is being created\n            value = obj\n        } else if (obj !== null) {\n            value = obj.value\n        }\n\n        return sanitizeValue(value)\n    }\n\n    const getObjFromValue = (value:any):any => {\n        let obj = null;\n        if (multiple && Array.isArray(value)) {\n            obj = value.map(getObjFromValue)\n        } else if (value != null) {\n            obj = _.find(options, { value: value })\n            if (obj == null){\n                // This is a value that is not in the options.\n                obj = {value:value, label:value}\n            }\n        }\n\n        return sanitizeValue(obj)\n    }\n\n    const sanitizeValue = (value: any):any => {\n        if (value === null){\n            value = multiple ? [] : null\n        }\n        return value\n    }\n\n    const value = getObjFromValue(props.value)\n\n    return (\n            <Autocomplete\n                fullWidth\n                freeSolo={freeSolo}\n                multiple={multiple}\n                disableClearable={disableClearable}\n                value={value}\n                onChange={handleChange}\n                getOptionLabel={(option) => option.label}\n                options={options}\n                //helperText={this.props.setting.help}\n                renderInput={(params) => <TextField style={{width: \"100%\"}} {...params} label={props.label} variant=\"outlined\" />}\n            />\n        \n    )\n}\n\nexport default Dropdown;\n","import React, { FC } from 'react'\nimport { connect } from 'react-redux'\nimport { SessionInterface } from '../../interfaces'\n\nimport Dropdown from '../settings/inputFields/Dropdown'\n\ninterface PlotTypePickerProps {\n    value: string[],\n    onChange: (value: string[]) => void,\n    options?: { value: string, label: string }[],\n    session: SessionInterface\n}\n\nconst PlotTypePicker:FC<PlotTypePickerProps> = (props) => {\n    const plotOptions = props.options || props.session.plotOptions\n\n    const inputField = {\n        type: \"dropdown\",\n        params: {\n            options: plotOptions,\n            isClearable: true, isMulti: true,\n        }\n    }\n\n    return (\n        <Dropdown\n            value={props.value}\n            inputField={inputField}\n            onChange={props.onChange}\n            label=\"Plot type\"\n        />\n    )\n}\n\nconst mapStateToProps = (state: any) => ({\n    session: state.session\n})\n\nexport default connect(mapStateToProps)(PlotTypePicker);","import { FC } from 'react'\nimport { connect } from 'react-redux'\n\nimport Dropdown from '../settings/inputFields/Dropdown'\n\nimport _ from \"lodash\"\nimport { TabInterface } from '../../interfaces'\n\ninterface TabPickerProps {\n    tabs: TabInterface[],\n    active: {\n        tab: string,\n        [key: string]: any\n    },\n    value: string | null,\n    onChange: (value: string) => void,\n}\n\nconst TabPicker:FC<TabPickerProps> = (props) => {\n\n    const options = props.tabs.map( (tab) => ({label: tab.name, value: tab.id }))\n\n    const value = props.value\n    if (value == null){\n        if (props.active.tab && _.find(props.tabs, [\"id\", props.active.tab])){\n            props.onChange(props.active.tab)\n        }\n    }\n\n    const inputField = {\n        type: \"dropdown\",\n        params: {\n            options: options,\n            isClearable: false, isMulti: false,\n        }\n    }\n\n    return (\n        <Dropdown\n            value={value}\n            inputField={inputField}\n            onChange={props.onChange}\n            label=\"Tab\"\n        />\n    )\n}\n\nconst mapStateToProps = (state: any) => ({\n    tabs: state.session.tabs,\n    active: state.active\n})\n\nexport default connect(mapStateToProps)(TabPicker);\n","import { FC, useContext } from 'react'\nimport { MdRemove } from 'react-icons/md'\nimport { StructureInterface } from '../../interfaces'\nimport { PickerSelectedContext } from '../structures/pickerContext'\n\ninterface StructureRowProps {\n    structure: StructureInterface,\n    groupActive?: boolean,\n    moveStructToActiveGroup: () => void,\n}\n\nconst StructureRow:FC<StructureRowProps> = (props) => {\n    const { unselect } = useContext(PickerSelectedContext)\n\n    const struct = props.structure\n    const groupActive = props.groupActive\n\n    return (\n        <div style={{display: \"flex\", flexDirection: \"row\", justifyContent: \"flex-start\", alignItems: \"center\", marginTop: 10, marginBottom: 10}}>\n            <div \n                style={{color: \"darkred\", cursor: \"pointer\", display: \"flex\", justifyContent: \"center\", alignItems:\"center\"}}\n                onClick={() => unselect(\"structures\", struct.id)}>\n                <MdRemove/>\n            </div>\n            <div \n                style={{cursor: groupActive ? \"default\" : \"pointer\", marginRight: 20, marginLeft: 20, padding: 10, backgroundColor: groupActive ? \"whitesmoke\" : \"#ccc\", borderRadius: 3}}\n                onClick={groupActive ? undefined : props.moveStructToActiveGroup}>\n                {struct.name.replace(\".fdf\", \"\")}\n            </div>\n            <div data-tip={struct.path}>{\".../\" + struct.path.split(\"/\").slice(-2,-1)[0]}</div>\n        </div>\n    )\n}\n\nexport default StructureRow;\n","import { FC } from 'react'\nimport Dropdown from '../settings/inputFields/Dropdown'\n\nconst OPTIONS = [\n    {label: \"Plot individually\", value:\"separatePlot\"},\n    {label: \"Merge in single plot\", value:\"jointPlot\"},\n    {label: \"Build animation\", value:\"jointAnimation\"},\n    {label: \"Animation for each\", value:\"separateAnimation\"},\n]\n\ninterface MergeMethodPickerProps {\n    value: string,\n    onChange: (value: string) => void,\n}\n\nconst MergeMethodPicker:FC<MergeMethodPickerProps> = (props) => {\n\n    const value = props.value\n    if (value == null) {\n        props.onChange(OPTIONS[0].value)\n    }\n\n    const inputField = {\n        type: \"dropdown\",\n        params: {\n            options: OPTIONS,\n            isClearable: false, isMulti: false,\n        }\n    }\n\n    return (\n        <Dropdown\n            value={value}\n            inputField={inputField}\n            onChange={props.onChange}\n            label=\"Plotting method\"\n        />   \n    )\n}\n\nexport default MergeMethodPicker","import { FC } from 'react'\nimport PlotTypePicker from './PlotTypePicker'\nimport TabPicker from './TabPicker'\nimport StructureRow from './StructureRow'\nimport MergeMethodPicker from './MergeMethodPicker'\nimport { Grid } from '@material-ui/core'\nimport { StructureInterface } from '../../interfaces'\n\nexport interface StructureGroup {\n    structs: StructureInterface[],\n    active?: boolean,\n    initializingOptions: {\n        tabID: string,\n        plotClasses: string[],\n        mergeMethod: string,\n    }\n}\n\ninterface StructuresGroupProps extends StructureGroup {\n    splitGroup: () => void,\n    removeGroup: () => void,\n    setGroupAsActive: () => void,\n    moveStructToActiveGroup: (id: string) => void,\n    onInitParamChange: (tabID: string, val: any) => void,\n}\n\nconst StructuresGroup:FC<StructuresGroupProps> = (props) => {\n    const { tabID, plotClasses, mergeMethod } = props.initializingOptions\n    const activenessStyles = props.active ? {\n        backgroundColor: \"#ccc\"\n    } : {\n        backgroundColor: \"whitesmoke\"\n    }\n\n    return (\n        <div>\n            <div style={{ display: \"flex\", flexDirection: \"row\", margin: -4 }}>\n                <div className=\"structGroupAction\" style={activenessStyles} onClick={props.splitGroup}>Split</div>\n                <div className=\"structGroupAction\" style={activenessStyles} onClick={props.removeGroup}>Remove</div>\n                {props.active ?\n                    null\n                    :\n                    <div className=\"structGroupAction\" style={activenessStyles} onClick={props.setGroupAsActive}>Mark as receptive</div>\n                }\n                <div style={{ flex: 1 }} />\n            </div>\n            <Grid container spacing={1} style={{ transition: \"all 300ms\", display: \"flex\", flexWrap: \"wrap\", padding: 20, marginTop: 0, marginBottom: 20, borderRadius: 5, borderTopLeftRadius: 0, justifyContent: \"center\", alignItems: \"center\", ...activenessStyles }}>\n                <Grid item sm={12} md={4} lg={3}>\n                    {props.structs.map(struct => <StructureRow structure={struct} groupActive={props.active} moveStructToActiveGroup={() => props.moveStructToActiveGroup(struct.id)} />)}\n                </Grid>\n                <Grid item sm={12} md={4} lg={3}>\n                    <PlotTypePicker value={plotClasses} onChange={(val) => props.onInitParamChange(\"plotClasses\", val)} />\n                </Grid>\n                <Grid item sm={12} md={4} lg={3}>\n                    <TabPicker value={tabID} onChange={(val) => props.onInitParamChange(\"tabID\", val)} />\n                </Grid>\n                <Grid item sm={12} md={4} lg={3}>\n                    <MergeMethodPicker value={mergeMethod} onChange={(val) => props.onInitParamChange(\"mergeMethod\", val)} />\n                </Grid>\n            </Grid>\n        </div>\n    )\n}\n\nexport default StructuresGroup;","import { FC } from 'react'\nimport { MdRemove } from 'react-icons/md'\n\nimport PlotTypePicker from './PlotTypePicker'\nimport { PlotableInterface } from '../../interfaces'\n\ninterface PlotableRowProps {\n    plotable: PlotableInterface,\n    plots: string[] | undefined,\n    selectPlots: (plots: string[]) => void,\n    unselect: () => void\n}\n\nconst PlotableRow:FC<PlotableRowProps> = (props) => {\n    if (!props.plots && props.plotable.default_plot) {\n        props.selectPlots([props.plotable.default_plot])\n    }\n\n    return (\n        <div style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\", marginTop: 10 }}>\n            <div style={{ display: \"flex\", flexDirection: \"row\", alignItems: \"center\" }}>\n                <div style={{ color: \"darkred\", cursor: \"pointer\", display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }} onClick={props.unselect}>\n                    <MdRemove />\n                </div>\n                <div data-tip={props.plotable.path} style={{ marginLeft: 20 }}>{\"(.../\" + props.plotable.path.split(\"/\").slice(-2, -1)[0] + \")\"}</div>\n                <div style={{ marginLeft: 20, padding: 10, backgroundColor: \"whitesmoke\", borderRadius: 3 }}>\n                    {props.plotable.name}\n                </div>\n            </div>\n            <div style={{ flex: 1, paddingLeft: 20, paddingRight: 20 }}>\n                <PlotTypePicker\n                    options={props.plotable.plots.map(plotOption => ({ value: plotOption, label: plotOption }))}\n                    value={props.plots || [\"\"]}\n                    onChange={props.selectPlots}\n                />\n            </div>\n\n        </div>\n    )\n}\n\nexport default PlotableRow\n\n","import { CSSProperties, FC, useContext, useRef, useState } from 'react'\n\nimport _ from \"lodash\"\n\nimport Card from '@material-ui/core/Card'\n\nimport PythonApi from '../../apis/PythonApi'\n\nimport { connect } from 'react-redux'\nimport { setActiveTab, addPlots, informLoadingPlot, informLoadedPlot } from '../../redux/actions'\nimport StructuresGroup, { StructureGroup } from './StructuresGroup';\nimport { MdClose, MdDone } from 'react-icons/md'\nimport { Button } from '@material-ui/core'\nimport PlotableRow from './PlotableRow'\nimport StructurePicker from '../structures/StructurePicker'\nimport { PickerSelectedContext } from '../structures/pickerContext'\nimport { SessionInterface, StructureInterface, TabInterface } from '../../interfaces'\n\nconst newGroup = (structs: StructureInterface[], tabID: string,  groupParams?: Partial<StructureGroup>): StructureGroup => ({\n    structs: structs,\n    initializingOptions: { tabID: tabID, plotClasses: [], mergeMethod: \"separatePlot\" },\n    ...groupParams\n})\n\nconst cleanUnselectedFromGroups = (groups: StructureGroup[], selectedStructures: string[]) => {\n    /* Removes unselected structures */\n    return groups.reduce((cleanGroups:StructureGroup[], group) => {\n        group = { ...group, structs: group.structs.filter(({ id: structID }) => selectedStructures.includes(structID)) }\n\n        if (group.structs.length > 0) {\n            cleanGroups.push(group)\n        }\n\n        return cleanGroups\n    }, [])\n}\n\nconst markActiveGroup = (iGroup: number, groups: StructureGroup[]) => groups.map((group, i) => ({ ...group, active: i === iGroup }))\n\n\nconst NothingToPlotMessage:FC = (props) => {\n    return <div>\n        <div style={{ color: \"darkred\", fontSize: \"1.3em\", fontWeight: \"bold\" }}>There's nothing to plot currently</div>\n        <div>Select a structure or plotable to begin.</div>\n    </div>\n}\n\ninterface PlotInitializerProps {\n    active: {[key: string]: any},\n    tabs: TabInterface[],\n    session: SessionInterface,\n    style?: CSSProperties\n}\n\nconst PlotInitializer:FC<PlotInitializerProps> = (props) => {\n    const {pickerSelected, nChanges, setPickerSelected, filterSelected, unselect} = useContext(PickerSelectedContext)\n    const [structureGroups, setStructureGroups] = useState<StructureGroup[]>([])\n    const [plotablesPlots, setPlotablesPlots] = useState<{[plotableID: string]: string[]}>({})\n\n    const defaultTabID = props.active.tab ? props.active.tab : props.tabs.length && props.tabs.length > 0 ? props.tabs[0].id : undefined\n\n    // Get the selected objects\n    const selPlotables = filterSelected(\"plotables\", props.session.plotables)\n    const selStructures = filterSelected(\"structures\", props.session.structures)\n    \n    // Group management\n\n    const addGroup = ({ structs }: {structs?: StructureInterface[]}) => {\n        // Add a new group at the end and mark it as active\n        const newStructureGroups = markActiveGroup(structureGroups.length, [...structureGroups, newGroup(structs || [], defaultTabID)])\n\n        setStructureGroups(newStructureGroups)\n    }\n\n    const removeGroup = (iGroup: number) => {\n\n        const group = structureGroups[iGroup]\n\n        if (group.structs.length > 0) {\n            // We need to deactivate all structures in the group, this will automatically update groups\n            unselect(\"structures\", group.structs.map(struct => struct.id))\n        } else {\n            // If no structures in the group, we just delete it\n            let newStructureGroups = structureGroups.filter((g, i) => i !== iGroup)\n\n            // If this was the active group, mark the last one as active\n            if (group.active) {\n                newStructureGroups = markActiveGroup(structureGroups.length - 1, structureGroups)\n            }\n\n            setStructureGroups(newStructureGroups)\n        }\n\n    }\n\n    const splitGroup = (iGroup: number) => {\n        const group = structureGroups[iGroup]\n\n        // Build one group for each structure\n        const splitted = group.structs.map(struct => newGroup([struct], defaultTabID, _.omit(group, [\"structs\"])))\n\n        // Remove the old group\n        let newStructureGroups = structureGroups.filter((g, i) => i !== iGroup)\n\n        // Add the new ones\n        newStructureGroups = [...newStructureGroups.slice(0, iGroup), ...splitted, ...newStructureGroups.slice(iGroup)]\n\n        //If it was the active group, we can't leave all groups as active!\n        if (group.active) newStructureGroups = markActiveGroup(iGroup, newStructureGroups)\n\n        setStructureGroups(newStructureGroups)\n\n    }\n\n    const moveStructToActiveGroup = (structID: string) => {\n\n        //Get the structure\n        const struct = _.find(selStructures, [\"id\", structID])\n        if (!struct) return\n\n        // Remove the structure from its current group and move it to the active group\n        // THIS WILL BE A PROBLEM IF AT SOME POINT THE SAME STRUCTURE IS ALLOWED IN TWO GROUPS AT THE SAME TIME\n        // WE SHOULD THEN SPECIFY THE ORIGIN GROUP!!!!!!!!!!!!!!\n        const newStructureGroups = structureGroups.map(group => {\n\n            let structs = group.active ? [...group.structs, struct] : group.structs.filter(({ id }) => id !== structID)\n\n            return { ...group, structs }\n        })\n\n        setStructureGroups(newStructureGroups)\n\n    }\n\n    const updateGroupInitParams = (iGroup: number, key: string, val: any) => {\n\n        const newStructureGroups = structureGroups.map((group, i) => {\n            return i === iGroup ? { ...group, initializingOptions: { ...group.initializingOptions, [key]: val } } : group\n        })\n\n        setStructureGroups(newStructureGroups)\n    }\n\n    const dismiss = () => setPickerSelected({ structures: [], plotables: [] })\n\n    // When the selected structures change, then update the structure groups\n    const nChangesRef = useRef(0)\n    if (nChangesRef.current !== nChanges) {\n        nChangesRef.current = nChanges\n        let newStructureGroups: StructureGroup[] = [];\n\n        const prevSelectedStructures = structureGroups.reduce((prevStructs: string[], group) => (\n            [...prevStructs, ...group.structs.map(({ id: structID }) => structID)]\n        ), [])\n\n        const newStructs = selStructures.filter(({ id: structID }) => !prevSelectedStructures.includes(structID))\n\n        if (newStructs.length > 0) {\n            if (structureGroups.length === 0) {\n                //In this case build a new group and mark it as active\n                newStructureGroups = markActiveGroup(0, [newGroup(selStructures, defaultTabID)])\n            } else {\n                // Add the new structures to the receptive group\n                newStructureGroups = structureGroups.map((group) => group.active ? { ...group, structs: group.structs.concat(newStructs) } : group)\n            }\n        } else {\n            newStructureGroups = [...structureGroups]\n        }\n\n        newStructureGroups = cleanUnselectedFromGroups(newStructureGroups, pickerSelected.structures)\n        \n\n        //Ensure that there is an active group\n        if (!_.find(newStructureGroups, \"active\")) {\n            newStructureGroups = markActiveGroup(newStructureGroups.length - 1, newStructureGroups)\n        }\n\n        console.log(\"SETTING NEW GROUPS\", newStructureGroups)\n        setStructureGroups(newStructureGroups)\n    }\n\n    const getNewPlot = () => {\n        setPickerSelected({ structures: [], plotables: [] })\n\n        //Plot plotables\n        selPlotables.forEach(plotable => {\n            plotablesPlots[plotable.id].forEach(plotType => {\n                PythonApi.newPlot({ tabID: defaultTabID, plotable_path: plotable.path, plot_method: plotType })\n            })\n        })\n\n        //Plot the structures\n        structureGroups.forEach(({ structs, initializingOptions }) => {\n\n            if (initializingOptions.mergeMethod.includes(\"separate\")) {\n\n                const animation = initializingOptions.mergeMethod.includes(\"Animation\")\n\n                structs.forEach(struct => {\n\n                    initializingOptions.plotClasses.forEach(plotClass => {\n\n                        PythonApi.newPlot(\n                            { tabID: initializingOptions.tabID, structID: struct.id, animation, plotClass: plotClass }\n                        )\n\n                    })\n\n\n                })\n            }\n\n        })\n    }\n\n    if (props.tabs.length === 0) return null\n\n    console.warn(\"STRUCTURE GROUPS\", structureGroups)\n\n    return (\n        <div className=\"plotInitializer\" style={{ ...props.style, display: \"flex\" }}>\n            <StructurePicker\n                structures={props.session.structures}\n                plotables={props.session.plotables}\n                style={{ paddingLeft: 15, paddingRight: 15, width: \"10vw\", minWidth: 200, borderRight: \"#ccc solid 1px\" }}/>\n            <Card\n                style={{ flex: 1, margin: 20, padding: 20, background: \"aliceblue\", overflow: \"visible\" }}>\n                {selStructures.length > 0 ? <div>\n                    <div className=\"sectionHeader\">\n                        Structures\n                    </div>\n                    {structureGroups.map((group, i) => {\n                        return <StructuresGroup\n                            {...group}\n                            onInitParamChange={(key: string, val: any) => updateGroupInitParams(i, key, val)}\n                            setGroupAsActive={() => setStructureGroups(markActiveGroup(i, structureGroups))}\n                            removeGroup={() => removeGroup(i)}\n                            splitGroup={() => splitGroup(i)}\n                            moveStructToActiveGroup={moveStructToActiveGroup}\n                        />\n                    })}\n                    <div onClick={() => addGroup({})}>New Group</div>\n                </div> : null}\n\n                {selPlotables.length > 0 ? <div className=\"sectionHeader\">\n                    Plotables\n                </div> : null}\n\n                <div>\n                    {selPlotables.map(plotable => <PlotableRow \n                        plotable={plotable}\n                        plots={plotablesPlots[plotable.id]}\n                        selectPlots={(newPlots: string[]) => setPlotablesPlots({...plotablesPlots, [plotable.id]: newPlots})}\n                        unselect={() => unselect(\"plotables\", plotable.id)} \n                    />)}\n                </div>\n\n\n                {[...selPlotables, ...selStructures].length === 0 ? <NothingToPlotMessage/> : null}\n\n                <div style={{ display: \"flex\", flexDirection: \"row\", justifyContent: \"center\", alignItems: \"center\", paddingTop: 20 }}>\n\n                    <Button\n                        style={{ marginRight: 20 }}\n                        onClick={dismiss}\n                        endIcon={<MdClose />}\n                    >\n                        Dismiss\n                    </Button>\n\n                    <Button\n                        style={{ marginLeft: 20 }}\n                        onClick={getNewPlot}\n                        endIcon={<MdDone />}\n                    >\n                        Initialize plots\n                    </Button>\n\n                </div>\n\n            </Card>\n        </div>\n    )\n\n}\n\nconst mapStateToProps = (state: any) => ({\n    tabs: state.session.tabs,\n    active: state.active,\n})\n\nconst mapDispatchToProps = {\n    setActiveTab,\n    addPlots,\n    informLoadingPlot,\n    informLoadedPlot,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PlotInitializer);\n","import { FC } from 'react'\nimport Switch from '@material-ui/core/Switch'\nimport { InputFieldProps } from '../InputField';\n\nconst SwitchInput:FC<InputFieldProps<boolean>> = props => {\n    const id = props.id || (props.setting ? props.setting.key : \"\")\n    return (\n        <div className=\"container\">\n            <div style={{paddingBottom: 10}}>{props.label}</div>\n            <Switch\n                id={id}\n                checked={props.value}\n                onChange={(e) => props.onChange(e.target.checked) }\n                {...(props.inputField ? props.inputField.params : undefined)}/>\n        </div>\n    )\n}\n\nexport default SwitchInput;\n","import { FC, useState } from 'react'\nimport { ChromePicker } from 'react-color';\nimport { InputFieldProps } from '../InputField';\n\nconst ColorPicker:FC<InputFieldProps<string>> = (props) => {\n    const [tempcolor, setTempcolor] = useState<string | undefined>(undefined)\n    const [showColorPicker, setShowColorPicker] = useState(false)\n\n    let colorPicker = showColorPicker ? (\n        <div style={{position: \"absolute\", bottom: 60}}>\n            <ChromePicker\n                color={tempcolor || props.value || 'black'}\n                onChange={(color) => {setTempcolor(color.hex)}}\n                onChangeComplete={(color) => {props.onChange(color.hex); setTempcolor(undefined)}}\n                {...(props.inputField ? props.inputField.params : undefined)}/>\n        </div>\n    ) : null;\n\n    return (\n        <div style={{position: \"relative\",display:\"flex\", flexDirection:\"column\", justifyContent:\"center\", alignItems:\"center\"}}>\n            <div style={{paddingBottom: 10}}>{props.label}</div>\n            <div \n                className=\"MuiPaper-elevation3\"\n                onClick={() => setShowColorPicker(!showColorPicker)}\n                style={{width: 30, height: 30, borderRadius: 30, background: props.value}}/>\n            \n            {colorPicker}\n        </div>\n    )\n\n}\n\nexport default ColorPicker;\n","import { FC } from 'react'\n\nimport { Slider } from '@material-ui/core'\nimport { InputFieldProps } from '../InputField'\n\nconst RangeSlider:FC<InputFieldProps<number|number[]>> = props => {\n\n    const params = props.inputField ? props.inputField.params : {}\n    let { min, max, step, marks} = params\n    marks = Array.isArray(marks) ? marks : undefined\n\n    const value = props.value || [0,0]\n\n    return (\n        <div className=\"container\">\n            <div style={{paddingBottom: 10}}>{props.label}</div>\n            <Slider\n                getAriaLabel={() => props.label}\n                value={value}\n                onChange={(event, value) => props.onChange(value)}\n                valueLabelDisplay=\"auto\"\n                min={min} max={max} step={step}\n                marks={marks}\n            />\n        </div>\n    )\n\n}\n\nexport default RangeSlider;\n","import { ChangeEvent, FC } from 'react'\nimport { InputFieldProps, number } from '../InputField'\nimport { TextField } from '@material-ui/core'\n\nconst Range:FC<InputFieldProps<(string|number|null)[]>> = props => {\n    const value = props.value != null ? props.value : [\"\", \"\"]\n\n    const handleChange = (\n        e: ChangeEvent<HTMLTextAreaElement | HTMLInputElement >, \n        i:number, oldValue: (string|number|null)[]\n    ) => {\n        const newVal = number(e.target.value)\n        let valid = true;\n        if (typeof newVal === \"number\"){\n            if (i === 0 && typeof oldValue[1] === \"number\") valid = newVal <= oldValue[1]\n            if (i === 1 && typeof oldValue[0] === \"number\") valid = newVal >= oldValue[0]\n        }\n\n        if (valid) {\n            const finalVal = i === 0 ? [newVal, oldValue[1]] : [oldValue[0], newVal]\n            props.onChange(finalVal)\n        }\n    }\n\n    return (\n        <div>\n            <div style={{paddingBottom: 10}}>{props.label}</div>\n            <div style={{display: 'flex'}}>\n                <TextField\n                    style={{marginRight: 30, flex:1}}\n                    type=\"number\"\n                    variant=\"outlined\"\n                    label=\"min\"\n                    value={value[0]}\n                    onChange={(e) => handleChange(e, 0, value)}\n                    {...(props.inputField ? props.inputField.params : undefined)}/>\n                <TextField\n                    style={{marginLeft: 30, flex:1}}\n                    type=\"number\"\n                    variant=\"outlined\"\n                    label=\"max\"\n                    value={value[1]}\n                    onChange={(e) => handleChange(e, 1, value)}\n                    {...(props.inputField ? props.inputField.params : undefined)}/>\n            </div>\n            \n        </div>\n    )\n}\n\nexport default Range;\n","import { FC } from 'react'\nimport { number } from '../InputField'\nimport TextField from '@material-ui/core/TextField'\nimport { InputFieldInterface, ParamInterface } from '../../../interfaces'\n\ninterface NumericProps {\n    id?: string,\n    inputField?: InputFieldInterface,\n    value: number | string,\n    label?: string,\n    setting?: ParamInterface,\n    onChange: (value: number | string | null) => void,\n    style: Object\n}\n\nconst Numeric:FC<NumericProps> = props => {\n    const additionalProps = props.inputField ? props.inputField.params : {}\n    const value = props.value === undefined ? \"\" : props.value\n\n    return (\n        <div>\n            <TextField\n                type=\"number\"\n                label={props.label}\n                value={value}\n                onChange={(e) => props.onChange( number(e.target.value) )}\n                style = {props.style}\n                variant=\"outlined\"\n                inputProps={additionalProps}/>\n        </div>\n    )\n}\n\nexport default Numeric;\n","import { FC } from 'react'\nimport NumericInput from './Numeric'\n\nimport _ from \"lodash\"\nimport { InputFieldProps } from '../InputField'\nimport { InputFieldInterface } from '../../../interfaces'\n\ninterface ArrayInputProps extends InputFieldProps<number[]> {\n    inputField: InputFieldInterface\n}\n\nconst ArrayInput:FC<ArrayInputProps> = (props) => {\n\n    const changeValue = (newVal:string|number|undefined|null, i:number) => {\n        let value = _.cloneDeep(props.value)\n\n        if (typeof newVal === \"string\" || newVal === null || newVal === undefined) return\n\n        if(!value){\n            value = handleNone()\n        }\n\n        value[i] = newVal\n\n        props.onChange(value)\n    }\n\n    const handleNone = () => {\n        return Array((props.inputField.params.shape || [1])[0]).fill(null)\n    }\n\n    //Params to pass to numeric inputs\n    const orientationStyles = props.inputField.params.vertical ? {\n        marginLeft: 20, marginRight: 20, marginBottom: 0, width: 70\n    } : {\n        marginLeft: 5, marginRight: 5, marginBottom: 0, width: 100\n    }\n    const inputStyle = { ...orientationStyles, textAlign: \"center\"}\n\n    let value = props.value\n\n    if (!value){\n        value = handleNone()\n    }\n\n    return (\n        <div style={{display: \"flex\", flexDirection: \"column\", justifyContent: \"center\", alignItems: \"center\"}}>\n            <div style={{paddingBottom: 10}}>{props.label}</div>\n            <div style={{display: \"flex\", flexDirection: props.inputField.params.vertical ? \"column\" : \"row\", justifyContent: \"center\", alignItems: \"center\"}} className=\"arrayContainer\">\n                {value.map((val, i) => <NumericInput key={i} value={val} onChange={(val) => changeValue(val, i)} style={inputStyle}/>)}\n            </div>  \n        </div>\n    )\n}\nexport default ArrayInput;\n","import { FC,  } from 'react'\nimport InputField, { InputFieldProps, MasterInputFieldProps } from \"../InputField\"\n\nimport { IconButton } from '@material-ui/core'\nimport { AiOutlineDelete } from 'react-icons/ai'\nimport { MdDragHandle, MdPlaylistAdd } from \"react-icons/md\"\nimport {\n    SortableContainer,\n    SortableElement,\n    SortableHandle,\n    SortEnd,\n    arrayMove\n} from 'react-sortable-hoc';\nimport { ParamInterface } from '../../../interfaces'\n\nconst DragHandle = SortableHandle(() => <MdDragHandle size={20} color=\"gray\"/>);\n\ninterface SortableItemProps extends MasterInputFieldProps{\n    sortable: boolean,\n    remove: () => void,\n}\n\nconst SortableItem = SortableElement((props: SortableItemProps) => (\n    <div className=\"listitem\">\n        {props.sortable ? <DragHandle/> : null}\n        <InputField {...props} />\n        {props.remove ? <IconButton className=\"removebutton\" onClick={props.remove}><AiOutlineDelete color=\"red\"/></IconButton> : null }\n    </div>\n));\n\ninterface SortableContainerProps {\n    children: any[]\n}\n\nconst SortableList = SortableContainer((props: SortableContainerProps) => {\n    return <div className=\"listcontainer\">{props.children}</div>;\n});\n\nconst handleNone = () => []\n\nconst sanitizeVal = (value: any):any[] => {\n\n    if(!value){\n        return handleNone()\n    } else if (! Array.isArray(value)){\n        return [value]\n    } else {\n        return value\n    }\n}\n\ninterface ListInputProps extends InputFieldProps<Object[]> {\n    setting: ParamInterface\n}\n\nconst ListInput:FC<ListInputProps> = props => {\n    let value = sanitizeVal(props.value)\n\n    const addItem = () => {\n        props.onChange([...sanitizeVal(props.value), props.setting.default || null])\n    }\n\n    const removeItem = (i: number) => {\n        props.onChange(sanitizeVal(props.value).filter((val, index) => index !== i))\n    }\n\n    const changeValue = (newVal:any, i: number) => {\n        let value = [...sanitizeVal(props.value)]\n\n        value[i] = newVal\n\n        props.onChange(value)\n    }\n\n    const onSortEnd = (args: SortEnd) => {\n\n        props.onChange(\n            arrayMove(sanitizeVal(props.value), args.oldIndex, args.newIndex)\n        )\n\n    };\n\n    return (\n        <div className=\"container\" style={props.style}>\n            <div className=\"namediv\" style={{ paddingBottom: 10 }}>{props.setting.name}</div>\n            <SortableList onSortEnd={onSortEnd} useDragHandle>\n                {value.map((val, i) => (\n                    <SortableItem \n                        key={`item-${i}`} index={i} value={val} \n                        onValueChange={(val: any) => changeValue(val, i)} \n                        remove={() => removeItem(i)}\n                        sortable={props.setting.inputField.params.sortable}\n                        setting={props.setting.inputField.params.itemInput} />\n                ))}\n            </SortableList>\n            <IconButton \n                data-tip=\"Add a new item\"\n                onClick={addItem}>\n                    <MdPlaylistAdd color=\"green\" />\n            </IconButton>\n        </div>\n    )\n}\n\nexport default ListInput;","import { FC, MouseEvent } from 'react'\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { changeSettings } from \"../../redux/actions\"\n\n/*  All the different input fields */\nimport TextInput from './inputFields/TextInput';\nimport Switch from './inputFields/Switch';\nimport Dropdown from './inputFields/Dropdown';\nimport ColorPicker from './inputFields/ColorPicker';\nimport RangeSlider from './inputFields/RangeSlider';\nimport Range from './inputFields/Range';\nimport Numeric from './inputFields/Numeric';\nimport ArrayInput from './inputFields/Array';\nimport ListInput from './inputFields/List';\nimport CreatableDropdown from './inputFields/CreatableDropown';\nimport DictInput from './inputFields/DictInput';\nimport CreatableDictInput from './inputFields/CreatableDict';\n\nimport { InputFieldInterface, ParamInterface } from '../../interfaces';\n\nexport const INPUT_FIELDS:any = {\n    textinput: TextInput,\n    bool: Switch,\n    options: Dropdown,\n    \"creatable options\": CreatableDropdown,\n    dict: DictInput,\n    \"creatable dict\": CreatableDictInput,\n    color: ColorPicker,\n    rangeslider: RangeSlider,\n    range: Range,\n    number: Numeric,\n    vector: ArrayInput,\n    list: ListInput,\n}\n\nexport const number = (value: string | number) : (string | number | null) => {\n    if (typeof value === \"string\") {\n        if (value === \"\") return null\n        if ([\"-\", \".\"].includes(value)) return value\n    }\n    return Number(value)\n}\n\nexport const changeSettingValue = (\n    newValue: any, \n    props: MasterInputFieldProps\n) => {\n\n    if (props.onValueChange){\n        props.onValueChange(newValue)\n    } else if (props.changeSettings && props.onSettingChangeType && props.onSettingChangeExtraParams) {\n        props.changeSettings(props.onSettingChangeType, props.setting.key, newValue, props.onSettingChangeExtraParams)\n    } else {\n        console.error(\"Wrong usage of changeSettingValue\")\n    }\n\n}\n\nexport interface MasterInputFieldProps {\n    setting: ParamInterface,\n    value: any,\n    onValueChange?: (value: any) => void,\n    changeSettings?: (type: string, key: string, value: any, extraParams: any) => void,\n    onSettingChangeType?: string,\n    onSettingChangeExtraParams?: any,\n    style?: any\n}\n\nexport interface InputFieldProps<T> {\n    id?: string,\n    inputField?: InputFieldInterface,\n    setting?: ParamInterface,\n    value: T,\n    label: string,\n    onChange: (value: T) => void,\n    style?: Object\n}\n\nconst InputField:FC<MasterInputFieldProps> = (props) => {\n\n    let inputField = props.setting.inputField\n\n    // Get the input field that we need\n    const InputComponent = INPUT_FIELDS[inputField.type]\n    \n    if (!InputComponent) return null\n\n    const label = props.setting ? props.setting.name : \"\"\n    const fieldLayout = <InputComponent\n        {...props}\n        label={label}\n        inputField={inputField}\n        onChange={(value: any) => changeSettingValue(value, props)}\n    />\n\n    const handleClick = (e:MouseEvent) => {\n        if (e.ctrlKey) {\n            e.stopPropagation()\n            changeSettingValue(props.value == null ? props.setting.default : null, props)\n        }\n    }\n\n    let tooltipParams = {\n        \"data-tip\": (props.setting.help ? props.setting.help + \"<br>\" : \"\") + \"Default: \" + (props.setting.default || \"None\"),\n        \"data-multiline\": true,\n        \"data-effect\": \"solid\",\n        \"data-place\": inputField.type === \"color\" ? \"bottom\" : \"top\", \n    }\n\n    let className = `SISL_INPUTFIELD SISL_INPUTFIELD_${inputField.type.replace(/ /g, \"_\")} SISL_SETTING_${props.setting.key} `\n    if (props.value == null) className = className + \" inputvalue_None\"\n\n    return <div\n        className={className}\n        onClick={handleClick}\n        style={props.style}\n        {...tooltipParams}>\n            {/* <div>{props.setting.key}</div> */}\n            {fieldLayout}\n        </div>\n\n\n}\n\nconst mapStateToProps = (state: any) => ({\n    browser: state.browser\n})\n\nconst mapDispatchToProps = {\n    changeSettings,\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(InputField);","import { FC } from 'react'\n\nimport Dropdown, {DropdownProps} from './Dropdown'\n\nconst CreatableDropdown:FC<DropdownProps>= (props) => {\n    props.inputField.params.isCreatable = true\n    return <Dropdown {...props}/>\n}\n\nexport default CreatableDropdown;\n","import { FC } from 'react'\n\nimport InputField, { InputFieldProps } from '../InputField';\nimport { ParamInterface } from '../../../interfaces';\n\ninterface Value {\n    [key: string]: any\n}\n\ninterface DictInputProps extends InputFieldProps<Value> {\n    setting: ParamInterface\n}\n\nconst DictInput:FC<DictInputProps> = props => {\n\n    const changeSettingValue = (paramKey:string, paramValue:any) => {\n        props.onChange({ ...props.value, [paramKey]: paramValue })\n    }\n\n    const value = props.value || {}\n        const fields = props.setting.inputField.fields || []\n\n        return (\n            <div className=\"container\" style={props.style}>\n                <div className=\"namediv\">{props.setting.name}</div>\n                <div className=\"fieldscontainer\">\n                    {fields.map((field:ParamInterface) => <InputField\n                        //id={field.key}\n                        key={field.key}\n                        setting={field}\n                        value={value[field.key]}\n                        onValueChange={(val) => changeSettingValue(field.key, val)} />)}\n                </div>\n            </div>\n            \n        )\n\n\n}\n\nexport default DictInput;","import { FC, useState } from 'react'\n\nimport _ from 'lodash'\nimport Dropdown from './Dropdown'\n\nimport { AiOutlineDelete } from 'react-icons/ai'\nimport { MdPlaylistAdd } from 'react-icons/md'\nimport { IconButton } from '@material-ui/core'\nimport InputField, { InputFieldProps } from '../InputField'\nimport { ParamInterface } from '../../../interfaces'\n\ninterface Value {\n    [key: string]: any\n}\n\ninterface CreatableDict extends InputFieldProps<Value> {\n    setting: ParamInterface\n}\n\nconst CreatableDictInput:FC<CreatableDict> = props => {\n    const [new_cat_value, setNewCatValue] = useState<string | undefined>(undefined)\n\n    const label = props.label || (props.setting ? props.setting.name : \"\")\n\n    const fields = props.setting.inputField.fields || []\n    const creatable_fields = fields\n\n    let value = props.value || {}\n\n    const getParam = (key: string) => {\n        return _.find(props.setting.inputField.fields || [], [\"key\", key])\n    }\n\n    const onItemChange = (key:string, value:any) => {\n        props.onChange({\n            ...props.value, [key]: value\n        })\n    }\n\n    const addNewItem = (key: string | undefined) => {\n        if (!key) return\n\n        const param = getParam(key)\n        if (!param) return\n\n        onItemChange(key, param.default)\n    }\n\n    const deleteItem = (key: string) => {\n        props.onChange(_.omit(props.value, key))\n    }\n\n    const renderItem = (key: string, value: any) => {\n        // Find the appropiate input field for this key\n        const param = getParam(key)\n\n        if (!param) return null\n\n        // And render it\n        return <fieldset>\n            <legend style={{\n                paddingLeft: 10, paddingRight: 10, paddingTop: 2, paddingBottom: 2, borderRadius: 3,\n                backgroundColor: \"white\"\n            }}>{param.name}</legend>\n            <InputField\n                {...props}\n                setting={{...param, name: \"\"}}\n                value={value}\n                onValueChange={(value) => onItemChange(key, value)}\n            />\n            <IconButton onClick={() => deleteItem(key)}><AiOutlineDelete color=\"red\" /></IconButton>\n        </fieldset>\n    }\n\n    return (\n        <div className=\"container\">\n            <div className=\"namediv\">\n                {label}\n            </div>\n            <div className=\"listcontainer\">\n                {Object.keys(value).map(key => renderItem(key, value[key]))}\n            </div>\n            <div className=\"newfielddiv\">\n                <Dropdown\n                    value={new_cat_value}\n                    onChange={(val) => setNewCatValue(val)}\n                    label=\"Add a new selection...\"\n                    inputField={{\n                        type: \"\",\n                        params: {\n                            options: creatable_fields.map((param: {name:string, key:string}) => ({ label: param.name, value: param.key })),\n                        }\n                    }} />\n                <IconButton onClick={() => addNewItem(new_cat_value)}><MdPlaylistAdd color=\"green\" /></IconButton>\n            </div>\n        </div>\n        \n    )\n}\n\nexport default CreatableDictInput","import { FC, useState } from 'react'\n\nimport Button from '@material-ui/core/Button'\nimport Icon from '@material-ui/core/Icon'\nimport MuiExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport MuiExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport MuiExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport { FaAngleRight } from 'react-icons/fa'\nimport { MdRestore } from 'react-icons/md'\n\nimport InputField from \"./InputField\"\n\nimport parse from 'html-react-parser';\nimport _ from \"lodash\"\nimport { Formik } from 'formik'\n\nimport { ParamGroupInterface, ParamInterface} from '../../interfaces';\n\ninterface SettingsFormProps {\n    paramGroup: ParamGroupInterface,\n    groupedParams: {\n        [key:string]: ParamInterface[] | undefined\n    },\n    index: number,\n    settings: { [key:string]: any },\n    submitSettings: (settings: {[key:string]: any}) => void,\n    undoSettings: () => void,\n    style?: Object,\n}\n\nconst SettingsForm:FC<SettingsFormProps> = props => {\n    const [changedFields, setChangedFields] = useState<string[]>([])\n\n    const paramGroup = props.paramGroup;\n    const groupedParams = props.groupedParams;\n\n    const groupKey = paramGroup.key ? paramGroup.key : \"null\";\n    const settingsGroup = groupedParams[groupKey]\n\n    if (!settingsGroup) return null\n\n    const subGrouped = _.groupBy(settingsGroup, \"subGroup\")\n\n    const nullSubGroup = {key: \"null\", name: null, icon: \"\", description:\"\"}\n    const subGroups = paramGroup.subGroups ? [nullSubGroup,  ...paramGroup.subGroups] : [nullSubGroup]\n\n    return (\n        <Formik\n            enableReinitialize\n            initialValues={props.settings}\n            onSubmit={(values) => {\n                props.submitSettings(Object.fromEntries(\n                    Object.entries(values).filter(([key, value]) => changedFields.includes(key))\n                ))\n            }}\n            >\n                {({values, handleChange, handleSubmit, setFieldValue, resetForm}) => (\n                    <form className={`SISL_INPUTGROUP SISL_INPUTGROUP_${paramGroup.key}`} onSubmit={handleSubmit}>\n                        <blockquote style={{ textAlign: \"left\" }}>\n                            {parse(paramGroup.description)}\n                        </blockquote>\n                        <div className=\"subgroupscontainer\">\n                            {subGroups.map(({key, name}) => {\n\n                                if ( ! subGrouped[key] ) return null\n\n                                return <div key={key} className={`SISL_INPUTSUBGROUP SISL_INPUTSUBGROUP_${key}`}>\n                                    <div className=\"namediv\" style={{paddingBottom: 20, fontWeight:\"bold\", fontSize: \"1.3em\", textAlign: \"left\"}}>{name}</div>\n                                    <div className=\"fieldscontainer\">{ subGrouped[key].map(setting => {\n\n                                    if (!setting.inputField) return null\n\n                                    return <InputField \n                                            key={setting.key}\n                                            onValueChange={(value) => {\n                                                setChangedFields([...changedFields, setting.key])\n                                                setFieldValue(setting.key, value)\n                                            }}\n                                            setting={setting} \n                                            value={values[setting.key]} />\n                                    })}\n                                    </div>\n                                </div>\n                            })}\n                        </div>\n                        <div style={{ display: \"flex\", flexWrap: \"wrap\", justifyContent: \"space-around\" }}>\n                            {/* <Button\n                                onClick={props.undoSettings}\n                                data-tip=\"This will roll back to previous settings.<br> IT AFFECTS ALL GROUPS OF PARAMETERS, not only this one.\"\n                                className=\"orange\"\n                                style={{ margin: 20 }}>\n                                <FaAngleLeft />Previous settings\n                            </Button> */}\n\n                            <Button\n                                onClick={() => resetForm()}\n                                data-tip=\"This will restore the settings to the current ones\"\n                                style={{ margin: 20 }}><MdRestore />Restore</Button>\n\n                            <Button\n                                type=\"submit\"\n                                data-tip=\"This will change the settings and will update everything accordingly.<br> IT ONLY AFFECTS THIS GROUP OF SETTINGS, not all settings\"\n                                style={{ margin: 20 }}>\n                                Submit settings<FaAngleRight />\n                            </Button>\n                        </div>\n                    </form>\n                )}\n        </Formik>\n    )\n}\n\ninterface SettingGroupsCollapseProps extends SettingsFormProps {}\n\nconst SettingGroupsCollapse:FC<SettingGroupsCollapseProps> = props => {\n    const paramGroup = props.paramGroup;\n\n    const groupKey = paramGroup.key ? paramGroup.key : \"null\";\n\n    return (\n        <MuiExpansionPanel\n            key={groupKey}>\n            <MuiExpansionPanelSummary style={{ display: \"flex\", justifyContent: \"center\", alignItems: \"center\" }}>\n                <Icon>{paramGroup.icon}</Icon>\n                <span style={{paddingLeft: 10}}>{paramGroup.name}</span>\n            </MuiExpansionPanelSummary>\n            <MuiExpansionPanelDetails>\n                <SettingsForm {...props} />\n            </MuiExpansionPanelDetails>\n        </MuiExpansionPanel> \n    )\n}\n\ninterface SettingsContainerProps {\n    className?: string,\n    settings: {[key:string]: any}\n    params: ParamInterface[],\n    paramGroups: ParamGroupInterface[],\n    submitSettings: (settings: {[key:string]: any}) => void,\n    undoSettings: () => void,\n    style?: Object,\n}\n\nconst SettingsContainer:FC<SettingsContainerProps> = props => {\n    let groupedParams = _.groupBy(props.params, \"group\")\n\n    return (\n        <div style={props.style} className={props.className}>\n            {props.paramGroups.map((paramGroup, iParamGroup) => (\n                <SettingGroupsCollapse\n                    key={iParamGroup} \n                    index={iParamGroup}\n                    paramGroup={paramGroup} \n                    groupedParams={groupedParams}\n                    {...props}\n                    />\n            )) }        \n        </div>\n    )\n}\n\nexport default SettingsContainer;\n\n","import { FC } from 'react'\nimport Grid from '@material-ui/core/Grid';\nimport ReactTooltip from \"react-tooltip\"\n\nimport PythonApi from \"../apis/PythonApi\"\n\n//--Components\nimport PlotCard from '../components/plots/PlotCard'\nimport SettingsContainer from '../components/settings/SettingsContainer'\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { selectActivePlot } from '../redux/reducers'\nimport { PlotInterface, SessionInterface } from '../interfaces';\n\ninterface PlotTweakingProps {\n    plots: {[key: string]: PlotInterface},\n    activePlot: PlotInterface,\n    session: SessionInterface,\n    browser: any,\n    style: {[key: string]: any},\n    goto?: (path: string) => void,\n}\n\nconst PlotTweaking:FC<PlotTweakingProps> = (props) => {\n    const activePlot = props.activePlot\n\n    if (! activePlot ) return null\n    const plotSettings = activePlot.settings\n\n    console.warn(activePlot)\n\n    let setsCont = <SettingsContainer\n                        className={\"SISL_SETTING_PLOTCLASS_\" + activePlot.plotClass} \n                        settings={plotSettings}\n                        params={activePlot.params}\n                        paramGroups={activePlot.paramGroups}\n                        submitSettings={(settings) => PythonApi.updatePlotSettings(activePlot.id, settings)}\n                        undoSettings={() => PythonApi.undoPlotSettings(activePlot.id)}/>\n    \n    return (\n        <div style={{...props.style, }}>\n            <Grid container style={{paddingLeft: \"20px\"}}>\n                <Grid item sm={12} md={4} style={{height:\"90vh\", display: \"flex\", flexDirection: \"column\", justifyContent: \"center\", alignItems:\"center\"}}>\n                    <PlotCard plot={activePlot} style={{height: \"80vh\"}}/>\n                </Grid>\n                <Grid item sm={12} md={8} style={{ padding: 20, display: \"flex\", flexDirection: \"column\"}} >\n                    {props.browser.mediaType === \"infinity\" ? <div className=\"scrollView\" style={{ maxHeight: \"90vh\"}}>{setsCont}</div> : setsCont}\n                </Grid>\n            </Grid>\n            <ReactTooltip effect=\"solid\" multiline disable={props.session.settings ? !props.session.settings.showTooltips : false}/>  \n        </div>\n        \n    )\n}\n\nconst mapStateToProps = (state: {[key:string]: any}) => ({\n    plots: state.plots,\n    activePlot: selectActivePlot(state),\n    session: state.session,\n    browser: state.browser\n})\n\nexport default connect(mapStateToProps)(PlotTweaking);\n","import { FC } from 'react'\nimport ReactMarkDown from \"react-markdown\"\nimport { ExpansionPanel, ExpansionPanelSummary, ExpansionPanelDetails, Button, ExpansionPanelActions } from '@material-ui/core'\nimport { ShortCutInterface } from '../../interfaces'\n\ninterface MethodProps {\n    sequence: string,\n    shortcut: ShortCutInterface,\n    applyMethod: () => void,\n}\n\nconst Method:FC<MethodProps> = props => {\n    return (\n        <ExpansionPanel>\n            <ExpansionPanelSummary\n                style={{display: \"flex\", cursor: \"pointer\", justifyContent: \"space-between\", alignItems: \"center\"}}>\n                <span style={{color: \"gray\", marginRight: 10}}>{props.sequence}</span>\n                <span style={{fontWeight: \"bold\"}}>{props.shortcut.name}</span>\n            </ExpansionPanelSummary>\n            <ExpansionPanelDetails style={{fontSize: 13}}>\n                <ReactMarkDown>{props.shortcut.description}</ReactMarkDown>\n            </ExpansionPanelDetails>\n            <ExpansionPanelActions>\n                <Button onClick={props.applyMethod}>APPLY METHOD</Button>\n            </ExpansionPanelActions>\n        </ExpansionPanel>\n    )\n}\n\nexport default Method;\n","import { FC } from 'react'\nimport { ShortcutsInterface } from '../../interfaces';\nimport Method from './Method'\n\ninterface MethodsProps {\n    applyMethod: (key: string) => void,\n    shortcuts: ShortcutsInterface\n}\n\nconst Methods:FC<MethodsProps> = props => {\n    return (\n        <div className=\"scrollView\" style={{textAlign: \"left\", borderRadius: 3, maxHeight: \"90vh\"}}>\n            {Object.keys(props.shortcuts).map((sequence) => \n                <Method \n                    sequence={sequence} shortcut={props.shortcuts[sequence]}\n                    applyMethod={() => props.applyMethod(sequence)}/>\n            )}\n        </div>\n    )\n}\n\nexport default Methods;\n","import { FC } from 'react'\nimport Grid from '@material-ui/core/Grid';\nimport ReactTooltip from \"react-tooltip\"\n\n//--Components\nimport PlotCard from '../components/plots/PlotCard'\n\n//--Redux\nimport { connect } from 'react-redux'\nimport PythonApi from '../apis/PythonApi';\nimport Methods from '../components/pythonMethods/Methods'\nimport { selectActivePlot } from '../redux/reducers'\nimport { PlotInterface, SessionInterface } from '../interfaces';\n\ninterface PlotMethodsProps {\n    activePlot: PlotInterface,\n    session: SessionInterface,\n    style: {[key: string]: any},\n}\n\nconst PlotMethods:FC<PlotMethodsProps> = props => {\n    return (\n        <div style={{...props.style, paddingLeft: \"20px\"}}>\n            {/* <GlobalHotKeys keyMap={PLOT_TWEAKING_HOT_KEYS.global} handlers={this.hotKeysHandlers}/> */}\n            <Grid container>\n                <Grid item sm={12} md={4} style={{ height: \"90vh\", display: \"flex\", flexDirection: \"column\", justifyContent: \"center\", alignItems: \"center\" }}>\n                    <PlotCard plot={props.activePlot} style={{ height: \"80vh\" }} />\n                </Grid>\n                <Grid item sm={12} md={8} style={{ padding: 20, display: \"flex\", flexDirection: \"column\" }} >\n                    <Methods \n                        shortcuts={props.activePlot.shortcuts}\n                        applyMethod={(key:string) => PythonApi.callPlotShortcut(props.activePlot.id, key)}/>\n                </Grid>\n            </Grid>\n            <ReactTooltip multiline disable={props.session.settings ? !props.session.settings.showTooltips : false} />   \n        </div>\n        \n    )\n}\n\nconst mapStateToProps = (state: any) => ({\n    activePlot: selectActivePlot(state),\n    session: state.session,\n})\n\nexport default connect(mapStateToProps)(PlotMethods);\n","\nimport PythonApi from \"../apis/PythonApi\"\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { selectActivePlot } from '../redux/reducers'\n\nimport React, { Component } from 'react';\nimport plotly from 'plotly.js/dist/plotly';\nimport PlotlyEditor from 'react-chart-editor';\nimport 'react-chart-editor/lib/react-chart-editor.css';\n\n// const dataSources = {\n//     col1: [1, 2, 3], // eslint-disable-line no-magic-numbers\n//     col2: [4, 3, 2], // eslint-disable-line no-magic-numbers\n//     col3: [17, 13, 9], // eslint-disable-line no-magic-numbers\n// };\n\n// const dataSourceOptions = Object.keys(dataSources).map(name => ({\n//     value: name,\n//     label: name,\n// }));\n\nconst config = { editable: true };\n\nclass PlotEditor extends Component {\n\n    constructor(props) {\n        super(props);\n        const activePlot = props.activePlot\n        this.state = activePlot.figure;\n    }\n\n    hotKeysHandlers = {\n        UNDO_SETTINGS: () => this.undoSettings(),\n        SUBMIT_ALL_SETTINGS: () => this.submitSettings(\"all\")\n    }\n\n    submitSettings = (settings) => {\n\n        if (settings === \"all\") {\n            settings = this.props.activePlot.unsubmittedSettings\n        }\n\n        PythonApi.updatePlotSettings(this.props.activePlot.id, settings)\n\n    }\n\n    componentWillUnmount(){\n\n        PythonApi.updateFigure(this.props.activePlot.id, {...this.state, overwrite: true})\n        // this.props.addPlots({\n        //     [this.props.activePlot.id]: {\n        //         ...this.props.activePlot,\n        //         figure: this.state\n        //     }\n        // })\n    }\n\n    undoSettings = () => {\n\n        PythonApi.undoPlotSettings(this.props.activePlot.id)\n\n    }\n\n    render() {\n\n        const activePlot = this.props.activePlot\n\n        if (!activePlot) return null\n\n        return (\n            // Note that 40vh here makes no sense, but if I don't set\n            // some (nonsense) height value, the content overflows vertically\n            // (to be solved)\n            <div style={{...this.props.style, height: \"40vh\"}}>\n                <PlotlyEditor\n                data={this.state.data}\n                layout={this.state.layout}\n                config={config}\n                frames={this.state.frames}\n                plotly={plotly}\n                style={{...this.props.style}}\n                onUpdate={(data, layout, frames) =>\n                    this.setState({ data, layout, frames })\n                }\n                useResizeHandler\n                debug\n                advancedTraceTypeSelector\n            />\n            </div>\n            \n        )\n    }\n}\n\nconst mapStateToProps = state => ({\n    activePlot: selectActivePlot(state),\n})\n\nexport default connect(mapStateToProps, null)(PlotEditor);","import { FC, FocusEvent } from 'react'\n\nimport { MdRemoveCircle } from 'react-icons/md'\nimport { TabInterface } from '../../interfaces';\n\ninterface TabComponentInterface {\n    tab: TabInterface,\n    selected: boolean,\n    selectTab: () => void,\n    removeTab: () => void,\n    updateTabName: (name: string ) => void,\n}\n\nconst Tab:FC<TabComponentInterface> = (props) => {\n\n    const updateTabName = (e: FocusEvent<HTMLDivElement>) => {\n        if (e.target.blur) e.target.blur(); \n        const name = e.target.textContent\n        if (name) props.updateTabName(name)}\n    \n    const {id: tabID, name: tabName} = props.tab\n\n    return (\n        <div\n                key={tabID}\n                className={props.selected ? \"active plotTab\" : \"plotTab\"}\n                onClick={props.selected ? undefined : props.selectTab}>\n            <div\n                id={tabID}\n                contentEditable={props.selected}\n                \n                onBlur={updateTabName}\n                //onKeyUp={(e) => {if (e.keyCode === 13) updateTabName(e)}}\n                >{tabName}</div>\n            {props.selected ? <div className=\"removeTabBut\" onClick={props.removeTab}><MdRemoveCircle size={20}/></div> : null}\n        </div>\n    )\n}\n\nexport default Tab;","import { Component } from 'react'\nimport Tab from './Tab'\nimport { setActiveTab } from '../../redux/actions'\nimport PythonApi from '../../apis/PythonApi'\nimport { connect } from 'react-redux'\n\nimport _ from \"lodash\"\nimport { GlobalHotKeys } from 'react-hotkeys'\nimport { TABS_HOT_KEYS } from '../../utils/hotkeys'\n\nexport class Tabs extends Component {\n\n    hotKeysHandlers = {\n        MOVE_TO_NEXT_TAB: () => this.moveThroughTabs(\"right\"),\n        MOVE_TO_PREVIOUS_TAB: () => this.moveThroughTabs(\"left\"),\n        NEW_TAB: () => this.newTab(),\n        TRY: () => console.warn(\"YES\")\n    }\n    \n    moveThroughTabs = (direction) => {\n\n        const tabs = this.props.tabs\n        const i = _.findIndex(tabs, [\"id\", this.props.active.tab])\n\n        var newI;\n        if (direction === \"left\"){\n            newI = i !== 0 ? i-1 : tabs.length -1\n        } else if (direction === \"right\"){\n            newI = i !== tabs.length - 1 ? i+1 : 0 \n        }\n\n        this.props.setActiveTab(tabs[newI].id)\n    }\n\n    updateTabs = (tabs) => {\n        document.dispatchEvent(new CustomEvent(\"updateTabs\", {detail: {tabs: tabs}}))\n    }\n\n    newTab = () => {\n\n        PythonApi.addTab()\n        \n    }\n\n    noTabsMessage = () => {\n        return <div style={{paddingLeft: 20}}>\n            <span style={{color: \"darkred\"}}>You don't seem to have any tab. </span>\n        </div>\n    }\n\n    render() {\n\n        const tabs = this.props.tabs || []\n        const TabComponent = this.props.tabComponent || Tab\n        const NewTabComponent = this.props.newTabComponent || ((props) => null)\n        const noTabsComponent = this.props.noTabsComponent || this.noTabsMessage()\n\n        return (\n            <div style={{display: \"flex\", flexWrap: \"wrap\", alignItems:\"center\", ...this.props.style}}>\n                <GlobalHotKeys keyMap={TABS_HOT_KEYS.global} handlers={this.hotKeysHandlers}/>\n                {tabs.length === 0 ? \n                    noTabsComponent\n                    :\n                    tabs.map( \n                        tab => <TabComponent \n                            tab={tab} \n                            selected={this.props.active.tab === tab.id}\n                            selectTab={() => this.props.setActiveTab(tab.id)}\n                            removeTab={() => PythonApi.removeTab(tab.id)}\n                            updateTabName={(name) => PythonApi.updateTab(tab.id, {name: name})}\n                        />\n                    )\n                }\n                <NewTabComponent onClick={this.newTab}/>\n            </div>\n        )\n    }\n}\n\nconst mapStateToProps = state => ({\n    tabs: state.session.tabs,\n    active: state.active\n})\n\nconst mapDispatchToProps = {\n    setActiveTab\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Tabs);\n","import { useContext, useRef, useState } from 'react'\n\nimport _ from \"lodash\"\n\n//--Components\nimport PlotDashboard from '../components/plots/PlotDashboard';\n\n//--Python api \nimport PythonApi from '../apis/PythonApi'\n\n//--Redux\nimport { connect } from 'react-redux'\nimport { setActivePlot, setActivePage} from \"../redux/actions\"\nimport PlotInitializer from '../components/plotInitializer/PlotInitializer'\nimport PlotTweaking from './PlotTweaking'\n\nimport { Button, IconButton, TextField, Toolbar} from '@material-ui/core';\n\nimport {getApplicationKeyMap, GlobalHotKeys, configure} from 'react-hotkeys'\nimport PlotMethods from './PlotMethods';\nimport PlotEditor from './PlotEditor';\nimport { GLOBAL_HOT_KEYS } from '../utils/hotkeys';\nimport Tabs from '../components/tabs/Tabs';\nimport { MdRemoveCircle, MdAddCircle } from 'react-icons/md';\nimport StructurePickerProvider, { PickerSelectedContext } from '../components/structures/pickerContext';\n\nconfigure({logLevel: \"debug\", simulateMissingKeyPressEvents: false})\n\nconst Tab = (props) => {\n    const [editable, setEditable] = useState(false)\n\n    if (editable && !props.selected) setEditable(false)\n\n    const updateTabName = (e) => {\n        if (e.key === 'Enter') {\n            props.updateTabName(e.target.value);\n            setEditable(false)\n        }\n    }\n\n    const {name: tabName} = props.tab\n\n    if (editable) {\n        return <TextField label=\"Tab name\" defaultValue={tabName} onKeyPress={updateTabName}/>\n    } else {\n        return <Button \n            color=\"inherit\"\n            style={{backgroundColor: props.selected ? \"whitesmoke\" : undefined, marginRight: 10}}\n            onClick={props.selected ? undefined : props.selectTab}\n            onDoubleClick={() => setEditable(true)}\n            endIcon={props.selected ? <MdRemoveCircle className=\"removeTabBut\" onClick={props.removeTab}/> : undefined}\n            >{tabName}</Button>\n    }\n}\n\nconst NewTabButton = (props) => {\n    return <IconButton color=\"inherit\" aria-label=\"add new tab\" component=\"span\" onClick={props.onClick}>\n        <MdAddCircle color=\"green\" className='newTabIcon'/>\n    </IconButton>\n}\n\nconst Plots = (props) => {\n    const {pickerSelected} = useContext(PickerSelectedContext)\n\n    const nSelected = Object.keys(pickerSelected).reduce((n, k) => n + pickerSelected[k].length, 0)\n    const selectedRef = useRef(nSelected)\n\n    // Selected objects have changed, toggle the plot initializer\n    if (selectedRef.current !== nSelected) {\n        console.warn(nSelected, props.active.page)\n        if (nSelected === 0 && props.active.page === \"plotInitializer\") {\n            props.setActivePage(\"plots\")\n        } else if (nSelected > 0 && props.active.page !== \"plotInitializer\") {\n            props.setActivePage(\"plotInitializer\")\n        }\n        selectedRef.current = nSelected\n    }\n\n    const activeTab = _.find(props.tabs, [\"id\", props.active.tab])\n    if (activeTab){\n        //Get the missing plots if there are any\n        activeTab.plots.forEach(plotID => {\n\n            if (!props.plots[plotID]) {\n\n                PythonApi.getPlot(plotID)\n\n            }\n        })\n    }\n\n    const hotKeysHandlers = {\n        GO_TO_DASHBOARD: () => props.setActivePage(\"plots\"),\n        SHOW_AVAIL_HOTKEYS: () => console.warn(getApplicationKeyMap())\n    }\n\n    if (!props.active.plot && ![\"plotInitializer\", \"plots\"].includes(props.active.page)) {\n        props.setActivePage(\"plots\")\n    }\n\n    const MainComponent = {\n        'plots': PlotDashboard,\n        'plotLayoutEditor': PlotEditor,\n        'plotTweaking': PlotTweaking,\n        'plotMethods': PlotMethods,\n        'plotInitializer': PlotInitializer,\n    }[props.active.page]\n\n    return (\n        <div style={{ height: \"100%\", display: \"flex\", flexDirection: \"column\" }}>\n            <GlobalHotKeys keyMap={{ ...GLOBAL_HOT_KEYS }} handlers={hotKeysHandlers} />\n            <Toolbar style={{ backgroundColor: \"#cccccc\" }}>\n                {[\"plots\"].includes(props.active.page) ? null :\n                    <Button color=\"inherit\" onClick={() => props.setActivePage(\"plots\")}>BACK TO DASHBOARD</Button>\n                }\n                {props.active.page === \"plots\" ? <Tabs tabComponent={Tab} newTabComponent={NewTabButton} /> : null}\n            </Toolbar>\n            <MainComponent\n                style={{ flex: 1 }}\n                session={props.session}\n                goto={props.setActivePage}\n            />\n        </div>\n    )\n\n}\n\nconst PlotsWithProvider = (props) => {\n    return <StructurePickerProvider>\n        <Plots {...props}/>\n    </StructurePickerProvider>\n}\n\nconst mapStateToProps = state => ({\n    plots: state.plots,\n    tabs: state.session.tabs,\n    active: state.active,\n    session: state.session\n})\n\nconst mapDispatchToProps = {\n    setActivePlot,\n    setActivePage\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(PlotsWithProvider);","import { useState, useEffect } from 'react';\n\nfunction getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height\n  };\n}\n\nfunction useWindowDimensions() {\n  const [windowDimensions, setWindowDimensions] = useState(getWindowDimensions());\n\n  useEffect(() => {\n    function handleResize() {\n      setWindowDimensions(getWindowDimensions());\n    }\n\n    window.addEventListener('resize', handleResize);\n    return () => window.removeEventListener('resize', handleResize);\n  }, []);\n\n  return windowDimensions;\n}\n\nconst SislDocs = props => {\n    const { height } = useWindowDimensions();\n\n    return <iframe \n        src={\"https://zerothi.github.io/sisl/\"} title=\"Sisl documentation\" aria-label=\"Sisl documentation\" \n        style={{height: height - 20, width: \"99%\"}}/>\n\n}\n\nexport default SislDocs;","import React, { useRef, useState } from 'react'\nimport { Canvas, useFrame } from 'react-three-fiber'\n\nfunction Box(props) {\n    // This reference will give us direct access to the mesh\n    const mesh = useRef()\n\n    // Set up state for the hovered and active state\n    const [hovered, setHover] = useState(false)\n    const [active, setActive] = useState(false)\n\n    // Rotate mesh every frame, this is outside of React without overhead\n    useFrame(() => {\n        mesh.current.rotation.x = mesh.current.rotation.y += 0.01\n    })\n\n    return (\n        <mesh\n            {...props}\n            ref={mesh}\n            scale={active ? [1.5, 1.5, 1.5] : [1, 1, 1]}\n            onClick={(e) => setActive(!active)}\n            onPointerOver={(e) => setHover(true)}\n            onPointerOut={(e) => setHover(false)}>\n            <boxBufferGeometry attach=\"geometry\" args={[1, 1, 1]} />\n            <meshStandardMaterial attach=\"material\" color={hovered ? 'hotpink' : 'orange'} />\n        </mesh>\n    )\n}\n\nexport default function NotConnected(props){\n\n    return <Canvas style={props.style} {...props}>\n        <ambientLight />\n        <pointLight position={[10, 10, 10]} />\n        <Box position={[-1.2, 0, 0]} sign={-1}/>\n        <Box position={[1.2, 0, 0]} />\n    </Canvas>\n}","import { FC, useState } from 'react'\nimport PythonApi from \"../apis/PythonApi\"\n\n//--Components\nimport ReactTooltip from \"react-tooltip\"\nimport SettingsContainer from \"../components/settings/SettingsContainer\"\n\n//--Redux\nimport { connect } from 'react-redux'\n\nimport _ from \"lodash\"\nimport { SessionInterface } from '../interfaces'\nimport { Button, Toolbar } from '@material-ui/core'\nimport FilesInput from '../components/settings/inputFields/Files'\nimport NotConnected from '../components/loading/NotConnected'\nimport Methods from '../components/pythonMethods/Methods'\n\ninterface SessionSettingsProps {\n    session: SessionInterface,\n    style: {[key: string]: any},\n}\n\nconst saveCurrentSession = (currentSession: SessionInterface) => {\n    const path = prompt(\"Please provide the path to save the session.\\n\\nRoot directory:\\n\" + currentSession.settings.root_dir)\n    if (!path) return \n\n    PythonApi.saveSession(path)\n}\n\nconst loadSession = (acceptedFiles: File[]) => {\n    const sessionFile = acceptedFiles[0]\n    PythonApi.loadSessionFromFile(sessionFile)\n}\n\nconst downloadSession = () => {\n    PythonApi.getSessionFile((file:ArrayBuffer) => {\n        var blob = new Blob([file]);\n        const url = window.URL.createObjectURL(blob);\n\n        const link = document.createElement('a');\n        link.href = url;\n        link.setAttribute(\n        'download',\n        `newSession.session`,\n        );\n\n        link.click();\n    })\n}\n\nconst SessionSettings:FC<SessionSettingsProps> = props => {\n    const [connected, setConnected] = useState(PythonApi && PythonApi.socket ? PythonApi.socket.connected : false)\n    const [tabKey, setTabKey] = useState(\"settings\")\n\n    PythonApi.onConnect(() => {\n        setConnected(true)\n    })\n\n    if (!connected) {\n        return <div style={{...props.style, height:\"100%\", display:\"flex\", flexDirection: \"column\"}}>\n            <div style={{ paddingTop: 100 }}>\n                <div style={{ fontSize: \"2.5em\", fontWeight: \"bold\"}}>We are trying to connect to the sisl API.</div>\n            </div>\n            <NotConnected style={{flex: 1}} camera={{ position: [0, 0, 5] }}/>\n            <div style={{ paddingBottom: 100, fontSize: \"1.2em\" }}> Meanwhile you can have fun with these two moving cubes. </div>\n        </div>\n    }\n\n    if ( _.isEmpty(props.session) ) return null\n\n    var component = null\n    if (tabKey === \"settings\") {\n        component = <div style={{padding: 20, flex: 1}} className=\"scrollView\">\n            <SettingsContainer\n                className={`SISL_SETTING_SESSION SISL_SETTING_SESSIONCLASS_${props.session.sessionClass}`}\n                settings={props.session.settings}\n                params={props.session.params}\n                paramGroups={props.session.paramGroups}\n                submitSettings={PythonApi.updateSessionSettings}\n                undoSettings={PythonApi.undoSessionSettings}/>\n        </div>\n    } else if (tabKey === \"methods\") {\n        component = <div style={{padding: 20, flex: 1}} className=\"scrollView\">\n            <Methods \n                shortcuts={props.session.shortcuts}\n                applyMethod={(key:string) => PythonApi.callSessionShortcut(key)}/>\n        </div>\n    }\n\n    return (\n        <div style={{...props.style, height: \"100%\", display: \"flex\", flexDirection: \"column\"}}>\n            <Toolbar style={{backgroundColor: \"#cccccc\", justifyContent: \"space-between\"}}>\n                <div>\n                    <Button \n                        color=\"inherit\"\n                        style={{backgroundColor: tabKey === \"settings\" ? \"whitesmoke\" : undefined, marginRight: 10}} \n                        onClick={() => setTabKey(\"settings\")}>SETTINGS</Button>\n                    <Button \n                        color=\"inherit\"\n                        style={{backgroundColor: tabKey === \"methods\" ? \"whitesmoke\" : undefined}}\n                        onClick={() => setTabKey(\"methods\")}>METHODS</Button>\n                </div>\n                <div>\n                    <Button color=\"inherit\" data-tip=\"Download current session as a file\" onClick={downloadSession}>DOWNLOAD</Button>\n                    <Button color=\"inherit\" data-tip=\"Save current session\" onClick={() => saveCurrentSession(props.session)}>SAVE</Button>\n                    <Button color=\"inherit\" \n                        // data-tip=\"Load a saved session. You can drop a file here or click to browse your computer\"\n                    >\n                        <FilesInput placeholder=\"LOAD\" onChange={loadSession}/>\n                    </Button>\n                </div>\n            </Toolbar>\n            {component}\n            <ReactTooltip multiline effect=\"solid\" disable={props.session.settings ? !props.session.settings.showTooltips : false}/>\n        </div>\n        \n    )\n}\n\nconst mapStateToProps = (state: {[key: string]: any}) => ({\n    session: state.session\n})\n\nexport default connect(mapStateToProps)(SessionSettings);\n\n\n","import React, { Component } from 'react'\nimport PythonApi from '../../apis/PythonApi'\nimport { FiWifi, FiWifiOff } from 'react-icons/fi'\n\nexport default class ConnectionStatus extends Component {\n\n    constructor(props){\n        super(props)\n\n        this.state = { connected: PythonApi.socket.connected }\n    }\n\n    componentDidMount() {\n        PythonApi.onConnect(() => this.setState({connected: true}))\n        PythonApi.onDisconnect(() => this.setState({ connected: false }))\n    }\n\n    render() {\n\n        const style = this.state.connected ? { backgroundColor: \"lightgreen\" } : { backgroundColor: \"salmon\" }\n\n        const addStyles = this.state.connected ? this.props.connectedStyle : this.props.disconnectedStyle\n\n        return <div {...this.props} style={{...style, ...this.props.style, ...addStyles}}\n                data-tip={this.state.connected ? `Connected to ${PythonApi.apiAddress}` : \"Currently not connected\"} \n                data-place=\"left\"\n                data-background-color={style.backgroundColor}>\n            {this.state.connected ? <FiWifi color=\"green\" size={20} /> : <FiWifiOff color=\"darkred\" size={20}/>}\n        </div>\n\n    }\n}\n","import * as React from 'react';\nimport PropTypes from 'prop-types';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport Box from '@material-ui/core/Box';\n\nimport Plots from './Plots';\nimport SislDocs from './SislDocs';\nimport Settings from './Session';\nimport ConnectionStatus from '../components/controls/ConnectionStatus';\nimport { ToastContainer } from 'react-toastify';\nimport 'react-toastify/dist/ReactToastify.min.css'\n\nfunction TabPanel(props) {\n  const { children, value, index, ...other } = props;\n\n  return (\n    <div\n      role=\"tabpanel\"\n      hidden={value !== index}\n      id={`simple-tabpanel-${index}`}\n      aria-labelledby={`simple-tab-${index}`}\n      style={{flex: 1, height: \"100%\"}}\n      {...other}\n    >\n      {value === index && (\n        <Box sx={{width: \"100%\", height: \"100%\"}}>\n          {children}\n        </Box>\n      )}\n    </div>\n  );\n}\n\nTabPanel.propTypes = {\n  children: PropTypes.node,\n  index: PropTypes.number.isRequired,\n  value: PropTypes.number.isRequired,\n};\n\nfunction a11yProps(index) {\n  return {\n    id: `simple-tab-${index}`,\n    'aria-controls': `simple-tabpanel-${index}`,\n  };\n}\n\nexport default function MainPage() {\n  const [value, setValue] = React.useState(1);\n\n  const handleChange = (event, newValue) => {\n    setValue(newValue);\n  };\n\n  return (\n    <Box\n    sx={{ flexGrow: 1, display: 'flex', height: \"100vh\"}}>\n    <Box sx={{bgcolor:\"background.paper\"}}>\n        <ConnectionStatus\n            connectedStyle={{ backgroundColor: \"lightgreen\", display: \"none\" }}\n            style={{padding: 10}}/>\n        <Tabs\n        orientation=\"vertical\"\n        variant=\"scrollable\"\n        value={value}\n        onChange={handleChange}\n        aria-label=\"Main app tabs\"\n        sx={{ borderRight: 1, borderColor: 'divider'}}\n        >\n            <Tab label=\"Session\" {...a11yProps(0)} />\n            <Tab label=\"Plotting\" {...a11yProps(1)} />\n            <Tab label=\"Sisl docs\" {...a11yProps(2)} />\n        </Tabs>\n    </Box>\n    <TabPanel value={value} index={0}>\n    <Settings/>\n    </TabPanel>\n    <TabPanel value={value} index={1}>\n    <Plots/>\n    </TabPanel>\n    <TabPanel value={value} index={2}>\n    <SislDocs/>\n    </TabPanel>\n    <ToastContainer/>\n    </Box>\n  );\n}","import { Component } from 'react'\nimport { connect } from 'react-redux'\nimport PythonApi from '../apis/PythonApi'\nimport {\n    addPlots, setNewStructures, setActiveTab, setActivePlot,\n    setSessionTabs, setCurrentSession, setNewPlotables, setActivePage\n} from \"../redux/actions\"\n\nclass Syncronizer extends Component {\n\n    constructor(props){\n        super(props)\n\n        document.addEventListener(\"syncWithSession\", (e) => this.syncWithSession(e.detail.session) )\n\n        document.addEventListener(\"updateTabs\", () => this.syncWithSession())\n\n        // document.addEventListener(\"loadingPlot\", (e) => {\n        //     this.setState({ loadingPlots: [...this.state.loadingPlots, e.detail.plot_id] })\n        // })\n\n        document.addEventListener(\"plot\", (e) => {\n            const plot = e.detail.plot\n            props.addPlots({ [plot.id]: plot })\n            // this.setState({ loadingPlots: this.state.loadingPlots.filter(id => id !== plot.id) })\n        })\n\n        document.addEventListener(\"newPlot\", () => this.syncWithSession())\n\n        document.addEventListener(\"sessionUpdate\", (e) => {\n            e.detail.justUpdated.forEach( plotID => {\n                \n                PythonApi.getPlot(plotID)\n\n            })\n\n        })\n            \n    }\n\n    syncWithSession = (session) => {\n\n        if (!session) {\n            return PythonApi.askForSession()\n        }\n        \n        this.props.setCurrentSession(session)\n        \n    }\n\n    render() {\n        return null\n    }\n}\n\nconst mapStateToProps = state => ({\n    plots: state.plots,\n    structures: state.session.structures,\n    tabs: state.session.tabs,\n    active: state.active,\n    session: state.session\n})\n\nconst mapDispatchToProps = {\n    setCurrentSession,\n    setActiveTab,\n    setSessionTabs,\n    setActivePlot,\n    addPlots,\n    setNewStructures,\n    setNewPlotables,\n    setActivePage\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Syncronizer);\n","import React from 'react';\nimport './App.css';\nimport \"./styles/main.scss\";\n\n\n//--Redux\nimport getStoreAndPersistor from './redux/store'\nimport { Provider } from 'react-redux'\nimport { PersistGate } from 'redux-persist/integration/react'\nimport MainPage from './pages/MainPage';\nimport Syncronizer from './pages/Syncronizer';\n\nconst {store, persistor} = getStoreAndPersistor()\n\nfunction App() {\n  return (\n    <Provider store={store}>\n      <PersistGate persistor={persistor}>\n        <Syncronizer/>\n        <div className=\"App\" style={{display: \"flex\", flexDirection: \"column\"}}>\n          <div className = \"appContent\" style={{height: \"100vh\"}}>\n            <MainPage/>\n          </div>   \n        </div>\n      </PersistGate>\n    </Provider>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}