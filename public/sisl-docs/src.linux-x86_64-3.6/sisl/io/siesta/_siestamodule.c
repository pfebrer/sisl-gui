/* File: _siestamodule.c
 * This file is auto-generated with f2py (version:2).
 * f2py is a Fortran to Python Interface Generator (FPIG), Second Edition,
 * written by Pearu Peterson <pearu@cens.ioc.ee>.
 * Generation date: Thu Sep 17 00:49:23 2020
 * Do not edit this file directly unless you know what you are doing!!!
 */

#ifdef __cplusplus
extern "C" {
#endif

/*********************** See f2py2e/cfuncs.py: includes ***********************/
#include "Python.h"
#include <stdarg.h>
#include "fortranobject.h"
#include <string.h>
#include <math.h>

/**************** See f2py2e/rules.py: mod_rules['modulebody'] ****************/
static PyObject *_siesta_error;
static PyObject *_siesta_module;

/*********************** See f2py2e/cfuncs.py: typedefs ***********************/
typedef signed char signed_char;
typedef char * string;
typedef struct {double r,i;} complex_double;
typedef struct {float r,i;} complex_float;

/****************** See f2py2e/cfuncs.py: typedefs_generated ******************/
/*need_typedefs_generated*/

/********************** See f2py2e/cfuncs.py: cppmacros **********************/
#define PRINTPYOBJERR(obj)\
    fprintf(stderr,"_siesta.error is related to ");\
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");

#define pyobj_from_int1(v) (PyInt_FromLong(v))
\
#define FAILNULL(p) do {                                            \
    if ((p) == NULL) {                                              \
        PyErr_SetString(PyExc_MemoryError, "NULL pointer found");   \
        goto capi_fail;                                             \
    }                                                               \
} while (0)

#define STRINGMALLOC(str,len)\
    if ((str = (string)malloc(sizeof(char)*(len+1))) == NULL) {\
        PyErr_SetString(PyExc_MemoryError, "out of memory");\
        goto capi_fail;\
    } else {\
        (str)[len] = '\0';\
    }

#if defined(PREPEND_FORTRAN)
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F
#else
#define F_FUNC(f,F) _##f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) _##F##_
#else
#define F_FUNC(f,F) _##f##_
#endif
#endif
#else
#if defined(NO_APPEND_FORTRAN)
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F
#else
#define F_FUNC(f,F) f
#endif
#else
#if defined(UPPERCASE_FORTRAN)
#define F_FUNC(f,F) F##_
#else
#define F_FUNC(f,F) f##_
#endif
#endif
#endif
#if defined(UNDERSCORE_G77)
#define F_FUNC_US(f,F) F_FUNC(f##_,F##_)
#else
#define F_FUNC_US(f,F) F_FUNC(f,F)
#endif

#define rank(var) var ## _Rank
#define shape(var,dim) var ## _Dims[dim]
#define old_rank(var) (PyArray_NDIM((PyArrayObject *)(capi_ ## var ## _tmp)))
#define old_shape(var,dim) PyArray_DIM(((PyArrayObject *)(capi_ ## var ## _tmp)),dim)
#define fshape(var,dim) shape(var,rank(var)-dim-1)
#define len(var) shape(var,0)
#define flen(var) fshape(var,0)
#define old_size(var) PyArray_SIZE((PyArrayObject *)(capi_ ## var ## _tmp))
/* #define index(i) capi_i ## i */
#define slen(var) capi_ ## var ## _len
#define size(var, ...) f2py_size((PyArrayObject *)(capi_ ## var ## _tmp), ## __VA_ARGS__, -1)

#ifdef DEBUGCFUNCS
#define CFUNCSMESS(mess) fprintf(stderr,"debug-capi:"mess);
#define CFUNCSMESSPY(mess,obj) CFUNCSMESS(mess) \
    PyObject_Print((PyObject *)obj,stderr,Py_PRINT_RAW);\
    fprintf(stderr,"\n");
#else
#define CFUNCSMESS(mess)
#define CFUNCSMESSPY(mess,obj)
#endif

#ifndef max
#define max(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef min
#define min(a,b) ((a < b) ? (a) : (b))
#endif
#ifndef MAX
#define MAX(a,b) ((a > b) ? (a) : (b))
#endif
#ifndef MIN
#define MIN(a,b) ((a < b) ? (a) : (b))
#endif

#define STRINGFREE(str) do {if (!(str == NULL)) free(str);} while (0)

#define CHECKSCALAR(check,tcheck,name,show,var)\
    if (!(check)) {\
        char errstring[256];\
        sprintf(errstring, "%s: "show, "("tcheck") failed for "name, var);\
        PyErr_SetString(_siesta_error,errstring);\
        /*goto capi_fail;*/\
    } else 
#define pyobj_from_complex_double1(v) (PyComplex_FromDoubles(v.r,v.i))
/* New SciPy */
#define TRYPYARRAYTEMPLATECHAR case NPY_STRING: *(char *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATELONG case NPY_LONG: *(long *)(PyArray_DATA(arr))=*v; break;
#define TRYPYARRAYTEMPLATEOBJECT case NPY_OBJECT: PyArray_SETITEM(arr,PyArray_DATA(arr),pyobj_from_ ## ctype ## 1(*v)); break;

#define TRYPYARRAYTEMPLATE(ctype,typecode) \
        PyArrayObject *arr = NULL;\
        if (!obj) return -2;\
        if (!PyArray_Check(obj)) return -1;\
        if (!(arr=(PyArrayObject *)obj)) {fprintf(stderr,"TRYPYARRAYTEMPLATE:");PRINTPYOBJERR(obj);return 0;}\
        if (PyArray_DESCR(arr)->type==typecode)  {*(ctype *)(PyArray_DATA(arr))=*v; return 1;}\
        switch (PyArray_TYPE(arr)) {\
                case NPY_DOUBLE: *(double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_INT: *(int *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONG: *(long *)(PyArray_DATA(arr))=*v; break;\
                case NPY_FLOAT: *(float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CDOUBLE: *(double *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CFLOAT: *(float *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BOOL: *(npy_bool *)(PyArray_DATA(arr))=(*v!=0); break;\
                case NPY_UBYTE: *(unsigned char *)(PyArray_DATA(arr))=*v; break;\
                case NPY_BYTE: *(signed char *)(PyArray_DATA(arr))=*v; break;\
                case NPY_SHORT: *(short *)(PyArray_DATA(arr))=*v; break;\
                case NPY_USHORT: *(npy_ushort *)(PyArray_DATA(arr))=*v; break;\
                case NPY_UINT: *(npy_uint *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONG: *(npy_ulong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGLONG: *(npy_longlong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_ULONGLONG: *(npy_ulonglong *)(PyArray_DATA(arr))=*v; break;\
                case NPY_LONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_CLONGDOUBLE: *(npy_longdouble *)(PyArray_DATA(arr))=*v; break;\
                case NPY_OBJECT: PyArray_SETITEM(arr, PyArray_DATA(arr), pyobj_from_ ## ctype ## 1(*v)); break;\
        default: return -2;\
        };\
        return 1

#define STRINGCOPYN(to,from,buf_size)                           \
    do {                                                        \
        int _m = (buf_size);                                    \
        char *_to = (to);                                       \
        char *_from = (from);                                   \
        FAILNULL(_to); FAILNULL(_from);                         \
        (void)strncpy(_to, _from, sizeof(char)*_m);             \
        _to[_m-1] = '\0';                                      \
        /* Padding with spaces instead of nulls */              \
        for (_m -= 2; _m >= 0 && _to[_m] == '\0'; _m--) {      \
            _to[_m] = ' ';                                      \
        }                                                       \
    } while (0)


/************************ See f2py2e/cfuncs.py: cfuncs ************************/
static int f2py_size(PyArrayObject* var, ...)
{
  npy_int sz = 0;
  npy_int dim;
  npy_int rank;
  va_list argp;
  va_start(argp, var);
  dim = va_arg(argp, npy_int);
  if (dim==-1)
    {
      sz = PyArray_SIZE(var);
    }
  else
    {
      rank = PyArray_NDIM(var);
      if (dim>=1 && dim<=rank)
        sz = PyArray_DIM(var, dim-1);
      else
        fprintf(stderr, "f2py_size: 2nd argument value=%d fails to satisfy 1<=value<=%d. Result will be 0.\n", dim, rank);
    }
  va_end(argp);
  return sz;
}

static int int_from_pyobj(int* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyInt_Check(obj)) {
        *v = (int)PyInt_AS_LONG(obj);
        return 1;
    }
    tmp = PyNumber_Int(obj);
    if (tmp) {
        *v = PyInt_AS_LONG(tmp);
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (int_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = _siesta_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int string_from_pyobj(string *str,int *len,const string inistr,PyObject *obj,const char *errmess) {
    PyArrayObject *arr = NULL;
    PyObject *tmp = NULL;
#ifdef DEBUGCFUNCS
fprintf(stderr,"string_from_pyobj(str='%s',len=%d,inistr='%s',obj=%p)\n",(char*)str,*len,(char *)inistr,obj);
#endif
    if (obj == Py_None) {
        if (*len == -1)
            *len = strlen(inistr); /* Will this cause problems? */
        STRINGMALLOC(*str,*len);
        STRINGCOPYN(*str,inistr,*len+1);
        return 1;
    }
    if (PyArray_Check(obj)) {
        if ((arr = (PyArrayObject *)obj) == NULL)
            goto capi_fail;
        if (!ISCONTIGUOUS(arr)) {
            PyErr_SetString(PyExc_ValueError,"array object is non-contiguous.");
            goto capi_fail;
        }
        if (*len == -1)
            *len = (PyArray_ITEMSIZE(arr))*PyArray_SIZE(arr);
        STRINGMALLOC(*str,*len);
        STRINGCOPYN(*str,PyArray_DATA(arr),*len+1);
        return 1;
    }
    if (PyString_Check(obj)) {
        tmp = obj;
        Py_INCREF(tmp);
    }
#if PY_VERSION_HEX >= 0x03000000
    else if (PyUnicode_Check(obj)) {
        tmp = PyUnicode_AsASCIIString(obj);
    }
    else {
        PyObject *tmp2;
        tmp2 = PyObject_Str(obj);
        if (tmp2) {
            tmp = PyUnicode_AsASCIIString(tmp2);
            Py_DECREF(tmp2);
        }
        else {
            tmp = NULL;
        }
    }
#else
    else {
        tmp = PyObject_Str(obj);
    }
#endif
    if (tmp == NULL) goto capi_fail;
    if (*len == -1)
        *len = PyString_GET_SIZE(tmp);
    STRINGMALLOC(*str,*len);
    STRINGCOPYN(*str,PyString_AS_STRING(tmp),*len+1);
    Py_DECREF(tmp);
    return 1;
capi_fail:
    Py_XDECREF(tmp);
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = _siesta_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int double_from_pyobj(double* v,PyObject *obj,const char *errmess) {
    PyObject* tmp = NULL;
    if (PyFloat_Check(obj)) {
#ifdef __sgi
        *v = PyFloat_AsDouble(obj);
#else
        *v = PyFloat_AS_DOUBLE(obj);
#endif
        return 1;
    }
    tmp = PyNumber_Float(obj);
    if (tmp) {
#ifdef __sgi
        *v = PyFloat_AsDouble(tmp);
#else
        *v = PyFloat_AS_DOUBLE(tmp);
#endif
        Py_DECREF(tmp);
        return 1;
    }
    if (PyComplex_Check(obj))
        tmp = PyObject_GetAttrString(obj,"real");
    else if (PyString_Check(obj) || PyUnicode_Check(obj))
        /*pass*/;
    else if (PySequence_Check(obj))
        tmp = PySequence_GetItem(obj,0);
    if (tmp) {
        PyErr_Clear();
        if (double_from_pyobj(v,tmp,errmess)) {Py_DECREF(tmp); return 1;}
        Py_DECREF(tmp);
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL) err = _siesta_error;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int complex_double_from_pyobj(complex_double* v,PyObject *obj,const char *errmess) {
    Py_complex c;
    if (PyComplex_Check(obj)) {
        c=PyComplex_AsCComplex(obj);
        (*v).r=c.real, (*v).i=c.imag;
        return 1;
    }
    if (PyArray_IsScalar(obj, ComplexFloating)) {
        if (PyArray_IsScalar(obj, CFloat)) {
            npy_cfloat new;
            PyArray_ScalarAsCtype(obj, &new);
            (*v).r = (double)new.real;
            (*v).i = (double)new.imag;
        }
        else if (PyArray_IsScalar(obj, CLongDouble)) {
            npy_clongdouble new;
            PyArray_ScalarAsCtype(obj, &new);
            (*v).r = (double)new.real;
            (*v).i = (double)new.imag;
        }
        else { /* if (PyArray_IsScalar(obj, CDouble)) */
            PyArray_ScalarAsCtype(obj, v);
        }
        return 1;
    }
    if (PyArray_CheckScalar(obj)) { /* 0-dim array or still array scalar */
        PyObject *arr;
        if (PyArray_Check(obj)) {
            arr = PyArray_Cast((PyArrayObject *)obj, NPY_CDOUBLE);
        }
        else {
            arr = PyArray_FromScalar(obj, PyArray_DescrFromType(NPY_CDOUBLE));
        }
        if (arr==NULL) return 0;
        (*v).r = ((npy_cdouble *)PyArray_DATA(arr))->real;
        (*v).i = ((npy_cdouble *)PyArray_DATA(arr))->imag;
        return 1;
    }
    /* Python does not provide PyNumber_Complex function :-( */
    (*v).i=0.0;
    if (PyFloat_Check(obj)) {
#ifdef __sgi
        (*v).r = PyFloat_AsDouble(obj);
#else
        (*v).r = PyFloat_AS_DOUBLE(obj);
#endif
        return 1;
    }
    if (PyInt_Check(obj)) {
        (*v).r = (double)PyInt_AS_LONG(obj);
        return 1;
    }
    if (PyLong_Check(obj)) {
        (*v).r = PyLong_AsDouble(obj);
        return (!PyErr_Occurred());
    }
    if (PySequence_Check(obj) && !(PyString_Check(obj) || PyUnicode_Check(obj))) {
        PyObject *tmp = PySequence_GetItem(obj,0);
        if (tmp) {
            if (complex_double_from_pyobj(v,tmp,errmess)) {
                Py_DECREF(tmp);
                return 1;
            }
            Py_DECREF(tmp);
        }
    }
    {
        PyObject* err = PyErr_Occurred();
        if (err==NULL)
            err = PyExc_TypeError;
        PyErr_SetString(err,errmess);
    }
    return 0;
}

static int try_pyarr_from_int(PyObject* obj,int* v) {
    TRYPYARRAYTEMPLATE(int,'i');
}


/********************* See f2py2e/cfuncs.py: userincludes *********************/
/*need_userincludes*/

/********************* See f2py2e/capi_rules.py: usercode *********************/


/* See f2py2e/rules.py */
extern void F_FUNC_US(siesta_sc_off,SIESTA_SC_OFF)(int*,int*,int*,int*);
extern void F_FUNC_US(read_hsx_sizes,READ_HSX_SIZES)(string,int*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_hsx_hsx,READ_HSX_HSX)(string,int*,int*,int*,int*,int*,int*,int*,float*,float*,float*,size_t);
extern void F_FUNC_US(read_hsx_s,READ_HSX_S)(string,int*,int*,int*,int*,int*,int*,int*,float*,size_t);
extern void F_FUNC_US(write_hsx,WRITE_HSX)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,size_t);
extern void F_FUNC_US(read_dm_sizes,READ_DM_SIZES)(string,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_dm,READ_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t);
extern void F_FUNC_US(write_dm,WRITE_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t);
extern void F_FUNC_US(read_tshs_version,READ_TSHS_VERSION)(string,int*,size_t);
extern void F_FUNC_US(read_tshs_sizes,READ_TSHS_SIZES)(string,int*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_tshs_ef,READ_TSHS_EF)(string,double*,size_t);
extern void F_FUNC_US(read_tshs_cell,READ_TSHS_CELL)(string,int*,int*,double*,int*,size_t);
extern void F_FUNC_US(read_tshs_geom,READ_TSHS_GEOM)(string,int*,double*,int*,size_t);
extern void F_FUNC_US(read_tshs_hs,READ_TSHS_HS)(string,int*,int*,int*,int*,int*,double*,double*,size_t);
extern void F_FUNC_US(read_tshs_s,READ_TSHS_S)(string,int*,int*,int*,int*,double*,size_t);
extern void F_FUNC_US(write_tshs_hs,WRITE_TSHS_HS)(string,int*,int*,int*,int*,int*,int*,int*,double*,double*,int*,int*,int*,double*,double*,int*,size_t);
extern void F_FUNC_US(read_grid_sizes,READ_GRID_SIZES)(string,int*,int*,size_t);
extern void F_FUNC_US(read_grid_cell,READ_GRID_CELL)(string,double*,size_t);
extern void F_FUNC_US(read_grid,READ_GRID)(string,int*,int*,int*,int*,float*,size_t);
extern void F_FUNC_US(write_grid,WRITE_GRID)(string,int*,int*,int*,int*,double*,float*,size_t);
extern void F_FUNC_US(read_gf_sizes,READ_GF_SIZES)(int*,int*,int*,int*,int*);
extern void F_FUNC_US(read_gf_header,READ_GF_HEADER)(int*,int*,double*,int*,complex_double*);
extern void F_FUNC_US(read_gf_find,READ_GF_FIND)(int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*);
extern void F_FUNC_US(read_gf_hs,READ_GF_HS)(int*,int*,complex_double*,complex_double*);
extern void F_FUNC_US(read_gf_se,READ_GF_SE)(int*,int*,int*,complex_double*);
extern void F_FUNC_US(write_gf_header,WRITE_GF_HEADER)(int*,int*,double*,int*,int*,int*,int*,double*,int*,int*,int*,double*,int*,double*,double*,int*,complex_double*);
extern void F_FUNC_US(write_gf_hs,WRITE_GF_HS)(int*,int*,complex_double*,int*,complex_double*,complex_double*);
extern void F_FUNC_US(write_gf_se,WRITE_GF_SE)(int*,int*,int*,complex_double*,int*,complex_double*);
extern void F_FUNC_US(read_tsde_sizes,READ_TSDE_SIZES)(string,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_tsde_dm,READ_TSDE_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t);
extern void F_FUNC_US(read_tsde_ef,READ_TSDE_EF)(string,double*,size_t);
extern void F_FUNC_US(read_tsde_edm,READ_TSDE_EDM)(string,int*,int*,int*,int*,int*,int*,double*,size_t);
extern void F_FUNC_US(write_tsde_dm_edm,WRITE_TSDE_DM_EDM)(string,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t);
extern void F_FUNC_US(read_hs_header,READ_HS_HEADER)(string,int*,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_hs,READ_HS)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t);
extern void F_FUNC_US(read_wfsx_sizes,READ_WFSX_SIZES)(string,int*,int*,int*,int*,size_t);
extern void F_FUNC_US(read_wfsx_index_info,READ_WFSX_INDEX_INFO)(string,int*,int*,double*,double*,int*,size_t);
extern void F_FUNC_US(skip_wfsx_index,SKIP_WFSX_INDEX)(int*,int*,int*);
extern void F_FUNC_US(read_wfsx_index_check,READ_WFSX_INDEX_CHECK)(int*,int*,int*,int*,int*);
extern void F_FUNC_US(read_wfsx_index_1,READ_WFSX_INDEX_1)(string,int*,int*,int*,int*,int*,double*,float*,size_t);
extern void F_FUNC_US(read_wfsx_index_2,READ_WFSX_INDEX_2)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t);
extern void F_FUNC_US(read_wfsx_index_4,READ_WFSX_INDEX_4)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t);
/*eof externroutines*/

/******************** See f2py2e/capi_rules.py: usercode1 ********************/


/******************* See f2py2e/cb_rules.py: buildcallback *******************/
/*need_callbacks*/

/*********************** See f2py2e/rules.py: buildapi ***********************/

/******************************* siesta_sc_off *******************************/
static char doc_f2py_rout__siesta_siesta_sc_off[] = "\
isc = siesta_sc_off(nsa,nsb,nsc)\n\nWrapper for ``siesta_sc_off``.\
\n\nParameters\n----------\n"
"nsa : input int\n"
"nsb : input int\n"
"nsc : input int\n"
"\nReturns\n-------\n"
"isc : rank-2 array('i') with bounds (3,nsa*nsb*nsc)";
/* extern void F_FUNC_US(siesta_sc_off,SIESTA_SC_OFF)(int*,int*,int*,int*); */
static PyObject *f2py_rout__siesta_siesta_sc_off(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int nsa = 0;
  PyObject *nsa_capi = Py_None;
  int nsb = 0;
  PyObject *nsb_capi = Py_None;
  int nsc = 0;
  PyObject *nsc_capi = Py_None;
  int *isc = NULL;
  npy_intp isc_Dims[2] = {-1, -1};
  const int isc_Rank = 2;
  PyArrayObject *capi_isc_tmp = NULL;
  int capi_isc_intent = 0;
  static char *capi_kwlist[] = {"nsa","nsb","nsc",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.siesta_sc_off",\
    capi_kwlist,&nsa_capi,&nsb_capi,&nsc_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable nsa */
    f2py_success = int_from_pyobj(&nsa,nsa_capi,"_siesta.siesta_sc_off() 1st argument (nsa) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsb */
    f2py_success = int_from_pyobj(&nsb,nsb_capi,"_siesta.siesta_sc_off() 2nd argument (nsb) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc */
    f2py_success = int_from_pyobj(&nsc,nsc_capi,"_siesta.siesta_sc_off() 3rd argument (nsc) can't be converted to int");
  if (f2py_success) {
  /* Processing variable isc */
  isc_Dims[0]=3,isc_Dims[1]=nsa*nsb*nsc;
  capi_isc_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_isc_tmp = array_from_pyobj(NPY_INT,isc_Dims,isc_Rank,capi_isc_intent,Py_None);
  if (capi_isc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `isc' of _siesta.siesta_sc_off to C/Fortran array" );
  } else {
    isc = (int *)(PyArray_DATA(capi_isc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&nsa,&nsb,&nsc,isc);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_isc_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_isc_tmp == NULL) ... else of isc*/
  /* End of cleaning variable isc */
  } /*if (f2py_success) of nsc*/
  /* End of cleaning variable nsc */
  } /*if (f2py_success) of nsb*/
  /* End of cleaning variable nsb */
  } /*if (f2py_success) of nsa*/
  /* End of cleaning variable nsa */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of siesta_sc_off ****************************/

/******************************* read_hsx_sizes *******************************/
static char doc_f2py_rout__siesta_read_hsx_sizes[] = "\
gamma,nspin,no_u,no_s,maxnh = read_hsx_sizes(fname)\n\nWrapper for ``read_hsx_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"gamma : int\n"
"nspin : int\n"
"no_u : int\n"
"no_s : int\n"
"maxnh : int";
/* extern void F_FUNC_US(read_hsx_sizes,READ_HSX_SIZES)(string,int*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_hsx_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  int nspin = 0;
  int no_u = 0;
  int no_s = 0;
  int maxnh = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_hsx_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_hsx_sizes to C string");
  if (f2py_success) {
  /* Processing variable gamma */
  /* Processing variable nspin */
  /* Processing variable no_u */
  /* Processing variable no_s */
  /* Processing variable maxnh */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&nspin,&no_u,&no_s,&maxnh,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiiii",gamma,nspin,no_u,no_s,maxnh);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable maxnh */
  /* End of cleaning variable no_s */
  /* End of cleaning variable no_u */
  /* End of cleaning variable nspin */
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_hsx_sizes ***************************/

/******************************** read_hsx_hsx ********************************/
static char doc_f2py_rout__siesta_read_hsx_hsx[] = "\
numh,listh,h,s,xij = read_hsx_hsx(fname,gamma,nspin,no_u,no_s,maxnh)\n\nWrapper for ``read_hsx_hsx``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"gamma : input int\n"
"nspin : input int\n"
"no_u : input int\n"
"no_s : input int\n"
"maxnh : input int\n"
"\nReturns\n-------\n"
"numh : rank-1 array('i') with bounds (no_u)\n"
"listh : rank-1 array('i') with bounds (maxnh)\n"
"h : rank-2 array('f') with bounds (maxnh,nspin)\n"
"s : rank-1 array('f') with bounds (maxnh)\n"
"xij : rank-2 array('f') with bounds (3,maxnh)";
/* extern void F_FUNC_US(read_hsx_hsx,READ_HSX_HSX)(string,int*,int*,int*,int*,int*,int*,int*,float*,float*,float*,size_t); */
static PyObject *f2py_rout__siesta_read_hsx_hsx(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,int*,float*,float*,float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  PyObject *gamma_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int no_s = 0;
  PyObject *no_s_capi = Py_None;
  int maxnh = 0;
  PyObject *maxnh_capi = Py_None;
  int *numh = NULL;
  npy_intp numh_Dims[1] = {-1};
  const int numh_Rank = 1;
  PyArrayObject *capi_numh_tmp = NULL;
  int capi_numh_intent = 0;
  int *listh = NULL;
  npy_intp listh_Dims[1] = {-1};
  const int listh_Rank = 1;
  PyArrayObject *capi_listh_tmp = NULL;
  int capi_listh_intent = 0;
  float *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  float *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  float *xij = NULL;
  npy_intp xij_Dims[2] = {-1, -1};
  const int xij_Rank = 2;
  PyArrayObject *capi_xij_tmp = NULL;
  int capi_xij_intent = 0;
  static char *capi_kwlist[] = {"fname","gamma","nspin","no_u","no_s","maxnh",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOO:_siesta.read_hsx_hsx",\
    capi_kwlist,&fname_capi,&gamma_capi,&nspin_capi,&no_u_capi,&no_s_capi,&maxnh_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_hsx_hsx to C string");
  if (f2py_success) {
  /* Processing variable gamma */
    gamma = (int)PyObject_IsTrue(gamma_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_hsx_hsx() 3rd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_hsx_hsx() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_s */
    f2py_success = int_from_pyobj(&no_s,no_s_capi,"_siesta.read_hsx_hsx() 5th argument (no_s) can't be converted to int");
  if (f2py_success) {
  /* Processing variable maxnh */
    f2py_success = int_from_pyobj(&maxnh,maxnh_capi,"_siesta.read_hsx_hsx() 6th argument (maxnh) can't be converted to int");
  if (f2py_success) {
  /* Processing variable numh */
  numh_Dims[0]=no_u;
  capi_numh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_numh_tmp = array_from_pyobj(NPY_INT,numh_Dims,numh_Rank,capi_numh_intent,Py_None);
  if (capi_numh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `numh' of _siesta.read_hsx_hsx to C/Fortran array" );
  } else {
    numh = (int *)(PyArray_DATA(capi_numh_tmp));

  /* Processing variable listh */
  listh_Dims[0]=maxnh;
  capi_listh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_listh_tmp = array_from_pyobj(NPY_INT,listh_Dims,listh_Rank,capi_listh_intent,Py_None);
  if (capi_listh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `listh' of _siesta.read_hsx_hsx to C/Fortran array" );
  } else {
    listh = (int *)(PyArray_DATA(capi_listh_tmp));

  /* Processing variable h */
  h_Dims[0]=maxnh,h_Dims[1]=nspin;
  capi_h_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_h_tmp = array_from_pyobj(NPY_FLOAT,h_Dims,h_Rank,capi_h_intent,Py_None);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `h' of _siesta.read_hsx_hsx to C/Fortran array" );
  } else {
    h = (float *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=maxnh;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_FLOAT,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_hsx_hsx to C/Fortran array" );
  } else {
    s = (float *)(PyArray_DATA(capi_s_tmp));

  /* Processing variable xij */
  xij_Dims[0]=3,xij_Dims[1]=maxnh;
  capi_xij_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_xij_tmp = array_from_pyobj(NPY_FLOAT,xij_Dims,xij_Rank,capi_xij_intent,Py_None);
  if (capi_xij_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `xij' of _siesta.read_hsx_hsx to C/Fortran array" );
  } else {
    xij = (float *)(PyArray_DATA(capi_xij_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&nspin,&no_u,&no_s,&maxnh,numh,listh,h,s,xij,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNNNN",capi_numh_tmp,capi_listh_tmp,capi_h_tmp,capi_s_tmp,capi_xij_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_xij_tmp == NULL) ... else of xij*/
  /* End of cleaning variable xij */
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  }  /*if (capi_listh_tmp == NULL) ... else of listh*/
  /* End of cleaning variable listh */
  }  /*if (capi_numh_tmp == NULL) ... else of numh*/
  /* End of cleaning variable numh */
  } /*if (f2py_success) of maxnh*/
  /* End of cleaning variable maxnh */
  } /*if (f2py_success) of no_s*/
  /* End of cleaning variable no_s */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of gamma*/
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_hsx_hsx ****************************/

/********************************* read_hsx_s *********************************/
static char doc_f2py_rout__siesta_read_hsx_s[] = "\
numh,listh,s = read_hsx_s(fname,gamma,nspin,no_u,no_s,maxnh)\n\nWrapper for ``read_hsx_s``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"gamma : input int\n"
"nspin : input int\n"
"no_u : input int\n"
"no_s : input int\n"
"maxnh : input int\n"
"\nReturns\n-------\n"
"numh : rank-1 array('i') with bounds (no_u)\n"
"listh : rank-1 array('i') with bounds (maxnh)\n"
"s : rank-1 array('f') with bounds (maxnh)";
/* extern void F_FUNC_US(read_hsx_s,READ_HSX_S)(string,int*,int*,int*,int*,int*,int*,int*,float*,size_t); */
static PyObject *f2py_rout__siesta_read_hsx_s(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,int*,float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  PyObject *gamma_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int no_s = 0;
  PyObject *no_s_capi = Py_None;
  int maxnh = 0;
  PyObject *maxnh_capi = Py_None;
  int *numh = NULL;
  npy_intp numh_Dims[1] = {-1};
  const int numh_Rank = 1;
  PyArrayObject *capi_numh_tmp = NULL;
  int capi_numh_intent = 0;
  int *listh = NULL;
  npy_intp listh_Dims[1] = {-1};
  const int listh_Rank = 1;
  PyArrayObject *capi_listh_tmp = NULL;
  int capi_listh_intent = 0;
  float *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  static char *capi_kwlist[] = {"fname","gamma","nspin","no_u","no_s","maxnh",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOO:_siesta.read_hsx_s",\
    capi_kwlist,&fname_capi,&gamma_capi,&nspin_capi,&no_u_capi,&no_s_capi,&maxnh_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_hsx_s to C string");
  if (f2py_success) {
  /* Processing variable gamma */
    gamma = (int)PyObject_IsTrue(gamma_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_hsx_s() 3rd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_hsx_s() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_s */
    f2py_success = int_from_pyobj(&no_s,no_s_capi,"_siesta.read_hsx_s() 5th argument (no_s) can't be converted to int");
  if (f2py_success) {
  /* Processing variable maxnh */
    f2py_success = int_from_pyobj(&maxnh,maxnh_capi,"_siesta.read_hsx_s() 6th argument (maxnh) can't be converted to int");
  if (f2py_success) {
  /* Processing variable numh */
  numh_Dims[0]=no_u;
  capi_numh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_numh_tmp = array_from_pyobj(NPY_INT,numh_Dims,numh_Rank,capi_numh_intent,Py_None);
  if (capi_numh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `numh' of _siesta.read_hsx_s to C/Fortran array" );
  } else {
    numh = (int *)(PyArray_DATA(capi_numh_tmp));

  /* Processing variable listh */
  listh_Dims[0]=maxnh;
  capi_listh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_listh_tmp = array_from_pyobj(NPY_INT,listh_Dims,listh_Rank,capi_listh_intent,Py_None);
  if (capi_listh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `listh' of _siesta.read_hsx_s to C/Fortran array" );
  } else {
    listh = (int *)(PyArray_DATA(capi_listh_tmp));

  /* Processing variable s */
  s_Dims[0]=maxnh;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_FLOAT,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_hsx_s to C/Fortran array" );
  } else {
    s = (float *)(PyArray_DATA(capi_s_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&nspin,&no_u,&no_s,&maxnh,numh,listh,s,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_numh_tmp,capi_listh_tmp,capi_s_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_listh_tmp == NULL) ... else of listh*/
  /* End of cleaning variable listh */
  }  /*if (capi_numh_tmp == NULL) ... else of numh*/
  /* End of cleaning variable numh */
  } /*if (f2py_success) of maxnh*/
  /* End of cleaning variable maxnh */
  } /*if (f2py_success) of no_s*/
  /* End of cleaning variable no_s */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of gamma*/
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of read_hsx_s *****************************/

/********************************* write_hsx *********************************/
static char doc_f2py_rout__siesta_write_hsx[] = "\
write_hsx(fname,gamma,no_s,numh,listhptr,listh,h,s,xij,qtot,temp,[no_u,nspin,maxnh])\n\nWrapper for ``write_hsx``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"gamma : input int\n"
"no_s : input int\n"
"numh : input rank-1 array('i') with bounds (no_u)\n"
"listhptr : input rank-1 array('i') with bounds (no_u)\n"
"listh : input rank-1 array('i') with bounds (maxnh)\n"
"h : input rank-2 array('d') with bounds (maxnh,nspin)\n"
"s : input rank-1 array('d') with bounds (maxnh)\n"
"xij : input rank-2 array('d') with bounds (3,maxnh)\n"
"qtot : input float\n"
"temp : input float\n"
"\nOther Parameters\n----------------\n"
"no_u : input int, optional\n    Default: len(numh)\n"
"nspin : input int, optional\n    Default: shape(h,1)\n"
"maxnh : input int, optional\n    Default: len(listh)";
/* extern void F_FUNC_US(write_hsx,WRITE_HSX)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,size_t); */
static PyObject *f2py_rout__siesta_write_hsx(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,double*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  PyObject *gamma_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int no_s = 0;
  PyObject *no_s_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int maxnh = 0;
  PyObject *maxnh_capi = Py_None;
  int *numh = NULL;
  npy_intp numh_Dims[1] = {-1};
  const int numh_Rank = 1;
  PyArrayObject *capi_numh_tmp = NULL;
  int capi_numh_intent = 0;
  PyObject *numh_capi = Py_None;
  int *listhptr = NULL;
  npy_intp listhptr_Dims[1] = {-1};
  const int listhptr_Rank = 1;
  PyArrayObject *capi_listhptr_tmp = NULL;
  int capi_listhptr_intent = 0;
  PyObject *listhptr_capi = Py_None;
  int *listh = NULL;
  npy_intp listh_Dims[1] = {-1};
  const int listh_Rank = 1;
  PyArrayObject *capi_listh_tmp = NULL;
  int capi_listh_intent = 0;
  PyObject *listh_capi = Py_None;
  double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  PyObject *h_capi = Py_None;
  double *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  PyObject *s_capi = Py_None;
  double *xij = NULL;
  npy_intp xij_Dims[2] = {-1, -1};
  const int xij_Rank = 2;
  PyArrayObject *capi_xij_tmp = NULL;
  int capi_xij_intent = 0;
  PyObject *xij_capi = Py_None;
  double qtot = 0;
  PyObject *qtot_capi = Py_None;
  double temp = 0;
  PyObject *temp_capi = Py_None;
  static char *capi_kwlist[] = {"fname","gamma","no_s","numh","listhptr","listh","h","s","xij","qtot","temp","no_u","nspin","maxnh",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOO|OOO:_siesta.write_hsx",\
    capi_kwlist,&fname_capi,&gamma_capi,&no_s_capi,&numh_capi,&listhptr_capi,&listh_capi,&h_capi,&s_capi,&xij_capi,&qtot_capi,&temp_capi,&no_u_capi,&nspin_capi,&maxnh_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.write_hsx to C string");
  if (f2py_success) {
  /* Processing variable gamma */
    gamma = (int)PyObject_IsTrue(gamma_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable no_s */
    f2py_success = int_from_pyobj(&no_s,no_s_capi,"_siesta.write_hsx() 3rd argument (no_s) can't be converted to int");
  if (f2py_success) {
  /* Processing variable listh */
  ;
  capi_listh_intent |= F2PY_INTENT_IN;
  capi_listh_tmp = array_from_pyobj(NPY_INT,listh_Dims,listh_Rank,capi_listh_intent,listh_capi);
  if (capi_listh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 6th argument `listh' of _siesta.write_hsx to C/Fortran array" );
  } else {
    listh = (int *)(PyArray_DATA(capi_listh_tmp));

  /* Processing variable numh */
  ;
  capi_numh_intent |= F2PY_INTENT_IN;
  capi_numh_tmp = array_from_pyobj(NPY_INT,numh_Dims,numh_Rank,capi_numh_intent,numh_capi);
  if (capi_numh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `numh' of _siesta.write_hsx to C/Fortran array" );
  } else {
    numh = (int *)(PyArray_DATA(capi_numh_tmp));

  /* Processing variable qtot */
    f2py_success = double_from_pyobj(&qtot,qtot_capi,"_siesta.write_hsx() 10th argument (qtot) can't be converted to double");
  if (f2py_success) {
  /* Processing variable temp */
    f2py_success = double_from_pyobj(&temp,temp_capi,"_siesta.write_hsx() 11st argument (temp) can't be converted to double");
  if (f2py_success) {
  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = len(numh); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_hsx() 1st keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(numh)>=no_u,"len(numh)>=no_u","1st keyword no_u","write_hsx:no_u=%d",no_u) {
  /* Processing variable maxnh */
  if (maxnh_capi == Py_None) maxnh = len(listh); else
    f2py_success = int_from_pyobj(&maxnh,maxnh_capi,"_siesta.write_hsx() 3rd keyword (maxnh) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(listh)>=maxnh,"len(listh)>=maxnh","3rd keyword maxnh","write_hsx:maxnh=%d",maxnh) {
  /* Processing variable listhptr */
  listhptr_Dims[0]=no_u;
  capi_listhptr_intent |= F2PY_INTENT_IN;
  capi_listhptr_tmp = array_from_pyobj(NPY_INT,listhptr_Dims,listhptr_Rank,capi_listhptr_intent,listhptr_capi);
  if (capi_listhptr_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `listhptr' of _siesta.write_hsx to C/Fortran array" );
  } else {
    listhptr = (int *)(PyArray_DATA(capi_listhptr_tmp));

  /* Processing variable h */
  h_Dims[0]=maxnh;
  capi_h_intent |= F2PY_INTENT_IN;
  capi_h_tmp = array_from_pyobj(NPY_DOUBLE,h_Dims,h_Rank,capi_h_intent,h_capi);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 7th argument `h' of _siesta.write_hsx to C/Fortran array" );
  } else {
    h = (double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=maxnh;
  capi_s_intent |= F2PY_INTENT_IN;
  capi_s_tmp = array_from_pyobj(NPY_DOUBLE,s_Dims,s_Rank,capi_s_intent,s_capi);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 8th argument `s' of _siesta.write_hsx to C/Fortran array" );
  } else {
    s = (double *)(PyArray_DATA(capi_s_tmp));

  /* Processing variable xij */
  xij_Dims[0]=3,xij_Dims[1]=maxnh;
  capi_xij_intent |= F2PY_INTENT_IN;
  capi_xij_tmp = array_from_pyobj(NPY_DOUBLE,xij_Dims,xij_Rank,capi_xij_intent,xij_capi);
  if (capi_xij_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 9th argument `xij' of _siesta.write_hsx to C/Fortran array" );
  } else {
    xij = (double *)(PyArray_DATA(capi_xij_tmp));

  /* Processing variable nspin */
  if (nspin_capi == Py_None) nspin = shape(h,1); else
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_hsx() 2nd keyword (nspin) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(h,1)==nspin,"shape(h,1)==nspin","2nd keyword nspin","write_hsx:nspin=%d",nspin) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&no_u,&no_s,&nspin,&maxnh,numh,listhptr,listh,h,s,xij,&qtot,&temp,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(shape(h,1)==nspin)*/
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  if((PyObject *)capi_xij_tmp!=xij_capi) {
    Py_XDECREF(capi_xij_tmp); }
  }  /*if (capi_xij_tmp == NULL) ... else of xij*/
  /* End of cleaning variable xij */
  if((PyObject *)capi_s_tmp!=s_capi) {
    Py_XDECREF(capi_s_tmp); }
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  if((PyObject *)capi_h_tmp!=h_capi) {
    Py_XDECREF(capi_h_tmp); }
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  if((PyObject *)capi_listhptr_tmp!=listhptr_capi) {
    Py_XDECREF(capi_listhptr_tmp); }
  }  /*if (capi_listhptr_tmp == NULL) ... else of listhptr*/
  /* End of cleaning variable listhptr */
  } /*CHECKSCALAR(len(listh)>=maxnh)*/
  } /*if (f2py_success) of maxnh*/
  /* End of cleaning variable maxnh */
  } /*CHECKSCALAR(len(numh)>=no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of temp*/
  /* End of cleaning variable temp */
  } /*if (f2py_success) of qtot*/
  /* End of cleaning variable qtot */
  if((PyObject *)capi_numh_tmp!=numh_capi) {
    Py_XDECREF(capi_numh_tmp); }
  }  /*if (capi_numh_tmp == NULL) ... else of numh*/
  /* End of cleaning variable numh */
  if((PyObject *)capi_listh_tmp!=listh_capi) {
    Py_XDECREF(capi_listh_tmp); }
  }  /*if (capi_listh_tmp == NULL) ... else of listh*/
  /* End of cleaning variable listh */
  } /*if (f2py_success) of no_s*/
  /* End of cleaning variable no_s */
  } /*if (f2py_success) of gamma*/
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of write_hsx ******************************/

/******************************* read_dm_sizes *******************************/
static char doc_f2py_rout__siesta_read_dm_sizes[] = "\
nspin,no_u,nsc,nnz = read_dm_sizes(fname)\n\nWrapper for ``read_dm_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"nspin : int\n"
"no_u : int\n"
"nsc : rank-1 array('i') with bounds (3)\n"
"nnz : int";
/* extern void F_FUNC_US(read_dm_sizes,READ_DM_SIZES)(string,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_dm_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  int no_u = 0;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  int nnz = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_dm_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_dm_sizes to C string");
  if (f2py_success) {
  /* Processing variable nspin */
  /* Processing variable no_u */
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,Py_None);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `nsc' of _siesta.read_dm_sizes to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable nnz */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiNi",nspin,no_u,capi_nsc_tmp,nnz);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable nnz */
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  /* End of cleaning variable no_u */
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_dm_sizes ****************************/

/********************************** read_dm **********************************/
static char doc_f2py_rout__siesta_read_dm[] = "\
ncol,list_col,dm = read_dm(fname,nspin,no_u,nsc,nnz)\n\nWrapper for ``read_dm``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"no_u : input int\n"
"nsc : input rank-1 array('i') with bounds (3)\n"
"nnz : input int\n"
"\nReturns\n-------\n"
"ncol : rank-1 array('i') with bounds (no_u)\n"
"list_col : rank-1 array('i') with bounds (nnz)\n"
"dm : rank-2 array('d') with bounds (nnz,nspin)";
/* extern void F_FUNC_US(read_dm,READ_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_dm(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  PyObject *nsc_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  double *dm = NULL;
  npy_intp dm_Dims[2] = {-1, -1};
  const int dm_Rank = 2;
  PyArrayObject *capi_dm_tmp = NULL;
  int capi_dm_intent = 0;
  static char *capi_kwlist[] = {"fname","nspin","no_u","nsc","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_dm",\
    capi_kwlist,&fname_capi,&nspin_capi,&no_u_capi,&nsc_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_dm to C string");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_dm() 3rd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_dm() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_IN;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,nsc_capi);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `nsc' of _siesta.read_dm to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable nnz */
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.read_dm() 5th argument (nnz) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ncol */
  ncol_Dims[0]=no_u;
  capi_ncol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,Py_None);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `ncol' of _siesta.read_dm to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  list_col_Dims[0]=nnz;
  capi_list_col_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,Py_None);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `list_col' of _siesta.read_dm to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable dm */
  dm_Dims[0]=nnz,dm_Dims[1]=nspin;
  capi_dm_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_dm_tmp = array_from_pyobj(NPY_DOUBLE,dm_Dims,dm_Rank,capi_dm_intent,Py_None);
  if (capi_dm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `dm' of _siesta.read_dm to C/Fortran array" );
  } else {
    dm = (double *)(PyArray_DATA(capi_dm_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,ncol,list_col,dm,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_ncol_tmp,capi_list_col_tmp,capi_dm_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_dm_tmp == NULL) ... else of dm*/
  /* End of cleaning variable dm */
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  if((PyObject *)capi_nsc_tmp!=nsc_capi) {
    Py_XDECREF(capi_nsc_tmp); }
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of read_dm *******************************/

/********************************** write_dm **********************************/
static char doc_f2py_rout__siesta_write_dm[] = "\
write_dm(fname,nsc,ncol,list_col,dm,[nspin,no_u,nnz])\n\nWrapper for ``write_dm``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nsc : input rank-1 array('i') with bounds (3)\n"
"ncol : input rank-1 array('i') with bounds (no_u)\n"
"list_col : input rank-1 array('i') with bounds (nnz)\n"
"dm : input rank-2 array('d') with bounds (nnz,nspin)\n"
"\nOther Parameters\n----------------\n"
"nspin : input int, optional\n    Default: shape(dm,1)\n"
"no_u : input int, optional\n    Default: len(ncol)\n"
"nnz : input int, optional\n    Default: len(list_col)";
/* extern void F_FUNC_US(write_dm,WRITE_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t); */
static PyObject *f2py_rout__siesta_write_dm(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  PyObject *nsc_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  PyObject *ncol_capi = Py_None;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  PyObject *list_col_capi = Py_None;
  double *dm = NULL;
  npy_intp dm_Dims[2] = {-1, -1};
  const int dm_Rank = 2;
  PyArrayObject *capi_dm_tmp = NULL;
  int capi_dm_intent = 0;
  PyObject *dm_capi = Py_None;
  static char *capi_kwlist[] = {"fname","nsc","ncol","list_col","dm","nspin","no_u","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO|OOO:_siesta.write_dm",\
    capi_kwlist,&fname_capi,&nsc_capi,&ncol_capi,&list_col_capi,&dm_capi,&nspin_capi,&no_u_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.write_dm to C string");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_IN;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,nsc_capi);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 2nd argument `nsc' of _siesta.write_dm to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable ncol */
  ;
  capi_ncol_intent |= F2PY_INTENT_IN;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,ncol_capi);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 3rd argument `ncol' of _siesta.write_dm to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  ;
  capi_list_col_intent |= F2PY_INTENT_IN;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,list_col_capi);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `list_col' of _siesta.write_dm to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = len(ncol); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_dm() 2nd keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(ncol)>=no_u,"len(ncol)>=no_u","2nd keyword no_u","write_dm:no_u=%d",no_u) {
  /* Processing variable nnz */
  if (nnz_capi == Py_None) nnz = len(list_col); else
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.write_dm() 3rd keyword (nnz) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(list_col)>=nnz,"len(list_col)>=nnz","3rd keyword nnz","write_dm:nnz=%d",nnz) {
  /* Processing variable dm */
  dm_Dims[0]=nnz;
  capi_dm_intent |= F2PY_INTENT_IN;
  capi_dm_tmp = array_from_pyobj(NPY_DOUBLE,dm_Dims,dm_Rank,capi_dm_intent,dm_capi);
  if (capi_dm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `dm' of _siesta.write_dm to C/Fortran array" );
  } else {
    dm = (double *)(PyArray_DATA(capi_dm_tmp));

  /* Processing variable nspin */
  if (nspin_capi == Py_None) nspin = shape(dm,1); else
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_dm() 1st keyword (nspin) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(dm,1)==nspin,"shape(dm,1)==nspin","1st keyword nspin","write_dm:nspin=%d",nspin) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,ncol,list_col,dm,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(shape(dm,1)==nspin)*/
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  if((PyObject *)capi_dm_tmp!=dm_capi) {
    Py_XDECREF(capi_dm_tmp); }
  }  /*if (capi_dm_tmp == NULL) ... else of dm*/
  /* End of cleaning variable dm */
  } /*CHECKSCALAR(len(list_col)>=nnz)*/
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  } /*CHECKSCALAR(len(ncol)>=no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  if((PyObject *)capi_list_col_tmp!=list_col_capi) {
    Py_XDECREF(capi_list_col_tmp); }
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  if((PyObject *)capi_ncol_tmp!=ncol_capi) {
    Py_XDECREF(capi_ncol_tmp); }
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  if((PyObject *)capi_nsc_tmp!=nsc_capi) {
    Py_XDECREF(capi_nsc_tmp); }
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of write_dm ******************************/

/***************************** read_tshs_version *****************************/
static char doc_f2py_rout__siesta_read_tshs_version[] = "\
version = read_tshs_version(fname)\n\nWrapper for ``read_tshs_version``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"version : int";
/* extern void F_FUNC_US(read_tshs_version,READ_TSHS_VERSION)(string,int*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_version(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int version = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_tshs_version",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_version to C string");
  if (f2py_success) {
  /* Processing variable version */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&version,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",version);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable version */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************** end of read_tshs_version **************************/

/****************************** read_tshs_sizes ******************************/
static char doc_f2py_rout__siesta_read_tshs_sizes[] = "\
nspin,na_u,no_u,n_s,nnz = read_tshs_sizes(fname)\n\nWrapper for ``read_tshs_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"nspin : int\n"
"na_u : int\n"
"no_u : int\n"
"n_s : int\n"
"nnz : int";
/* extern void F_FUNC_US(read_tshs_sizes,READ_TSHS_SIZES)(string,int*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  int na_u = 0;
  int no_u = 0;
  int n_s = 0;
  int nnz = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_tshs_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_sizes to C string");
  if (f2py_success) {
  /* Processing variable nspin */
  /* Processing variable na_u */
  /* Processing variable no_u */
  /* Processing variable n_s */
  /* Processing variable nnz */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&na_u,&no_u,&n_s,&nnz,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiiii",nspin,na_u,no_u,n_s,nnz);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable nnz */
  /* End of cleaning variable n_s */
  /* End of cleaning variable no_u */
  /* End of cleaning variable na_u */
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_tshs_sizes ***************************/

/******************************** read_tshs_ef ********************************/
static char doc_f2py_rout__siesta_read_tshs_ef[] = "\
ef = read_tshs_ef(fname)\n\nWrapper for ``read_tshs_ef``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"ef : float";
/* extern void F_FUNC_US(read_tshs_ef,READ_TSHS_EF)(string,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_ef(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  double ef = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_tshs_ef",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_ef to C string");
  if (f2py_success) {
  /* Processing variable ef */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ef,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",ef);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable ef */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_tshs_ef ****************************/

/******************************* read_tshs_cell *******************************/
static char doc_f2py_rout__siesta_read_tshs_cell[] = "\
nsc,cell,isc = read_tshs_cell(fname,n_s)\n\nWrapper for ``read_tshs_cell``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"n_s : input int\n"
"\nReturns\n-------\n"
"nsc : rank-1 array('i') with bounds (3)\n"
"cell : rank-2 array('d') with bounds (3,3)\n"
"isc : rank-2 array('i') with bounds (3,n_s)";
/* extern void F_FUNC_US(read_tshs_cell,READ_TSHS_CELL)(string,int*,int*,double*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_cell(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,double*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int n_s = 0;
  PyObject *n_s_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  double *cell = NULL;
  npy_intp cell_Dims[2] = {-1, -1};
  const int cell_Rank = 2;
  PyArrayObject *capi_cell_tmp = NULL;
  int capi_cell_intent = 0;
  int *isc = NULL;
  npy_intp isc_Dims[2] = {-1, -1};
  const int isc_Rank = 2;
  PyArrayObject *capi_isc_tmp = NULL;
  int capi_isc_intent = 0;
  static char *capi_kwlist[] = {"fname","n_s",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:_siesta.read_tshs_cell",\
    capi_kwlist,&fname_capi,&n_s_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_cell to C string");
  if (f2py_success) {
  /* Processing variable n_s */
    f2py_success = int_from_pyobj(&n_s,n_s_capi,"_siesta.read_tshs_cell() 2nd argument (n_s) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,Py_None);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `nsc' of _siesta.read_tshs_cell to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable cell */
  cell_Dims[0]=3,cell_Dims[1]=3;
  capi_cell_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_cell_tmp = array_from_pyobj(NPY_DOUBLE,cell_Dims,cell_Rank,capi_cell_intent,Py_None);
  if (capi_cell_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `cell' of _siesta.read_tshs_cell to C/Fortran array" );
  } else {
    cell = (double *)(PyArray_DATA(capi_cell_tmp));

  /* Processing variable isc */
  isc_Dims[0]=3,isc_Dims[1]=n_s;
  capi_isc_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_isc_tmp = array_from_pyobj(NPY_INT,isc_Dims,isc_Rank,capi_isc_intent,Py_None);
  if (capi_isc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `isc' of _siesta.read_tshs_cell to C/Fortran array" );
  } else {
    isc = (int *)(PyArray_DATA(capi_isc_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&n_s,nsc,cell,isc,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_nsc_tmp,capi_cell_tmp,capi_isc_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_isc_tmp == NULL) ... else of isc*/
  /* End of cleaning variable isc */
  }  /*if (capi_cell_tmp == NULL) ... else of cell*/
  /* End of cleaning variable cell */
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  } /*if (f2py_success) of n_s*/
  /* End of cleaning variable n_s */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_tshs_cell ***************************/

/******************************* read_tshs_geom *******************************/
static char doc_f2py_rout__siesta_read_tshs_geom[] = "\
xa,lasto = read_tshs_geom(fname,na_u)\n\nWrapper for ``read_tshs_geom``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"na_u : input int\n"
"\nReturns\n-------\n"
"xa : rank-2 array('d') with bounds (3,na_u)\n"
"lasto : rank-1 array('i') with bounds (na_u + 1)";
/* extern void F_FUNC_US(read_tshs_geom,READ_TSHS_GEOM)(string,int*,double*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_geom(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,double*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int na_u = 0;
  PyObject *na_u_capi = Py_None;
  double *xa = NULL;
  npy_intp xa_Dims[2] = {-1, -1};
  const int xa_Rank = 2;
  PyArrayObject *capi_xa_tmp = NULL;
  int capi_xa_intent = 0;
  int *lasto = NULL;
  npy_intp lasto_Dims[1] = {-1};
  const int lasto_Rank = 1;
  PyArrayObject *capi_lasto_tmp = NULL;
  int capi_lasto_intent = 0;
  static char *capi_kwlist[] = {"fname","na_u",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:_siesta.read_tshs_geom",\
    capi_kwlist,&fname_capi,&na_u_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_geom to C string");
  if (f2py_success) {
  /* Processing variable na_u */
    f2py_success = int_from_pyobj(&na_u,na_u_capi,"_siesta.read_tshs_geom() 2nd argument (na_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable xa */
  xa_Dims[0]=3,xa_Dims[1]=na_u;
  capi_xa_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_xa_tmp = array_from_pyobj(NPY_DOUBLE,xa_Dims,xa_Rank,capi_xa_intent,Py_None);
  if (capi_xa_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `xa' of _siesta.read_tshs_geom to C/Fortran array" );
  } else {
    xa = (double *)(PyArray_DATA(capi_xa_tmp));

  /* Processing variable lasto */
  lasto_Dims[0]=na_u + 1;
  capi_lasto_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_lasto_tmp = array_from_pyobj(NPY_INT,lasto_Dims,lasto_Rank,capi_lasto_intent,Py_None);
  if (capi_lasto_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `lasto' of _siesta.read_tshs_geom to C/Fortran array" );
  } else {
    lasto = (int *)(PyArray_DATA(capi_lasto_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&na_u,xa,lasto,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NN",capi_xa_tmp,capi_lasto_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_lasto_tmp == NULL) ... else of lasto*/
  /* End of cleaning variable lasto */
  }  /*if (capi_xa_tmp == NULL) ... else of xa*/
  /* End of cleaning variable xa */
  } /*if (f2py_success) of na_u*/
  /* End of cleaning variable na_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_tshs_geom ***************************/

/******************************** read_tshs_hs ********************************/
static char doc_f2py_rout__siesta_read_tshs_hs[] = "\
ncol,list_col,h,s = read_tshs_hs(fname,nspin,no_u,nnz)\n\nWrapper for ``read_tshs_hs``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"no_u : input int\n"
"nnz : input int\n"
"\nReturns\n-------\n"
"ncol : rank-1 array('i') with bounds (no_u)\n"
"list_col : rank-1 array('i') with bounds (nnz)\n"
"h : rank-2 array('d') with bounds (nnz,nspin)\n"
"s : rank-1 array('d') with bounds (nnz)";
/* extern void F_FUNC_US(read_tshs_hs,READ_TSHS_HS)(string,int*,int*,int*,int*,int*,double*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_hs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,double*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  double *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  static char *capi_kwlist[] = {"fname","nspin","no_u","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOO:_siesta.read_tshs_hs",\
    capi_kwlist,&fname_capi,&nspin_capi,&no_u_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_hs to C string");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_tshs_hs() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_tshs_hs() 3rd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nnz */
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.read_tshs_hs() 4th argument (nnz) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ncol */
  ncol_Dims[0]=no_u;
  capi_ncol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,Py_None);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `ncol' of _siesta.read_tshs_hs to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  list_col_Dims[0]=nnz;
  capi_list_col_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,Py_None);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `list_col' of _siesta.read_tshs_hs to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable h */
  h_Dims[0]=nnz,h_Dims[1]=nspin;
  capi_h_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_h_tmp = array_from_pyobj(NPY_DOUBLE,h_Dims,h_Rank,capi_h_intent,Py_None);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `h' of _siesta.read_tshs_hs to C/Fortran array" );
  } else {
    h = (double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=nnz;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_DOUBLE,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_tshs_hs to C/Fortran array" );
  } else {
    s = (double *)(PyArray_DATA(capi_s_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,&nnz,ncol,list_col,h,s,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNNN",capi_ncol_tmp,capi_list_col_tmp,capi_h_tmp,capi_s_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_tshs_hs ****************************/

/******************************** read_tshs_s ********************************/
static char doc_f2py_rout__siesta_read_tshs_s[] = "\
ncol,list_col,s = read_tshs_s(fname,no_u,nnz)\n\nWrapper for ``read_tshs_s``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"no_u : input int\n"
"nnz : input int\n"
"\nReturns\n-------\n"
"ncol : rank-1 array('i') with bounds (no_u)\n"
"list_col : rank-1 array('i') with bounds (nnz)\n"
"s : rank-1 array('d') with bounds (nnz)";
/* extern void F_FUNC_US(read_tshs_s,READ_TSHS_S)(string,int*,int*,int*,int*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tshs_s(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  double *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  static char *capi_kwlist[] = {"fname","no_u","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.read_tshs_s",\
    capi_kwlist,&fname_capi,&no_u_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tshs_s to C string");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_tshs_s() 2nd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nnz */
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.read_tshs_s() 3rd argument (nnz) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ncol */
  ncol_Dims[0]=no_u;
  capi_ncol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,Py_None);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `ncol' of _siesta.read_tshs_s to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  list_col_Dims[0]=nnz;
  capi_list_col_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,Py_None);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `list_col' of _siesta.read_tshs_s to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable s */
  s_Dims[0]=nnz;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_DOUBLE,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_tshs_s to C/Fortran array" );
  } else {
    s = (double *)(PyArray_DATA(capi_s_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&no_u,&nnz,ncol,list_col,s,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_ncol_tmp,capi_list_col_tmp,capi_s_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of read_tshs_s *****************************/

/******************************* write_tshs_hs *******************************/
static char doc_f2py_rout__siesta_write_tshs_hs[] = "\
write_tshs_hs(fname,nsc1,nsc2,nsc3,cell,xa,lasto,ncol,list_col,h,s,isc,[nspin,na_u,no_u,nnz])\n\nWrapper for ``write_tshs_hs``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nsc1 : input int\n"
"nsc2 : input int\n"
"nsc3 : input int\n"
"cell : input rank-2 array('d') with bounds (3,3)\n"
"xa : input rank-2 array('d') with bounds (3,na_u)\n"
"lasto : input rank-1 array('i') with bounds (na_u + 1)\n"
"ncol : input rank-1 array('i') with bounds (no_u)\n"
"list_col : input rank-1 array('i') with bounds (nnz)\n"
"h : input rank-2 array('d') with bounds (nnz,nspin)\n"
"s : input rank-1 array('d') with bounds (nnz)\n"
"isc : input rank-2 array('i') with bounds (3,nsc1*nsc2*nsc3)\n"
"\nOther Parameters\n----------------\n"
"nspin : input int, optional\n    Default: shape(h,1)\n"
"na_u : input int, optional\n    Default: shape(xa,1)\n"
"no_u : input int, optional\n    Default: len(ncol)\n"
"nnz : input int, optional\n    Default: len(list_col)";
/* extern void F_FUNC_US(write_tshs_hs,WRITE_TSHS_HS)(string,int*,int*,int*,int*,int*,int*,int*,double*,double*,int*,int*,int*,double*,double*,int*,size_t); */
static PyObject *f2py_rout__siesta_write_tshs_hs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,int*,double*,double*,int*,int*,int*,double*,double*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int na_u = 0;
  PyObject *na_u_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int nsc1 = 0;
  PyObject *nsc1_capi = Py_None;
  int nsc2 = 0;
  PyObject *nsc2_capi = Py_None;
  int nsc3 = 0;
  PyObject *nsc3_capi = Py_None;
  double *cell = NULL;
  npy_intp cell_Dims[2] = {-1, -1};
  const int cell_Rank = 2;
  PyArrayObject *capi_cell_tmp = NULL;
  int capi_cell_intent = 0;
  PyObject *cell_capi = Py_None;
  double *xa = NULL;
  npy_intp xa_Dims[2] = {-1, -1};
  const int xa_Rank = 2;
  PyArrayObject *capi_xa_tmp = NULL;
  int capi_xa_intent = 0;
  PyObject *xa_capi = Py_None;
  int *lasto = NULL;
  npy_intp lasto_Dims[1] = {-1};
  const int lasto_Rank = 1;
  PyArrayObject *capi_lasto_tmp = NULL;
  int capi_lasto_intent = 0;
  PyObject *lasto_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  PyObject *ncol_capi = Py_None;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  PyObject *list_col_capi = Py_None;
  double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  PyObject *h_capi = Py_None;
  double *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  PyObject *s_capi = Py_None;
  int *isc = NULL;
  npy_intp isc_Dims[2] = {-1, -1};
  const int isc_Rank = 2;
  PyArrayObject *capi_isc_tmp = NULL;
  int capi_isc_intent = 0;
  PyObject *isc_capi = Py_None;
  static char *capi_kwlist[] = {"fname","nsc1","nsc2","nsc3","cell","xa","lasto","ncol","list_col","h","s","isc","nspin","na_u","no_u","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOO|OOOO:_siesta.write_tshs_hs",\
    capi_kwlist,&fname_capi,&nsc1_capi,&nsc2_capi,&nsc3_capi,&cell_capi,&xa_capi,&lasto_capi,&ncol_capi,&list_col_capi,&h_capi,&s_capi,&isc_capi,&nspin_capi,&na_u_capi,&no_u_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.write_tshs_hs to C string");
  if (f2py_success) {
  /* Processing variable nsc1 */
    f2py_success = int_from_pyobj(&nsc1,nsc1_capi,"_siesta.write_tshs_hs() 2nd argument (nsc1) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc2 */
    f2py_success = int_from_pyobj(&nsc2,nsc2_capi,"_siesta.write_tshs_hs() 3rd argument (nsc2) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc3 */
    f2py_success = int_from_pyobj(&nsc3,nsc3_capi,"_siesta.write_tshs_hs() 4th argument (nsc3) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cell */
  cell_Dims[0]=3,cell_Dims[1]=3;
  capi_cell_intent |= F2PY_INTENT_IN;
  capi_cell_tmp = array_from_pyobj(NPY_DOUBLE,cell_Dims,cell_Rank,capi_cell_intent,cell_capi);
  if (capi_cell_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `cell' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    cell = (double *)(PyArray_DATA(capi_cell_tmp));

  /* Processing variable xa */
  xa_Dims[0]=3;
  capi_xa_intent |= F2PY_INTENT_IN;
  capi_xa_tmp = array_from_pyobj(NPY_DOUBLE,xa_Dims,xa_Rank,capi_xa_intent,xa_capi);
  if (capi_xa_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 6th argument `xa' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    xa = (double *)(PyArray_DATA(capi_xa_tmp));

  /* Processing variable ncol */
  ;
  capi_ncol_intent |= F2PY_INTENT_IN;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,ncol_capi);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 8th argument `ncol' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  ;
  capi_list_col_intent |= F2PY_INTENT_IN;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,list_col_capi);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 9th argument `list_col' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable na_u */
  if (na_u_capi == Py_None) na_u = shape(xa,1); else
    f2py_success = int_from_pyobj(&na_u,na_u_capi,"_siesta.write_tshs_hs() 2nd keyword (na_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(xa,1)==na_u,"shape(xa,1)==na_u","2nd keyword na_u","write_tshs_hs:na_u=%d",na_u) {
  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = len(ncol); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_tshs_hs() 3rd keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(ncol)>=no_u,"len(ncol)>=no_u","3rd keyword no_u","write_tshs_hs:no_u=%d",no_u) {
  /* Processing variable nnz */
  if (nnz_capi == Py_None) nnz = len(list_col); else
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.write_tshs_hs() 4th keyword (nnz) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(list_col)>=nnz,"len(list_col)>=nnz","4th keyword nnz","write_tshs_hs:nnz=%d",nnz) {
  /* Processing variable lasto */
  lasto_Dims[0]=na_u + 1;
  capi_lasto_intent |= F2PY_INTENT_IN;
  capi_lasto_tmp = array_from_pyobj(NPY_INT,lasto_Dims,lasto_Rank,capi_lasto_intent,lasto_capi);
  if (capi_lasto_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 7th argument `lasto' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    lasto = (int *)(PyArray_DATA(capi_lasto_tmp));

  /* Processing variable h */
  h_Dims[0]=nnz;
  capi_h_intent |= F2PY_INTENT_IN;
  capi_h_tmp = array_from_pyobj(NPY_DOUBLE,h_Dims,h_Rank,capi_h_intent,h_capi);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 10th argument `h' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    h = (double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=nnz;
  capi_s_intent |= F2PY_INTENT_IN;
  capi_s_tmp = array_from_pyobj(NPY_DOUBLE,s_Dims,s_Rank,capi_s_intent,s_capi);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 11st argument `s' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    s = (double *)(PyArray_DATA(capi_s_tmp));

  /* Processing variable isc */
  isc_Dims[0]=3,isc_Dims[1]=nsc1*nsc2*nsc3;
  capi_isc_intent |= F2PY_INTENT_IN;
  capi_isc_tmp = array_from_pyobj(NPY_INT,isc_Dims,isc_Rank,capi_isc_intent,isc_capi);
  if (capi_isc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 12nd argument `isc' of _siesta.write_tshs_hs to C/Fortran array" );
  } else {
    isc = (int *)(PyArray_DATA(capi_isc_tmp));

  /* Processing variable nspin */
  if (nspin_capi == Py_None) nspin = shape(h,1); else
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_tshs_hs() 1st keyword (nspin) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(h,1)==nspin,"shape(h,1)==nspin","1st keyword nspin","write_tshs_hs:nspin=%d",nspin) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&na_u,&no_u,&nnz,&nsc1,&nsc2,&nsc3,cell,xa,lasto,ncol,list_col,h,s,isc,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(shape(h,1)==nspin)*/
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  if((PyObject *)capi_isc_tmp!=isc_capi) {
    Py_XDECREF(capi_isc_tmp); }
  }  /*if (capi_isc_tmp == NULL) ... else of isc*/
  /* End of cleaning variable isc */
  if((PyObject *)capi_s_tmp!=s_capi) {
    Py_XDECREF(capi_s_tmp); }
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  if((PyObject *)capi_h_tmp!=h_capi) {
    Py_XDECREF(capi_h_tmp); }
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  if((PyObject *)capi_lasto_tmp!=lasto_capi) {
    Py_XDECREF(capi_lasto_tmp); }
  }  /*if (capi_lasto_tmp == NULL) ... else of lasto*/
  /* End of cleaning variable lasto */
  } /*CHECKSCALAR(len(list_col)>=nnz)*/
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  } /*CHECKSCALAR(len(ncol)>=no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*CHECKSCALAR(shape(xa,1)==na_u)*/
  } /*if (f2py_success) of na_u*/
  /* End of cleaning variable na_u */
  if((PyObject *)capi_list_col_tmp!=list_col_capi) {
    Py_XDECREF(capi_list_col_tmp); }
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  if((PyObject *)capi_ncol_tmp!=ncol_capi) {
    Py_XDECREF(capi_ncol_tmp); }
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  if((PyObject *)capi_xa_tmp!=xa_capi) {
    Py_XDECREF(capi_xa_tmp); }
  }  /*if (capi_xa_tmp == NULL) ... else of xa*/
  /* End of cleaning variable xa */
  if((PyObject *)capi_cell_tmp!=cell_capi) {
    Py_XDECREF(capi_cell_tmp); }
  }  /*if (capi_cell_tmp == NULL) ... else of cell*/
  /* End of cleaning variable cell */
  } /*if (f2py_success) of nsc3*/
  /* End of cleaning variable nsc3 */
  } /*if (f2py_success) of nsc2*/
  /* End of cleaning variable nsc2 */
  } /*if (f2py_success) of nsc1*/
  /* End of cleaning variable nsc1 */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of write_tshs_hs ****************************/

/****************************** read_grid_sizes ******************************/
static char doc_f2py_rout__siesta_read_grid_sizes[] = "\
nspin,mesh = read_grid_sizes(fname)\n\nWrapper for ``read_grid_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"nspin : int\n"
"mesh : rank-1 array('i') with bounds (3)";
/* extern void F_FUNC_US(read_grid_sizes,READ_GRID_SIZES)(string,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_grid_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  int *mesh = NULL;
  npy_intp mesh_Dims[1] = {-1};
  const int mesh_Rank = 1;
  PyArrayObject *capi_mesh_tmp = NULL;
  int capi_mesh_intent = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_grid_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_grid_sizes to C string");
  if (f2py_success) {
  /* Processing variable nspin */
  /* Processing variable mesh */
  mesh_Dims[0]=3;
  capi_mesh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_mesh_tmp = array_from_pyobj(NPY_INT,mesh_Dims,mesh_Rank,capi_mesh_intent,Py_None);
  if (capi_mesh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `mesh' of _siesta.read_grid_sizes to C/Fortran array" );
  } else {
    mesh = (int *)(PyArray_DATA(capi_mesh_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,mesh,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iN",nspin,capi_mesh_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_mesh_tmp == NULL) ... else of mesh*/
  /* End of cleaning variable mesh */
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_grid_sizes ***************************/

/******************************* read_grid_cell *******************************/
static char doc_f2py_rout__siesta_read_grid_cell[] = "\
cell = read_grid_cell(fname)\n\nWrapper for ``read_grid_cell``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"cell : rank-2 array('d') with bounds (3,3)";
/* extern void F_FUNC_US(read_grid_cell,READ_GRID_CELL)(string,double*,size_t); */
static PyObject *f2py_rout__siesta_read_grid_cell(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  double *cell = NULL;
  npy_intp cell_Dims[2] = {-1, -1};
  const int cell_Rank = 2;
  PyArrayObject *capi_cell_tmp = NULL;
  int capi_cell_intent = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_grid_cell",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_grid_cell to C string");
  if (f2py_success) {
  /* Processing variable cell */
  cell_Dims[0]=3,cell_Dims[1]=3;
  capi_cell_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_cell_tmp = array_from_pyobj(NPY_DOUBLE,cell_Dims,cell_Rank,capi_cell_intent,Py_None);
  if (capi_cell_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `cell' of _siesta.read_grid_cell to C/Fortran array" );
  } else {
    cell = (double *)(PyArray_DATA(capi_cell_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,cell,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_cell_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_cell_tmp == NULL) ... else of cell*/
  /* End of cleaning variable cell */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_grid_cell ***************************/

/********************************* read_grid *********************************/
static char doc_f2py_rout__siesta_read_grid[] = "\
grid = read_grid(fname,nspin,mesh1,mesh2,mesh3)\n\nWrapper for ``read_grid``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"mesh1 : input int\n"
"mesh2 : input int\n"
"mesh3 : input int\n"
"\nReturns\n-------\n"
"grid : rank-4 array('f') with bounds (mesh1,mesh2,mesh3,nspin)";
/* extern void F_FUNC_US(read_grid,READ_GRID)(string,int*,int*,int*,int*,float*,size_t); */
static PyObject *f2py_rout__siesta_read_grid(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int mesh1 = 0;
  PyObject *mesh1_capi = Py_None;
  int mesh2 = 0;
  PyObject *mesh2_capi = Py_None;
  int mesh3 = 0;
  PyObject *mesh3_capi = Py_None;
  float *grid = NULL;
  npy_intp grid_Dims[4] = {-1, -1, -1, -1};
  const int grid_Rank = 4;
  PyArrayObject *capi_grid_tmp = NULL;
  int capi_grid_intent = 0;
  static char *capi_kwlist[] = {"fname","nspin","mesh1","mesh2","mesh3",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_grid",\
    capi_kwlist,&fname_capi,&nspin_capi,&mesh1_capi,&mesh2_capi,&mesh3_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_grid to C string");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_grid() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable mesh1 */
    f2py_success = int_from_pyobj(&mesh1,mesh1_capi,"_siesta.read_grid() 3rd argument (mesh1) can't be converted to int");
  if (f2py_success) {
  /* Processing variable mesh2 */
    f2py_success = int_from_pyobj(&mesh2,mesh2_capi,"_siesta.read_grid() 4th argument (mesh2) can't be converted to int");
  if (f2py_success) {
  /* Processing variable mesh3 */
    f2py_success = int_from_pyobj(&mesh3,mesh3_capi,"_siesta.read_grid() 5th argument (mesh3) can't be converted to int");
  if (f2py_success) {
  /* Processing variable grid */
  grid_Dims[0]=mesh1,grid_Dims[1]=mesh2,grid_Dims[2]=mesh3,grid_Dims[3]=nspin;
  capi_grid_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_grid_tmp = array_from_pyobj(NPY_FLOAT,grid_Dims,grid_Rank,capi_grid_intent,Py_None);
  if (capi_grid_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `grid' of _siesta.read_grid to C/Fortran array" );
  } else {
    grid = (float *)(PyArray_DATA(capi_grid_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&mesh1,&mesh2,&mesh3,grid,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_grid_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_grid_tmp == NULL) ... else of grid*/
  /* End of cleaning variable grid */
  } /*if (f2py_success) of mesh3*/
  /* End of cleaning variable mesh3 */
  } /*if (f2py_success) of mesh2*/
  /* End of cleaning variable mesh2 */
  } /*if (f2py_success) of mesh1*/
  /* End of cleaning variable mesh1 */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of read_grid ******************************/

/********************************* write_grid *********************************/
static char doc_f2py_rout__siesta_write_grid[] = "\
write_grid(fname,nspin,cell,grid,[mesh1,mesh2,mesh3])\n\nWrapper for ``write_grid``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"cell : input rank-2 array('d') with bounds (3,3)\n"
"grid : input rank-3 array('f') with bounds (mesh1,mesh2,mesh3)\n"
"\nOther Parameters\n----------------\n"
"mesh1 : input int, optional\n    Default: shape(grid,0)\n"
"mesh2 : input int, optional\n    Default: shape(grid,1)\n"
"mesh3 : input int, optional\n    Default: shape(grid,2)";
/* extern void F_FUNC_US(write_grid,WRITE_GRID)(string,int*,int*,int*,int*,double*,float*,size_t); */
static PyObject *f2py_rout__siesta_write_grid(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,double*,float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int mesh1 = 0;
  PyObject *mesh1_capi = Py_None;
  int mesh2 = 0;
  PyObject *mesh2_capi = Py_None;
  int mesh3 = 0;
  PyObject *mesh3_capi = Py_None;
  double *cell = NULL;
  npy_intp cell_Dims[2] = {-1, -1};
  const int cell_Rank = 2;
  PyArrayObject *capi_cell_tmp = NULL;
  int capi_cell_intent = 0;
  PyObject *cell_capi = Py_None;
  float *grid = NULL;
  npy_intp grid_Dims[3] = {-1, -1, -1};
  const int grid_Rank = 3;
  PyArrayObject *capi_grid_tmp = NULL;
  int capi_grid_intent = 0;
  PyObject *grid_capi = Py_None;
  static char *capi_kwlist[] = {"fname","nspin","cell","grid","mesh1","mesh2","mesh3",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOO|OOO:_siesta.write_grid",\
    capi_kwlist,&fname_capi,&nspin_capi,&cell_capi,&grid_capi,&mesh1_capi,&mesh2_capi,&mesh3_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.write_grid to C string");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_grid() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cell */
  cell_Dims[0]=3,cell_Dims[1]=3;
  capi_cell_intent |= F2PY_INTENT_IN;
  capi_cell_tmp = array_from_pyobj(NPY_DOUBLE,cell_Dims,cell_Rank,capi_cell_intent,cell_capi);
  if (capi_cell_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 3rd argument `cell' of _siesta.write_grid to C/Fortran array" );
  } else {
    cell = (double *)(PyArray_DATA(capi_cell_tmp));

  /* Processing variable grid */
  ;
  capi_grid_intent |= F2PY_INTENT_IN;
  capi_grid_tmp = array_from_pyobj(NPY_FLOAT,grid_Dims,grid_Rank,capi_grid_intent,grid_capi);
  if (capi_grid_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `grid' of _siesta.write_grid to C/Fortran array" );
  } else {
    grid = (float *)(PyArray_DATA(capi_grid_tmp));

  /* Processing variable mesh1 */
  if (mesh1_capi == Py_None) mesh1 = shape(grid,0); else
    f2py_success = int_from_pyobj(&mesh1,mesh1_capi,"_siesta.write_grid() 1st keyword (mesh1) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(grid,0)==mesh1,"shape(grid,0)==mesh1","1st keyword mesh1","write_grid:mesh1=%d",mesh1) {
  /* Processing variable mesh2 */
  if (mesh2_capi == Py_None) mesh2 = shape(grid,1); else
    f2py_success = int_from_pyobj(&mesh2,mesh2_capi,"_siesta.write_grid() 2nd keyword (mesh2) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(grid,1)==mesh2,"shape(grid,1)==mesh2","2nd keyword mesh2","write_grid:mesh2=%d",mesh2) {
  /* Processing variable mesh3 */
  if (mesh3_capi == Py_None) mesh3 = shape(grid,2); else
    f2py_success = int_from_pyobj(&mesh3,mesh3_capi,"_siesta.write_grid() 3rd keyword (mesh3) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(grid,2)==mesh3,"shape(grid,2)==mesh3","3rd keyword mesh3","write_grid:mesh3=%d",mesh3) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&mesh1,&mesh2,&mesh3,cell,grid,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(shape(grid,2)==mesh3)*/
  } /*if (f2py_success) of mesh3*/
  /* End of cleaning variable mesh3 */
  } /*CHECKSCALAR(shape(grid,1)==mesh2)*/
  } /*if (f2py_success) of mesh2*/
  /* End of cleaning variable mesh2 */
  } /*CHECKSCALAR(shape(grid,0)==mesh1)*/
  } /*if (f2py_success) of mesh1*/
  /* End of cleaning variable mesh1 */
  if((PyObject *)capi_grid_tmp!=grid_capi) {
    Py_XDECREF(capi_grid_tmp); }
  }  /*if (capi_grid_tmp == NULL) ... else of grid*/
  /* End of cleaning variable grid */
  if((PyObject *)capi_cell_tmp!=cell_capi) {
    Py_XDECREF(capi_cell_tmp); }
  }  /*if (capi_cell_tmp == NULL) ... else of cell*/
  /* End of cleaning variable cell */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of write_grid *****************************/

/******************************* read_gf_sizes *******************************/
static char doc_f2py_rout__siesta_read_gf_sizes[] = "\
nspin,no_u,nkpt,ne = read_gf_sizes(iu)\n\nWrapper for ``read_gf_sizes``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"\nReturns\n-------\n"
"nspin : int\n"
"no_u : int\n"
"nkpt : int\n"
"ne : int";
/* extern void F_FUNC_US(read_gf_sizes,READ_GF_SIZES)(int*,int*,int*,int*,int*); */
static PyObject *f2py_rout__siesta_read_gf_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int nspin = 0;
  int no_u = 0;
  int nkpt = 0;
  int ne = 0;
  static char *capi_kwlist[] = {"iu",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_gf_sizes",\
    capi_kwlist,&iu_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_gf_sizes() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
  /* Processing variable no_u */
  /* Processing variable nkpt */
  /* Processing variable ne */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&nspin,&no_u,&nkpt,&ne);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiii",nspin,no_u,nkpt,ne);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable ne */
  /* End of cleaning variable nkpt */
  /* End of cleaning variable no_u */
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_gf_sizes ****************************/

/******************************* read_gf_header *******************************/
static char doc_f2py_rout__siesta_read_gf_header[] = "\
kpt,e = read_gf_header(iu,nkpt,ne)\n\nWrapper for ``read_gf_header``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"nkpt : input int\n"
"ne : input int\n"
"\nReturns\n-------\n"
"kpt : rank-2 array('d') with bounds (3,nkpt)\n"
"e : rank-1 array('D') with bounds (ne)";
/* extern void F_FUNC_US(read_gf_header,READ_GF_HEADER)(int*,int*,double*,int*,complex_double*); */
static PyObject *f2py_rout__siesta_read_gf_header(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,int*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int nkpt = 0;
  PyObject *nkpt_capi = Py_None;
  double *kpt = NULL;
  npy_intp kpt_Dims[2] = {-1, -1};
  const int kpt_Rank = 2;
  PyArrayObject *capi_kpt_tmp = NULL;
  int capi_kpt_intent = 0;
  int ne = 0;
  PyObject *ne_capi = Py_None;
  complex_double *e = NULL;
  npy_intp e_Dims[1] = {-1};
  const int e_Rank = 1;
  PyArrayObject *capi_e_tmp = NULL;
  int capi_e_intent = 0;
  static char *capi_kwlist[] = {"iu","nkpt","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.read_gf_header",\
    capi_kwlist,&iu_capi,&nkpt_capi,&ne_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_gf_header() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nkpt */
    f2py_success = int_from_pyobj(&nkpt,nkpt_capi,"_siesta.read_gf_header() 2nd argument (nkpt) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ne */
    f2py_success = int_from_pyobj(&ne,ne_capi,"_siesta.read_gf_header() 3rd argument (ne) can't be converted to int");
  if (f2py_success) {
  /* Processing variable kpt */
  kpt_Dims[0]=3,kpt_Dims[1]=nkpt;
  capi_kpt_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_kpt_tmp = array_from_pyobj(NPY_DOUBLE,kpt_Dims,kpt_Rank,capi_kpt_intent,Py_None);
  if (capi_kpt_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `kpt' of _siesta.read_gf_header to C/Fortran array" );
  } else {
    kpt = (double *)(PyArray_DATA(capi_kpt_tmp));

  /* Processing variable e */
  e_Dims[0]=ne;
  capi_e_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_e_tmp = array_from_pyobj(NPY_CDOUBLE,e_Dims,e_Rank,capi_e_intent,Py_None);
  if (capi_e_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `e' of _siesta.read_gf_header to C/Fortran array" );
  } else {
    e = (complex_double *)(PyArray_DATA(capi_e_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&nkpt,kpt,&ne,e);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NN",capi_kpt_tmp,capi_e_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_e_tmp == NULL) ... else of e*/
  /* End of cleaning variable e */
  }  /*if (capi_kpt_tmp == NULL) ... else of kpt*/
  /* End of cleaning variable kpt */
  } /*if (f2py_success) of ne*/
  /* End of cleaning variable ne */
  } /*if (f2py_success) of nkpt*/
  /* End of cleaning variable nkpt */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_gf_header ***************************/

/******************************** read_gf_find ********************************/
static char doc_f2py_rout__siesta_read_gf_find[] = "\
read_gf_find(iu,nspin,nkpt,ne,cstate,cspin,ckpt,ce,cis_read,istate,ispin,ikpt,ie)\n\nWrapper for ``read_gf_find``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"nspin : input int\n"
"nkpt : input int\n"
"ne : input int\n"
"cstate : input int\n"
"cspin : input int\n"
"ckpt : input int\n"
"ce : input int\n"
"cis_read : input int\n"
"istate : input int\n"
"ispin : input int\n"
"ikpt : input int\n"
"ie : input int";
/* extern void F_FUNC_US(read_gf_find,READ_GF_FIND)(int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*); */
static PyObject *f2py_rout__siesta_read_gf_find(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int nkpt = 0;
  PyObject *nkpt_capi = Py_None;
  int ne = 0;
  PyObject *ne_capi = Py_None;
  int cstate = 0;
  PyObject *cstate_capi = Py_None;
  int cspin = 0;
  PyObject *cspin_capi = Py_None;
  int ckpt = 0;
  PyObject *ckpt_capi = Py_None;
  int ce = 0;
  PyObject *ce_capi = Py_None;
  int cis_read = 0;
  PyObject *cis_read_capi = Py_None;
  int istate = 0;
  PyObject *istate_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ikpt = 0;
  PyObject *ikpt_capi = Py_None;
  int ie = 0;
  PyObject *ie_capi = Py_None;
  static char *capi_kwlist[] = {"iu","nspin","nkpt","ne","cstate","cspin","ckpt","ce","cis_read","istate","ispin","ikpt","ie",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOO:_siesta.read_gf_find",\
    capi_kwlist,&iu_capi,&nspin_capi,&nkpt_capi,&ne_capi,&cstate_capi,&cspin_capi,&ckpt_capi,&ce_capi,&cis_read_capi,&istate_capi,&ispin_capi,&ikpt_capi,&ie_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_gf_find() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_gf_find() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nkpt */
    f2py_success = int_from_pyobj(&nkpt,nkpt_capi,"_siesta.read_gf_find() 3rd argument (nkpt) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ne */
    f2py_success = int_from_pyobj(&ne,ne_capi,"_siesta.read_gf_find() 4th argument (ne) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cstate */
    f2py_success = int_from_pyobj(&cstate,cstate_capi,"_siesta.read_gf_find() 5th argument (cstate) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cspin */
    f2py_success = int_from_pyobj(&cspin,cspin_capi,"_siesta.read_gf_find() 6th argument (cspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ckpt */
    f2py_success = int_from_pyobj(&ckpt,ckpt_capi,"_siesta.read_gf_find() 7th argument (ckpt) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ce */
    f2py_success = int_from_pyobj(&ce,ce_capi,"_siesta.read_gf_find() 8th argument (ce) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cis_read */
    f2py_success = int_from_pyobj(&cis_read,cis_read_capi,"_siesta.read_gf_find() 9th argument (cis_read) can't be converted to int");
  if (f2py_success) {
  /* Processing variable istate */
    f2py_success = int_from_pyobj(&istate,istate_capi,"_siesta.read_gf_find() 10th argument (istate) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_gf_find() 11st argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ikpt */
    f2py_success = int_from_pyobj(&ikpt,ikpt_capi,"_siesta.read_gf_find() 12nd argument (ikpt) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ie */
    f2py_success = int_from_pyobj(&ie,ie_capi,"_siesta.read_gf_find() 13rd argument (ie) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&nspin,&nkpt,&ne,&cstate,&cspin,&ckpt,&ce,&cis_read,&istate,&ispin,&ikpt,&ie);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of ie*/
  /* End of cleaning variable ie */
  } /*if (f2py_success) of ikpt*/
  /* End of cleaning variable ikpt */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
  } /*if (f2py_success) of istate*/
  /* End of cleaning variable istate */
  } /*if (f2py_success) of cis_read*/
  /* End of cleaning variable cis_read */
  } /*if (f2py_success) of ce*/
  /* End of cleaning variable ce */
  } /*if (f2py_success) of ckpt*/
  /* End of cleaning variable ckpt */
  } /*if (f2py_success) of cspin*/
  /* End of cleaning variable cspin */
  } /*if (f2py_success) of cstate*/
  /* End of cleaning variable cstate */
  } /*if (f2py_success) of ne*/
  /* End of cleaning variable ne */
  } /*if (f2py_success) of nkpt*/
  /* End of cleaning variable nkpt */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_gf_find ****************************/

/********************************* read_gf_hs *********************************/
static char doc_f2py_rout__siesta_read_gf_hs[] = "\
h,s = read_gf_hs(iu,no_u)\n\nWrapper for ``read_gf_hs``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"no_u : input int\n"
"\nReturns\n-------\n"
"h : rank-2 array('D') with bounds (no_u,no_u)\n"
"s : rank-2 array('D') with bounds (no_u,no_u)";
/* extern void F_FUNC_US(read_gf_hs,READ_GF_HS)(int*,int*,complex_double*,complex_double*); */
static PyObject *f2py_rout__siesta_read_gf_hs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,complex_double*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  complex_double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  complex_double *s = NULL;
  npy_intp s_Dims[2] = {-1, -1};
  const int s_Rank = 2;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  static char *capi_kwlist[] = {"iu","no_u",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OO:_siesta.read_gf_hs",\
    capi_kwlist,&iu_capi,&no_u_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_gf_hs() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_gf_hs() 2nd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable h */
  h_Dims[0]=no_u,h_Dims[1]=no_u;
  capi_h_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_h_tmp = array_from_pyobj(NPY_CDOUBLE,h_Dims,h_Rank,capi_h_intent,Py_None);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `h' of _siesta.read_gf_hs to C/Fortran array" );
  } else {
    h = (complex_double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=no_u,s_Dims[1]=no_u;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_CDOUBLE,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_gf_hs to C/Fortran array" );
  } else {
    s = (complex_double *)(PyArray_DATA(capi_s_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&no_u,h,s);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NN",capi_h_tmp,capi_s_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of read_gf_hs *****************************/

/********************************* read_gf_se *********************************/
static char doc_f2py_rout__siesta_read_gf_se[] = "\
se = read_gf_se(iu,no_u,ie)\n\nWrapper for ``read_gf_se``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"no_u : input int\n"
"ie : input int\n"
"\nReturns\n-------\n"
"se : rank-2 array('D') with bounds (no_u,no_u)";
/* extern void F_FUNC_US(read_gf_se,READ_GF_SE)(int*,int*,int*,complex_double*); */
static PyObject *f2py_rout__siesta_read_gf_se(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int ie = 0;
  PyObject *ie_capi = Py_None;
  complex_double *se = NULL;
  npy_intp se_Dims[2] = {-1, -1};
  const int se_Rank = 2;
  PyArrayObject *capi_se_tmp = NULL;
  int capi_se_intent = 0;
  static char *capi_kwlist[] = {"iu","no_u","ie",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.read_gf_se",\
    capi_kwlist,&iu_capi,&no_u_capi,&ie_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_gf_se() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_gf_se() 2nd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ie */
    f2py_success = int_from_pyobj(&ie,ie_capi,"_siesta.read_gf_se() 3rd argument (ie) can't be converted to int");
  if (f2py_success) {
  /* Processing variable se */
  se_Dims[0]=no_u,se_Dims[1]=no_u;
  capi_se_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_se_tmp = array_from_pyobj(NPY_CDOUBLE,se_Dims,se_Rank,capi_se_intent,Py_None);
  if (capi_se_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `se' of _siesta.read_gf_se to C/Fortran array" );
  } else {
    se = (complex_double *)(PyArray_DATA(capi_se_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&no_u,&ie,se);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("N",capi_se_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_se_tmp == NULL) ... else of se*/
  /* End of cleaning variable se */
  } /*if (f2py_success) of ie*/
  /* End of cleaning variable ie */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of read_gf_se *****************************/

/****************************** write_gf_header ******************************/
static char doc_f2py_rout__siesta_write_gf_header[] = "\
write_gf_header(iu,nspin,cell,na_u,no_u,no_used,xa_used,lasto_used,bloch,pre_expand,mu,kpt,kw,e,[na_used,nkpt,ne])\n\nWrapper for ``write_gf_header``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"nspin : input int\n"
"cell : input rank-2 array('d') with bounds (3,3)\n"
"na_u : input int\n"
"no_u : input int\n"
"no_used : input int\n"
"xa_used : input rank-2 array('d') with bounds (3,na_used)\n"
"lasto_used : input rank-1 array('i') with bounds (na_used + 1)\n"
"bloch : input rank-1 array('i') with bounds (3)\n"
"pre_expand : input int\n"
"mu : input float\n"
"kpt : input rank-2 array('d') with bounds (3,nkpt)\n"
"kw : input rank-1 array('d') with bounds (nkpt)\n"
"e : input rank-1 array('D') with bounds (ne)\n"
"\nOther Parameters\n----------------\n"
"na_used : input int, optional\n    Default: shape(xa_used,1)\n"
"nkpt : input int, optional\n    Default: shape(kpt,1)\n"
"ne : input int, optional\n    Default: len(e)";
/* extern void F_FUNC_US(write_gf_header,WRITE_GF_HEADER)(int*,int*,double*,int*,int*,int*,int*,double*,int*,int*,int*,double*,int*,double*,double*,int*,complex_double*); */
static PyObject *f2py_rout__siesta_write_gf_header(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,double*,int*,int*,int*,int*,double*,int*,int*,int*,double*,int*,double*,double*,int*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  double *cell = NULL;
  npy_intp cell_Dims[2] = {-1, -1};
  const int cell_Rank = 2;
  PyArrayObject *capi_cell_tmp = NULL;
  int capi_cell_intent = 0;
  PyObject *cell_capi = Py_None;
  int na_u = 0;
  PyObject *na_u_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int na_used = 0;
  PyObject *na_used_capi = Py_None;
  int no_used = 0;
  PyObject *no_used_capi = Py_None;
  double *xa_used = NULL;
  npy_intp xa_used_Dims[2] = {-1, -1};
  const int xa_used_Rank = 2;
  PyArrayObject *capi_xa_used_tmp = NULL;
  int capi_xa_used_intent = 0;
  PyObject *xa_used_capi = Py_None;
  int *lasto_used = NULL;
  npy_intp lasto_used_Dims[1] = {-1};
  const int lasto_used_Rank = 1;
  PyArrayObject *capi_lasto_used_tmp = NULL;
  int capi_lasto_used_intent = 0;
  PyObject *lasto_used_capi = Py_None;
  int *bloch = NULL;
  npy_intp bloch_Dims[1] = {-1};
  const int bloch_Rank = 1;
  PyArrayObject *capi_bloch_tmp = NULL;
  int capi_bloch_intent = 0;
  PyObject *bloch_capi = Py_None;
  int pre_expand = 0;
  PyObject *pre_expand_capi = Py_None;
  double mu = 0;
  PyObject *mu_capi = Py_None;
  int nkpt = 0;
  PyObject *nkpt_capi = Py_None;
  double *kpt = NULL;
  npy_intp kpt_Dims[2] = {-1, -1};
  const int kpt_Rank = 2;
  PyArrayObject *capi_kpt_tmp = NULL;
  int capi_kpt_intent = 0;
  PyObject *kpt_capi = Py_None;
  double *kw = NULL;
  npy_intp kw_Dims[1] = {-1};
  const int kw_Rank = 1;
  PyArrayObject *capi_kw_tmp = NULL;
  int capi_kw_intent = 0;
  PyObject *kw_capi = Py_None;
  int ne = 0;
  PyObject *ne_capi = Py_None;
  complex_double *e = NULL;
  npy_intp e_Dims[1] = {-1};
  const int e_Rank = 1;
  PyArrayObject *capi_e_tmp = NULL;
  int capi_e_intent = 0;
  PyObject *e_capi = Py_None;
  static char *capi_kwlist[] = {"iu","nspin","cell","na_u","no_u","no_used","xa_used","lasto_used","bloch","pre_expand","mu","kpt","kw","e","na_used","nkpt","ne",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOOOOOOOOO|OOO:_siesta.write_gf_header",\
    capi_kwlist,&iu_capi,&nspin_capi,&cell_capi,&na_u_capi,&no_u_capi,&no_used_capi,&xa_used_capi,&lasto_used_capi,&bloch_capi,&pre_expand_capi,&mu_capi,&kpt_capi,&kw_capi,&e_capi,&na_used_capi,&nkpt_capi,&ne_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.write_gf_header() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_gf_header() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable cell */
  cell_Dims[0]=3,cell_Dims[1]=3;
  capi_cell_intent |= F2PY_INTENT_IN;
  capi_cell_tmp = array_from_pyobj(NPY_DOUBLE,cell_Dims,cell_Rank,capi_cell_intent,cell_capi);
  if (capi_cell_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 3rd argument `cell' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    cell = (double *)(PyArray_DATA(capi_cell_tmp));

  /* Processing variable na_u */
    f2py_success = int_from_pyobj(&na_u,na_u_capi,"_siesta.write_gf_header() 4th argument (na_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_gf_header() 5th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_used */
    f2py_success = int_from_pyobj(&no_used,no_used_capi,"_siesta.write_gf_header() 6th argument (no_used) can't be converted to int");
  if (f2py_success) {
  /* Processing variable xa_used */
  xa_used_Dims[0]=3;
  capi_xa_used_intent |= F2PY_INTENT_IN;
  capi_xa_used_tmp = array_from_pyobj(NPY_DOUBLE,xa_used_Dims,xa_used_Rank,capi_xa_used_intent,xa_used_capi);
  if (capi_xa_used_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 7th argument `xa_used' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    xa_used = (double *)(PyArray_DATA(capi_xa_used_tmp));

  /* Processing variable bloch */
  bloch_Dims[0]=3;
  capi_bloch_intent |= F2PY_INTENT_IN;
  capi_bloch_tmp = array_from_pyobj(NPY_INT,bloch_Dims,bloch_Rank,capi_bloch_intent,bloch_capi);
  if (capi_bloch_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 9th argument `bloch' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    bloch = (int *)(PyArray_DATA(capi_bloch_tmp));

  /* Processing variable pre_expand */
    f2py_success = int_from_pyobj(&pre_expand,pre_expand_capi,"_siesta.write_gf_header() 10th argument (pre_expand) can't be converted to int");
  if (f2py_success) {
  /* Processing variable mu */
    f2py_success = double_from_pyobj(&mu,mu_capi,"_siesta.write_gf_header() 11st argument (mu) can't be converted to double");
  if (f2py_success) {
  /* Processing variable kpt */
  kpt_Dims[0]=3;
  capi_kpt_intent |= F2PY_INTENT_IN;
  capi_kpt_tmp = array_from_pyobj(NPY_DOUBLE,kpt_Dims,kpt_Rank,capi_kpt_intent,kpt_capi);
  if (capi_kpt_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 12nd argument `kpt' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    kpt = (double *)(PyArray_DATA(capi_kpt_tmp));

  /* Processing variable e */
  ;
  capi_e_intent |= F2PY_INTENT_IN;
  capi_e_tmp = array_from_pyobj(NPY_CDOUBLE,e_Dims,e_Rank,capi_e_intent,e_capi);
  if (capi_e_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 14th argument `e' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    e = (complex_double *)(PyArray_DATA(capi_e_tmp));

  /* Processing variable na_used */
  if (na_used_capi == Py_None) na_used = shape(xa_used,1); else
    f2py_success = int_from_pyobj(&na_used,na_used_capi,"_siesta.write_gf_header() 1st keyword (na_used) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(xa_used,1)==na_used,"shape(xa_used,1)==na_used","1st keyword na_used","write_gf_header:na_used=%d",na_used) {
  /* Processing variable lasto_used */
  lasto_used_Dims[0]=na_used + 1;
  capi_lasto_used_intent |= F2PY_INTENT_IN;
  capi_lasto_used_tmp = array_from_pyobj(NPY_INT,lasto_used_Dims,lasto_used_Rank,capi_lasto_used_intent,lasto_used_capi);
  if (capi_lasto_used_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 8th argument `lasto_used' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    lasto_used = (int *)(PyArray_DATA(capi_lasto_used_tmp));

  /* Processing variable nkpt */
  if (nkpt_capi == Py_None) nkpt = shape(kpt,1); else
    f2py_success = int_from_pyobj(&nkpt,nkpt_capi,"_siesta.write_gf_header() 2nd keyword (nkpt) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(kpt,1)==nkpt,"shape(kpt,1)==nkpt","2nd keyword nkpt","write_gf_header:nkpt=%d",nkpt) {
  /* Processing variable kw */
  kw_Dims[0]=nkpt;
  capi_kw_intent |= F2PY_INTENT_IN;
  capi_kw_tmp = array_from_pyobj(NPY_DOUBLE,kw_Dims,kw_Rank,capi_kw_intent,kw_capi);
  if (capi_kw_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 13rd argument `kw' of _siesta.write_gf_header to C/Fortran array" );
  } else {
    kw = (double *)(PyArray_DATA(capi_kw_tmp));

  /* Processing variable ne */
  if (ne_capi == Py_None) ne = len(e); else
    f2py_success = int_from_pyobj(&ne,ne_capi,"_siesta.write_gf_header() 3rd keyword (ne) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(e)>=ne,"len(e)>=ne","3rd keyword ne","write_gf_header:ne=%d",ne) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&nspin,cell,&na_u,&no_u,&na_used,&no_used,xa_used,lasto_used,bloch,&pre_expand,&mu,&nkpt,kpt,kw,&ne,e);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(len(e)>=ne)*/
  } /*if (f2py_success) of ne*/
  /* End of cleaning variable ne */
  if((PyObject *)capi_kw_tmp!=kw_capi) {
    Py_XDECREF(capi_kw_tmp); }
  }  /*if (capi_kw_tmp == NULL) ... else of kw*/
  /* End of cleaning variable kw */
  } /*CHECKSCALAR(shape(kpt,1)==nkpt)*/
  } /*if (f2py_success) of nkpt*/
  /* End of cleaning variable nkpt */
  if((PyObject *)capi_lasto_used_tmp!=lasto_used_capi) {
    Py_XDECREF(capi_lasto_used_tmp); }
  }  /*if (capi_lasto_used_tmp == NULL) ... else of lasto_used*/
  /* End of cleaning variable lasto_used */
  } /*CHECKSCALAR(shape(xa_used,1)==na_used)*/
  } /*if (f2py_success) of na_used*/
  /* End of cleaning variable na_used */
  if((PyObject *)capi_e_tmp!=e_capi) {
    Py_XDECREF(capi_e_tmp); }
  }  /*if (capi_e_tmp == NULL) ... else of e*/
  /* End of cleaning variable e */
  if((PyObject *)capi_kpt_tmp!=kpt_capi) {
    Py_XDECREF(capi_kpt_tmp); }
  }  /*if (capi_kpt_tmp == NULL) ... else of kpt*/
  /* End of cleaning variable kpt */
  } /*if (f2py_success) of mu*/
  /* End of cleaning variable mu */
  } /*if (f2py_success) of pre_expand*/
  /* End of cleaning variable pre_expand */
  if((PyObject *)capi_bloch_tmp!=bloch_capi) {
    Py_XDECREF(capi_bloch_tmp); }
  }  /*if (capi_bloch_tmp == NULL) ... else of bloch*/
  /* End of cleaning variable bloch */
  if((PyObject *)capi_xa_used_tmp!=xa_used_capi) {
    Py_XDECREF(capi_xa_used_tmp); }
  }  /*if (capi_xa_used_tmp == NULL) ... else of xa_used*/
  /* End of cleaning variable xa_used */
  } /*if (f2py_success) of no_used*/
  /* End of cleaning variable no_used */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of na_u*/
  /* End of cleaning variable na_u */
  if((PyObject *)capi_cell_tmp!=cell_capi) {
    Py_XDECREF(capi_cell_tmp); }
  }  /*if (capi_cell_tmp == NULL) ... else of cell*/
  /* End of cleaning variable cell */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of write_gf_header ***************************/

/******************************** write_gf_hs ********************************/
static char doc_f2py_rout__siesta_write_gf_hs[] = "\
write_gf_hs(iu,ik,e,h,s,[no_u])\n\nWrapper for ``write_gf_hs``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"ik : input int\n"
"e : input complex\n"
"h : input rank-2 array('D') with bounds (no_u,no_u)\n"
"s : input rank-2 array('D') with bounds (no_u,no_u)\n"
"\nOther Parameters\n----------------\n"
"no_u : input int, optional\n    Default: shape(h,0)";
/* extern void F_FUNC_US(write_gf_hs,WRITE_GF_HS)(int*,int*,complex_double*,int*,complex_double*,complex_double*); */
static PyObject *f2py_rout__siesta_write_gf_hs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,complex_double*,int*,complex_double*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  complex_double e;
  PyObject *e_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  complex_double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  PyObject *h_capi = Py_None;
  complex_double *s = NULL;
  npy_intp s_Dims[2] = {-1, -1};
  const int s_Rank = 2;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  PyObject *s_capi = Py_None;
  static char *capi_kwlist[] = {"iu","ik","e","h","s","no_u",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO|O:_siesta.write_gf_hs",\
    capi_kwlist,&iu_capi,&ik_capi,&e_capi,&h_capi,&s_capi,&no_u_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.write_gf_hs() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.write_gf_hs() 2nd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable e */
    f2py_success = complex_double_from_pyobj(&e,e_capi,"_siesta.write_gf_hs() 3rd argument (e) can't be converted to complex_double");
  if (f2py_success) {
  /* Processing variable h */
  ;
  capi_h_intent |= F2PY_INTENT_IN;
  capi_h_tmp = array_from_pyobj(NPY_CDOUBLE,h_Dims,h_Rank,capi_h_intent,h_capi);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `h' of _siesta.write_gf_hs to C/Fortran array" );
  } else {
    h = (complex_double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = shape(h,0); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_gf_hs() 1st keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(h,0)==no_u,"shape(h,0)==no_u","1st keyword no_u","write_gf_hs:no_u=%d",no_u) {
  /* Processing variable s */
  s_Dims[0]=no_u,s_Dims[1]=no_u;
  capi_s_intent |= F2PY_INTENT_IN;
  capi_s_tmp = array_from_pyobj(NPY_CDOUBLE,s_Dims,s_Rank,capi_s_intent,s_capi);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `s' of _siesta.write_gf_hs to C/Fortran array" );
  } else {
    s = (complex_double *)(PyArray_DATA(capi_s_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&ik,&e,&no_u,h,s);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_s_tmp!=s_capi) {
    Py_XDECREF(capi_s_tmp); }
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  } /*CHECKSCALAR(shape(h,0)==no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  if((PyObject *)capi_h_tmp!=h_capi) {
    Py_XDECREF(capi_h_tmp); }
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  }  /*if (f2py_success) of e frompyobj*/
  /* End of cleaning variable e */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of write_gf_hs *****************************/

/******************************** write_gf_se ********************************/
static char doc_f2py_rout__siesta_write_gf_se[] = "\
write_gf_se(iu,ik,ie,e,se,[no_u])\n\nWrapper for ``write_gf_se``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"ik : input int\n"
"ie : input int\n"
"e : input complex\n"
"se : input rank-2 array('D') with bounds (no_u,no_u)\n"
"\nOther Parameters\n----------------\n"
"no_u : input int, optional\n    Default: shape(se,0)";
/* extern void F_FUNC_US(write_gf_se,WRITE_GF_SE)(int*,int*,int*,complex_double*,int*,complex_double*); */
static PyObject *f2py_rout__siesta_write_gf_se(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,complex_double*,int*,complex_double*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  int ie = 0;
  PyObject *ie_capi = Py_None;
  complex_double e;
  PyObject *e_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  complex_double *se = NULL;
  npy_intp se_Dims[2] = {-1, -1};
  const int se_Rank = 2;
  PyArrayObject *capi_se_tmp = NULL;
  int capi_se_intent = 0;
  PyObject *se_capi = Py_None;
  static char *capi_kwlist[] = {"iu","ik","ie","e","se","no_u",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO|O:_siesta.write_gf_se",\
    capi_kwlist,&iu_capi,&ik_capi,&ie_capi,&e_capi,&se_capi,&no_u_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.write_gf_se() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.write_gf_se() 2nd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ie */
    f2py_success = int_from_pyobj(&ie,ie_capi,"_siesta.write_gf_se() 3rd argument (ie) can't be converted to int");
  if (f2py_success) {
  /* Processing variable e */
    f2py_success = complex_double_from_pyobj(&e,e_capi,"_siesta.write_gf_se() 4th argument (e) can't be converted to complex_double");
  if (f2py_success) {
  /* Processing variable se */
  ;
  capi_se_intent |= F2PY_INTENT_IN;
  capi_se_tmp = array_from_pyobj(NPY_CDOUBLE,se_Dims,se_Rank,capi_se_intent,se_capi);
  if (capi_se_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `se' of _siesta.write_gf_se to C/Fortran array" );
  } else {
    se = (complex_double *)(PyArray_DATA(capi_se_tmp));

  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = shape(se,0); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_gf_se() 1st keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(se,0)==no_u,"shape(se,0)==no_u","1st keyword no_u","write_gf_se:no_u=%d",no_u) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&ik,&ie,&e,&no_u,se);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*CHECKSCALAR(shape(se,0)==no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  if((PyObject *)capi_se_tmp!=se_capi) {
    Py_XDECREF(capi_se_tmp); }
  }  /*if (capi_se_tmp == NULL) ... else of se*/
  /* End of cleaning variable se */
  }  /*if (f2py_success) of e frompyobj*/
  /* End of cleaning variable e */
  } /*if (f2py_success) of ie*/
  /* End of cleaning variable ie */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of write_gf_se *****************************/

/****************************** read_tsde_sizes ******************************/
static char doc_f2py_rout__siesta_read_tsde_sizes[] = "\
nspin,no_u,nsc,nnz = read_tsde_sizes(fname)\n\nWrapper for ``read_tsde_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"nspin : int\n"
"no_u : int\n"
"nsc : rank-1 array('i') with bounds (3)\n"
"nnz : int";
/* extern void F_FUNC_US(read_tsde_sizes,READ_TSDE_SIZES)(string,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_tsde_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  int no_u = 0;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  int nnz = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_tsde_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tsde_sizes to C string");
  if (f2py_success) {
  /* Processing variable no_u */
  /* Processing variable nspin */
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,Py_None);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `nsc' of _siesta.read_tsde_sizes to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable nnz */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiNi",nspin,no_u,capi_nsc_tmp,nnz);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable nnz */
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  /* End of cleaning variable nspin */
  /* End of cleaning variable no_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_tsde_sizes ***************************/

/******************************** read_tsde_dm ********************************/
static char doc_f2py_rout__siesta_read_tsde_dm[] = "\
ncol,list_col,dm = read_tsde_dm(fname,nspin,no_u,nsc,nnz)\n\nWrapper for ``read_tsde_dm``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"no_u : input int\n"
"nsc : input rank-1 array('i') with bounds (3)\n"
"nnz : input int\n"
"\nReturns\n-------\n"
"ncol : rank-1 array('i') with bounds (no_u)\n"
"list_col : rank-1 array('i') with bounds (nnz)\n"
"dm : rank-2 array('d') with bounds (nnz,nspin)";
/* extern void F_FUNC_US(read_tsde_dm,READ_TSDE_DM)(string,int*,int*,int*,int*,int*,int*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tsde_dm(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  PyObject *nsc_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  double *dm = NULL;
  npy_intp dm_Dims[2] = {-1, -1};
  const int dm_Rank = 2;
  PyArrayObject *capi_dm_tmp = NULL;
  int capi_dm_intent = 0;
  static char *capi_kwlist[] = {"fname","nspin","no_u","nsc","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_tsde_dm",\
    capi_kwlist,&fname_capi,&nspin_capi,&no_u_capi,&nsc_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tsde_dm to C string");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_tsde_dm() 3rd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_tsde_dm() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_IN;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,nsc_capi);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `nsc' of _siesta.read_tsde_dm to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable nnz */
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.read_tsde_dm() 5th argument (nnz) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ncol */
  ncol_Dims[0]=no_u;
  capi_ncol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,Py_None);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `ncol' of _siesta.read_tsde_dm to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  list_col_Dims[0]=nnz;
  capi_list_col_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,Py_None);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `list_col' of _siesta.read_tsde_dm to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable dm */
  dm_Dims[0]=nnz,dm_Dims[1]=nspin;
  capi_dm_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_dm_tmp = array_from_pyobj(NPY_DOUBLE,dm_Dims,dm_Rank,capi_dm_intent,Py_None);
  if (capi_dm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `dm' of _siesta.read_tsde_dm to C/Fortran array" );
  } else {
    dm = (double *)(PyArray_DATA(capi_dm_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,ncol,list_col,dm,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_ncol_tmp,capi_list_col_tmp,capi_dm_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_dm_tmp == NULL) ... else of dm*/
  /* End of cleaning variable dm */
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  if((PyObject *)capi_nsc_tmp!=nsc_capi) {
    Py_XDECREF(capi_nsc_tmp); }
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_tsde_dm ****************************/

/******************************** read_tsde_ef ********************************/
static char doc_f2py_rout__siesta_read_tsde_ef[] = "\
ef = read_tsde_ef(fname)\n\nWrapper for ``read_tsde_ef``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"ef : float";
/* extern void F_FUNC_US(read_tsde_ef,READ_TSDE_EF)(string,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tsde_ef(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  double ef = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_tsde_ef",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tsde_ef to C string");
  if (f2py_success) {
  /* Processing variable ef */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ef,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("d",ef);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable ef */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_tsde_ef ****************************/

/******************************* read_tsde_edm *******************************/
static char doc_f2py_rout__siesta_read_tsde_edm[] = "\
ncol,list_col,edm = read_tsde_edm(fname,nspin,no_u,nsc,nnz)\n\nWrapper for ``read_tsde_edm``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nspin : input int\n"
"no_u : input int\n"
"nsc : input rank-1 array('i') with bounds (3)\n"
"nnz : input int\n"
"\nReturns\n-------\n"
"ncol : rank-1 array('i') with bounds (no_u)\n"
"list_col : rank-1 array('i') with bounds (nnz)\n"
"edm : rank-2 array('d') with bounds (nnz,nspin)";
/* extern void F_FUNC_US(read_tsde_edm,READ_TSDE_EDM)(string,int*,int*,int*,int*,int*,int*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_tsde_edm(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  PyObject *nsc_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  double *edm = NULL;
  npy_intp edm_Dims[2] = {-1, -1};
  const int edm_Rank = 2;
  PyArrayObject *capi_edm_tmp = NULL;
  int capi_edm_intent = 0;
  static char *capi_kwlist[] = {"fname","nspin","no_u","nsc","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_tsde_edm",\
    capi_kwlist,&fname_capi,&nspin_capi,&no_u_capi,&nsc_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_tsde_edm to C string");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_tsde_edm() 3rd argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_tsde_edm() 2nd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_IN;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,nsc_capi);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `nsc' of _siesta.read_tsde_edm to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable nnz */
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.read_tsde_edm() 5th argument (nnz) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ncol */
  ncol_Dims[0]=no_u;
  capi_ncol_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,Py_None);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `ncol' of _siesta.read_tsde_edm to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  list_col_Dims[0]=nnz;
  capi_list_col_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,Py_None);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `list_col' of _siesta.read_tsde_edm to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable edm */
  edm_Dims[0]=nnz,edm_Dims[1]=nspin;
  capi_edm_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_edm_tmp = array_from_pyobj(NPY_DOUBLE,edm_Dims,edm_Rank,capi_edm_intent,Py_None);
  if (capi_edm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `edm' of _siesta.read_tsde_edm to C/Fortran array" );
  } else {
    edm = (double *)(PyArray_DATA(capi_edm_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,ncol,list_col,edm,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_ncol_tmp,capi_list_col_tmp,capi_edm_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_edm_tmp == NULL) ... else of edm*/
  /* End of cleaning variable edm */
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  if((PyObject *)capi_nsc_tmp!=nsc_capi) {
    Py_XDECREF(capi_nsc_tmp); }
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of read_tsde_edm ****************************/

/***************************** write_tsde_dm_edm *****************************/
static char doc_f2py_rout__siesta_write_tsde_dm_edm[] = "\
write_tsde_dm_edm(fname,nsc,ncol,list_col,dm,edm,ef,[nspin,no_u,nnz])\n\nWrapper for ``write_tsde_dm_edm``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"nsc : input rank-1 array('i') with bounds (3)\n"
"ncol : input rank-1 array('i') with bounds (no_u)\n"
"list_col : input rank-1 array('i') with bounds (nnz)\n"
"dm : input rank-2 array('d') with bounds (nnz,nspin)\n"
"edm : input rank-2 array('d') with bounds (nnz,nspin)\n"
"ef : input float\n"
"\nOther Parameters\n----------------\n"
"nspin : input int, optional\n    Default: shape(dm,1)\n"
"no_u : input int, optional\n    Default: len(ncol)\n"
"nnz : input int, optional\n    Default: len(list_col)";
/* extern void F_FUNC_US(write_tsde_dm_edm,WRITE_TSDE_DM_EDM)(string,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t); */
static PyObject *f2py_rout__siesta_write_tsde_dm_edm(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int *nsc = NULL;
  npy_intp nsc_Dims[1] = {-1};
  const int nsc_Rank = 1;
  PyArrayObject *capi_nsc_tmp = NULL;
  int capi_nsc_intent = 0;
  PyObject *nsc_capi = Py_None;
  int nnz = 0;
  PyObject *nnz_capi = Py_None;
  int *ncol = NULL;
  npy_intp ncol_Dims[1] = {-1};
  const int ncol_Rank = 1;
  PyArrayObject *capi_ncol_tmp = NULL;
  int capi_ncol_intent = 0;
  PyObject *ncol_capi = Py_None;
  int *list_col = NULL;
  npy_intp list_col_Dims[1] = {-1};
  const int list_col_Rank = 1;
  PyArrayObject *capi_list_col_tmp = NULL;
  int capi_list_col_intent = 0;
  PyObject *list_col_capi = Py_None;
  double *dm = NULL;
  npy_intp dm_Dims[2] = {-1, -1};
  const int dm_Rank = 2;
  PyArrayObject *capi_dm_tmp = NULL;
  int capi_dm_intent = 0;
  PyObject *dm_capi = Py_None;
  double *edm = NULL;
  npy_intp edm_Dims[2] = {-1, -1};
  const int edm_Rank = 2;
  PyArrayObject *capi_edm_tmp = NULL;
  int capi_edm_intent = 0;
  PyObject *edm_capi = Py_None;
  double ef = 0;
  PyObject *ef_capi = Py_None;
  static char *capi_kwlist[] = {"fname","nsc","ncol","list_col","dm","edm","ef","nspin","no_u","nnz",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOOO|OOO:_siesta.write_tsde_dm_edm",\
    capi_kwlist,&fname_capi,&nsc_capi,&ncol_capi,&list_col_capi,&dm_capi,&edm_capi,&ef_capi,&nspin_capi,&no_u_capi,&nnz_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.write_tsde_dm_edm to C string");
  if (f2py_success) {
  /* Processing variable nsc */
  nsc_Dims[0]=3;
  capi_nsc_intent |= F2PY_INTENT_IN;
  capi_nsc_tmp = array_from_pyobj(NPY_INT,nsc_Dims,nsc_Rank,capi_nsc_intent,nsc_capi);
  if (capi_nsc_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 2nd argument `nsc' of _siesta.write_tsde_dm_edm to C/Fortran array" );
  } else {
    nsc = (int *)(PyArray_DATA(capi_nsc_tmp));

  /* Processing variable ncol */
  ;
  capi_ncol_intent |= F2PY_INTENT_IN;
  capi_ncol_tmp = array_from_pyobj(NPY_INT,ncol_Dims,ncol_Rank,capi_ncol_intent,ncol_capi);
  if (capi_ncol_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 3rd argument `ncol' of _siesta.write_tsde_dm_edm to C/Fortran array" );
  } else {
    ncol = (int *)(PyArray_DATA(capi_ncol_tmp));

  /* Processing variable list_col */
  ;
  capi_list_col_intent |= F2PY_INTENT_IN;
  capi_list_col_tmp = array_from_pyobj(NPY_INT,list_col_Dims,list_col_Rank,capi_list_col_intent,list_col_capi);
  if (capi_list_col_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 4th argument `list_col' of _siesta.write_tsde_dm_edm to C/Fortran array" );
  } else {
    list_col = (int *)(PyArray_DATA(capi_list_col_tmp));

  /* Processing variable ef */
    f2py_success = double_from_pyobj(&ef,ef_capi,"_siesta.write_tsde_dm_edm() 7th argument (ef) can't be converted to double");
  if (f2py_success) {
  /* Processing variable no_u */
  if (no_u_capi == Py_None) no_u = len(ncol); else
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.write_tsde_dm_edm() 2nd keyword (no_u) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(ncol)>=no_u,"len(ncol)>=no_u","2nd keyword no_u","write_tsde_dm_edm:no_u=%d",no_u) {
  /* Processing variable nnz */
  if (nnz_capi == Py_None) nnz = len(list_col); else
    f2py_success = int_from_pyobj(&nnz,nnz_capi,"_siesta.write_tsde_dm_edm() 3rd keyword (nnz) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(len(list_col)>=nnz,"len(list_col)>=nnz","3rd keyword nnz","write_tsde_dm_edm:nnz=%d",nnz) {
  /* Processing variable dm */
  dm_Dims[0]=nnz;
  capi_dm_intent |= F2PY_INTENT_IN;
  capi_dm_tmp = array_from_pyobj(NPY_DOUBLE,dm_Dims,dm_Rank,capi_dm_intent,dm_capi);
  if (capi_dm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 5th argument `dm' of _siesta.write_tsde_dm_edm to C/Fortran array" );
  } else {
    dm = (double *)(PyArray_DATA(capi_dm_tmp));

  /* Processing variable nspin */
  if (nspin_capi == Py_None) nspin = shape(dm,1); else
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.write_tsde_dm_edm() 1st keyword (nspin) can't be converted to int");
  if (f2py_success) {
  CHECKSCALAR(shape(dm,1)==nspin,"shape(dm,1)==nspin","1st keyword nspin","write_tsde_dm_edm:nspin=%d",nspin) {
  /* Processing variable edm */
  edm_Dims[0]=nnz,edm_Dims[1]=nspin;
  capi_edm_intent |= F2PY_INTENT_IN;
  capi_edm_tmp = array_from_pyobj(NPY_DOUBLE,edm_Dims,edm_Rank,capi_edm_intent,edm_capi);
  if (capi_edm_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting 6th argument `edm' of _siesta.write_tsde_dm_edm to C/Fortran array" );
  } else {
    edm = (double *)(PyArray_DATA(capi_edm_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,nsc,&nnz,ncol,list_col,dm,edm,&ef,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  if((PyObject *)capi_edm_tmp!=edm_capi) {
    Py_XDECREF(capi_edm_tmp); }
  }  /*if (capi_edm_tmp == NULL) ... else of edm*/
  /* End of cleaning variable edm */
  } /*CHECKSCALAR(shape(dm,1)==nspin)*/
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  if((PyObject *)capi_dm_tmp!=dm_capi) {
    Py_XDECREF(capi_dm_tmp); }
  }  /*if (capi_dm_tmp == NULL) ... else of dm*/
  /* End of cleaning variable dm */
  } /*CHECKSCALAR(len(list_col)>=nnz)*/
  } /*if (f2py_success) of nnz*/
  /* End of cleaning variable nnz */
  } /*CHECKSCALAR(len(ncol)>=no_u)*/
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of ef*/
  /* End of cleaning variable ef */
  if((PyObject *)capi_list_col_tmp!=list_col_capi) {
    Py_XDECREF(capi_list_col_tmp); }
  }  /*if (capi_list_col_tmp == NULL) ... else of list_col*/
  /* End of cleaning variable list_col */
  if((PyObject *)capi_ncol_tmp!=ncol_capi) {
    Py_XDECREF(capi_ncol_tmp); }
  }  /*if (capi_ncol_tmp == NULL) ... else of ncol*/
  /* End of cleaning variable ncol */
  if((PyObject *)capi_nsc_tmp!=nsc_capi) {
    Py_XDECREF(capi_nsc_tmp); }
  }  /*if (capi_nsc_tmp == NULL) ... else of nsc*/
  /* End of cleaning variable nsc */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************** end of write_tsde_dm_edm **************************/

/******************************* read_hs_header *******************************/
static char doc_f2py_rout__siesta_read_hs_header[] = "\
gamma,nspin,no_u,no_s,maxnh = read_hs_header(fname)\n\nWrapper for ``read_hs_header``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"gamma : int\n"
"nspin : int\n"
"no_u : int\n"
"no_s : int\n"
"maxnh : int";
/* extern void F_FUNC_US(read_hs_header,READ_HS_HEADER)(string,int*,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_hs_header(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  int nspin = 0;
  int no_u = 0;
  int no_s = 0;
  int maxnh = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_hs_header",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_hs_header to C string");
  if (f2py_success) {
  /* Processing variable gamma */
  /* Processing variable no_u */
  /* Processing variable no_s */
  /* Processing variable nspin */
  /* Processing variable maxnh */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&nspin,&no_u,&no_s,&maxnh,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiiii",gamma,nspin,no_u,no_s,maxnh);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable maxnh */
  /* End of cleaning variable nspin */
  /* End of cleaning variable no_s */
  /* End of cleaning variable no_u */
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_hs_header ***************************/

/********************************** read_hs **********************************/
static char doc_f2py_rout__siesta_read_hs[] = "\
numh,listhptr,listh,h,s,xij = read_hs(fname,gamma,nspin,no_u,no_s,maxnh)\n\nWrapper for ``read_hs``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"gamma : input int\n"
"nspin : input int\n"
"no_u : input int\n"
"no_s : input int\n"
"maxnh : input int\n"
"\nReturns\n-------\n"
"numh : rank-1 array('i') with bounds (no_u)\n"
"listhptr : rank-1 array('i') with bounds (no_u)\n"
"listh : rank-1 array('i') with bounds (maxnh)\n"
"h : rank-2 array('d') with bounds (maxnh,nspin)\n"
"s : rank-1 array('d') with bounds (maxnh)\n"
"xij : rank-2 array('d') with bounds (3,maxnh)";
/* extern void F_FUNC_US(read_hs,READ_HS)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t); */
static PyObject *f2py_rout__siesta_read_hs(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,int*,int*,int*,double*,double*,double*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int gamma = 0;
  PyObject *gamma_capi = Py_None;
  int nspin = 0;
  PyObject *nspin_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int no_s = 0;
  PyObject *no_s_capi = Py_None;
  int maxnh = 0;
  PyObject *maxnh_capi = Py_None;
  int *numh = NULL;
  npy_intp numh_Dims[1] = {-1};
  const int numh_Rank = 1;
  PyArrayObject *capi_numh_tmp = NULL;
  int capi_numh_intent = 0;
  int *listhptr = NULL;
  npy_intp listhptr_Dims[1] = {-1};
  const int listhptr_Rank = 1;
  PyArrayObject *capi_listhptr_tmp = NULL;
  int capi_listhptr_intent = 0;
  int *listh = NULL;
  npy_intp listh_Dims[1] = {-1};
  const int listh_Rank = 1;
  PyArrayObject *capi_listh_tmp = NULL;
  int capi_listh_intent = 0;
  double *h = NULL;
  npy_intp h_Dims[2] = {-1, -1};
  const int h_Rank = 2;
  PyArrayObject *capi_h_tmp = NULL;
  int capi_h_intent = 0;
  double *s = NULL;
  npy_intp s_Dims[1] = {-1};
  const int s_Rank = 1;
  PyArrayObject *capi_s_tmp = NULL;
  int capi_s_intent = 0;
  double *xij = NULL;
  npy_intp xij_Dims[2] = {-1, -1};
  const int xij_Rank = 2;
  PyArrayObject *capi_xij_tmp = NULL;
  int capi_xij_intent = 0;
  static char *capi_kwlist[] = {"fname","gamma","nspin","no_u","no_s","maxnh",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOOO:_siesta.read_hs",\
    capi_kwlist,&fname_capi,&gamma_capi,&nspin_capi,&no_u_capi,&no_s_capi,&maxnh_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_hs to C string");
  if (f2py_success) {
  /* Processing variable gamma */
    gamma = (int)PyObject_IsTrue(gamma_capi);
    f2py_success = 1;
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_hs() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_s */
    f2py_success = int_from_pyobj(&no_s,no_s_capi,"_siesta.read_hs() 5th argument (no_s) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nspin */
    f2py_success = int_from_pyobj(&nspin,nspin_capi,"_siesta.read_hs() 3rd argument (nspin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable maxnh */
    f2py_success = int_from_pyobj(&maxnh,maxnh_capi,"_siesta.read_hs() 6th argument (maxnh) can't be converted to int");
  if (f2py_success) {
  /* Processing variable listh */
  listh_Dims[0]=maxnh;
  capi_listh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_listh_tmp = array_from_pyobj(NPY_INT,listh_Dims,listh_Rank,capi_listh_intent,Py_None);
  if (capi_listh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `listh' of _siesta.read_hs to C/Fortran array" );
  } else {
    listh = (int *)(PyArray_DATA(capi_listh_tmp));

  /* Processing variable numh */
  numh_Dims[0]=no_u;
  capi_numh_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_numh_tmp = array_from_pyobj(NPY_INT,numh_Dims,numh_Rank,capi_numh_intent,Py_None);
  if (capi_numh_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `numh' of _siesta.read_hs to C/Fortran array" );
  } else {
    numh = (int *)(PyArray_DATA(capi_numh_tmp));

  /* Processing variable listhptr */
  listhptr_Dims[0]=no_u;
  capi_listhptr_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_listhptr_tmp = array_from_pyobj(NPY_INT,listhptr_Dims,listhptr_Rank,capi_listhptr_intent,Py_None);
  if (capi_listhptr_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `listhptr' of _siesta.read_hs to C/Fortran array" );
  } else {
    listhptr = (int *)(PyArray_DATA(capi_listhptr_tmp));

  /* Processing variable h */
  h_Dims[0]=maxnh,h_Dims[1]=nspin;
  capi_h_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_h_tmp = array_from_pyobj(NPY_DOUBLE,h_Dims,h_Rank,capi_h_intent,Py_None);
  if (capi_h_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `h' of _siesta.read_hs to C/Fortran array" );
  } else {
    h = (double *)(PyArray_DATA(capi_h_tmp));

  /* Processing variable s */
  s_Dims[0]=maxnh;
  capi_s_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_s_tmp = array_from_pyobj(NPY_DOUBLE,s_Dims,s_Rank,capi_s_intent,Py_None);
  if (capi_s_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `s' of _siesta.read_hs to C/Fortran array" );
  } else {
    s = (double *)(PyArray_DATA(capi_s_tmp));

  /* Processing variable xij */
  xij_Dims[0]=3,xij_Dims[1]=maxnh;
  capi_xij_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_xij_tmp = array_from_pyobj(NPY_DOUBLE,xij_Dims,xij_Rank,capi_xij_intent,Py_None);
  if (capi_xij_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `xij' of _siesta.read_hs to C/Fortran array" );
  } else {
    xij = (double *)(PyArray_DATA(capi_xij_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&gamma,&nspin,&no_u,&no_s,&maxnh,numh,listhptr,listh,h,s,xij,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNNNNN",capi_numh_tmp,capi_listhptr_tmp,capi_listh_tmp,capi_h_tmp,capi_s_tmp,capi_xij_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_xij_tmp == NULL) ... else of xij*/
  /* End of cleaning variable xij */
  }  /*if (capi_s_tmp == NULL) ... else of s*/
  /* End of cleaning variable s */
  }  /*if (capi_h_tmp == NULL) ... else of h*/
  /* End of cleaning variable h */
  }  /*if (capi_listhptr_tmp == NULL) ... else of listhptr*/
  /* End of cleaning variable listhptr */
  }  /*if (capi_numh_tmp == NULL) ... else of numh*/
  /* End of cleaning variable numh */
  }  /*if (capi_listh_tmp == NULL) ... else of listh*/
  /* End of cleaning variable listh */
  } /*if (f2py_success) of maxnh*/
  /* End of cleaning variable maxnh */
  } /*if (f2py_success) of nspin*/
  /* End of cleaning variable nspin */
  } /*if (f2py_success) of no_s*/
  /* End of cleaning variable no_s */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of gamma*/
  /* End of cleaning variable gamma */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/******************************* end of read_hs *******************************/

/****************************** read_wfsx_sizes ******************************/
static char doc_f2py_rout__siesta_read_wfsx_sizes[] = "\
nspin,no_u,nk,gamma = read_wfsx_sizes(fname)\n\nWrapper for ``read_wfsx_sizes``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"nspin : int\n"
"no_u : int\n"
"nk : int\n"
"gamma : int";
/* extern void F_FUNC_US(read_wfsx_sizes,READ_WFSX_SIZES)(string,int*,int*,int*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_wfsx_sizes(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int nspin = 0;
  int no_u = 0;
  int nk = 0;
  int gamma = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.read_wfsx_sizes",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_wfsx_sizes to C string");
  if (f2py_success) {
  /* Processing variable nspin */
  /* Processing variable no_u */
  /* Processing variable nk */
  /* Processing variable gamma */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&nspin,&no_u,&nk,&gamma,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("iiii",nspin,no_u,nk,gamma);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable gamma */
  /* End of cleaning variable nk */
  /* End of cleaning variable no_u */
  /* End of cleaning variable nspin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of read_wfsx_sizes ***************************/

/**************************** read_wfsx_index_info ****************************/
static char doc_f2py_rout__siesta_read_wfsx_index_info[] = "\
k,kw,nwf = read_wfsx_index_info(fname,ispin,ik)\n\nWrapper for ``read_wfsx_index_info``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"ispin : input int\n"
"ik : input int\n"
"\nReturns\n-------\n"
"k : rank-1 array('d') with bounds (3)\n"
"kw : float\n"
"nwf : int";
/* extern void F_FUNC_US(read_wfsx_index_info,READ_WFSX_INDEX_INFO)(string,int*,int*,double*,double*,int*,size_t); */
static PyObject *f2py_rout__siesta_read_wfsx_index_info(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,double*,double*,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  double *k = NULL;
  npy_intp k_Dims[1] = {-1};
  const int k_Rank = 1;
  PyArrayObject *capi_k_tmp = NULL;
  int capi_k_intent = 0;
  double kw = 0;
  int nwf = 0;
  static char *capi_kwlist[] = {"fname","ispin","ik",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.read_wfsx_index_info",\
    capi_kwlist,&fname_capi,&ispin_capi,&ik_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_wfsx_index_info to C string");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_wfsx_index_info() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.read_wfsx_index_info() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable k */
  k_Dims[0]=3;
  capi_k_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_k_tmp = array_from_pyobj(NPY_DOUBLE,k_Dims,k_Rank,capi_k_intent,Py_None);
  if (capi_k_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `k' of _siesta.read_wfsx_index_info to C/Fortran array" );
  } else {
    k = (double *)(PyArray_DATA(capi_k_tmp));

  /* Processing variable kw */
  /* Processing variable nwf */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ispin,&ik,k,&kw,&nwf,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("Ndi",capi_k_tmp,kw,nwf);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable nwf */
  /* End of cleaning variable kw */
  }  /*if (capi_k_tmp == NULL) ... else of k*/
  /* End of cleaning variable k */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************ end of read_wfsx_index_info ************************/

/****************************** skip_wfsx_index ******************************/
static char doc_f2py_rout__siesta_skip_wfsx_index[] = "\
skip_wfsx_index(iu,ispin,ik)\n\nWrapper for ``skip_wfsx_index``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"ispin : input int\n"
"ik : input int";
/* extern void F_FUNC_US(skip_wfsx_index,SKIP_WFSX_INDEX)(int*,int*,int*); */
static PyObject *f2py_rout__siesta_skip_wfsx_index(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  static char *capi_kwlist[] = {"iu","ispin","ik",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOO:_siesta.skip_wfsx_index",\
    capi_kwlist,&iu_capi,&ispin_capi,&ik_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.skip_wfsx_index() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.skip_wfsx_index() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.skip_wfsx_index() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&ispin,&ik);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of skip_wfsx_index ***************************/

/*************************** read_wfsx_index_check ***************************/
static char doc_f2py_rout__siesta_read_wfsx_index_check[] = "\
read_wfsx_index_check(iu,ispin,ik,nwf,fail)\n\nWrapper for ``read_wfsx_index_check``.\
\n\nParameters\n----------\n"
"iu : input int\n"
"ispin : input int\n"
"ik : input int\n"
"nwf : input int\n"
"fail : in/output rank-0 array(int,'i')";
/* extern void F_FUNC_US(read_wfsx_index_check,READ_WFSX_INDEX_CHECK)(int*,int*,int*,int*,int*); */
static PyObject *f2py_rout__siesta_read_wfsx_index_check(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*,int*,int*,int*,int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  int nwf = 0;
  PyObject *nwf_capi = Py_None;
  int fail = 0;
  PyObject *fail_capi = Py_None;
  static char *capi_kwlist[] = {"iu","ispin","ik","nwf","fail",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_wfsx_index_check",\
    capi_kwlist,&iu_capi,&ispin_capi,&ik_capi,&nwf_capi,&fail_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.read_wfsx_index_check() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_wfsx_index_check() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.read_wfsx_index_check() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nwf */
    f2py_success = int_from_pyobj(&nwf,nwf_capi,"_siesta.read_wfsx_index_check() 4th argument (nwf) can't be converted to int");
  if (f2py_success) {
  /* Processing variable fail */
    f2py_success = int_from_pyobj(&fail,fail_capi,"_siesta.read_wfsx_index_check() 5th argument (fail) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu,&ispin,&ik,&nwf,&fail);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
  f2py_success = try_pyarr_from_int(fail_capi,&fail);
  if (f2py_success) {
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
  } /*if (f2py_success) of fail pyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of fail*/
  /* End of cleaning variable fail */
  } /*if (f2py_success) of nwf*/
  /* End of cleaning variable nwf */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************ end of read_wfsx_index_check ************************/

/***************************** read_wfsx_index_1 *****************************/
static char doc_f2py_rout__siesta_read_wfsx_index_1[] = "\
idx,eig,state = read_wfsx_index_1(fname,ispin,ik,no_u,nwf)\n\nWrapper for ``read_wfsx_index_1``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"ispin : input int\n"
"ik : input int\n"
"no_u : input int\n"
"nwf : input int\n"
"\nReturns\n-------\n"
"idx : rank-1 array('i') with bounds (nwf)\n"
"eig : rank-1 array('d') with bounds (nwf)\n"
"state : rank-2 array('f') with bounds (no_u,nwf)";
/* extern void F_FUNC_US(read_wfsx_index_1,READ_WFSX_INDEX_1)(string,int*,int*,int*,int*,int*,double*,float*,size_t); */
static PyObject *f2py_rout__siesta_read_wfsx_index_1(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,double*,float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nwf = 0;
  PyObject *nwf_capi = Py_None;
  int *idx = NULL;
  npy_intp idx_Dims[1] = {-1};
  const int idx_Rank = 1;
  PyArrayObject *capi_idx_tmp = NULL;
  int capi_idx_intent = 0;
  double *eig = NULL;
  npy_intp eig_Dims[1] = {-1};
  const int eig_Rank = 1;
  PyArrayObject *capi_eig_tmp = NULL;
  int capi_eig_intent = 0;
  float *state = NULL;
  npy_intp state_Dims[2] = {-1, -1};
  const int state_Rank = 2;
  PyArrayObject *capi_state_tmp = NULL;
  int capi_state_intent = 0;
  static char *capi_kwlist[] = {"fname","ispin","ik","no_u","nwf",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_wfsx_index_1",\
    capi_kwlist,&fname_capi,&ispin_capi,&ik_capi,&no_u_capi,&nwf_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_wfsx_index_1 to C string");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_wfsx_index_1() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.read_wfsx_index_1() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_wfsx_index_1() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nwf */
    f2py_success = int_from_pyobj(&nwf,nwf_capi,"_siesta.read_wfsx_index_1() 5th argument (nwf) can't be converted to int");
  if (f2py_success) {
  /* Processing variable idx */
  idx_Dims[0]=nwf;
  capi_idx_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_idx_tmp = array_from_pyobj(NPY_INT,idx_Dims,idx_Rank,capi_idx_intent,Py_None);
  if (capi_idx_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `idx' of _siesta.read_wfsx_index_1 to C/Fortran array" );
  } else {
    idx = (int *)(PyArray_DATA(capi_idx_tmp));

  /* Processing variable eig */
  eig_Dims[0]=nwf;
  capi_eig_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_eig_tmp = array_from_pyobj(NPY_DOUBLE,eig_Dims,eig_Rank,capi_eig_intent,Py_None);
  if (capi_eig_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `eig' of _siesta.read_wfsx_index_1 to C/Fortran array" );
  } else {
    eig = (double *)(PyArray_DATA(capi_eig_tmp));

  /* Processing variable state */
  state_Dims[0]=no_u,state_Dims[1]=nwf;
  capi_state_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_state_tmp = array_from_pyobj(NPY_FLOAT,state_Dims,state_Rank,capi_state_intent,Py_None);
  if (capi_state_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `state' of _siesta.read_wfsx_index_1 to C/Fortran array" );
  } else {
    state = (float *)(PyArray_DATA(capi_state_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ispin,&ik,&no_u,&nwf,idx,eig,state,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_idx_tmp,capi_eig_tmp,capi_state_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_state_tmp == NULL) ... else of state*/
  /* End of cleaning variable state */
  }  /*if (capi_eig_tmp == NULL) ... else of eig*/
  /* End of cleaning variable eig */
  }  /*if (capi_idx_tmp == NULL) ... else of idx*/
  /* End of cleaning variable idx */
  } /*if (f2py_success) of nwf*/
  /* End of cleaning variable nwf */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************** end of read_wfsx_index_1 **************************/

/***************************** read_wfsx_index_2 *****************************/
static char doc_f2py_rout__siesta_read_wfsx_index_2[] = "\
idx,eig,state = read_wfsx_index_2(fname,ispin,ik,no_u,nwf)\n\nWrapper for ``read_wfsx_index_2``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"ispin : input int\n"
"ik : input int\n"
"no_u : input int\n"
"nwf : input int\n"
"\nReturns\n-------\n"
"idx : rank-1 array('i') with bounds (nwf)\n"
"eig : rank-1 array('d') with bounds (nwf)\n"
"state : rank-2 array('F') with bounds (no_u,nwf)";
/* extern void F_FUNC_US(read_wfsx_index_2,READ_WFSX_INDEX_2)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t); */
static PyObject *f2py_rout__siesta_read_wfsx_index_2(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nwf = 0;
  PyObject *nwf_capi = Py_None;
  int *idx = NULL;
  npy_intp idx_Dims[1] = {-1};
  const int idx_Rank = 1;
  PyArrayObject *capi_idx_tmp = NULL;
  int capi_idx_intent = 0;
  double *eig = NULL;
  npy_intp eig_Dims[1] = {-1};
  const int eig_Rank = 1;
  PyArrayObject *capi_eig_tmp = NULL;
  int capi_eig_intent = 0;
  complex_float *state = NULL;
  npy_intp state_Dims[2] = {-1, -1};
  const int state_Rank = 2;
  PyArrayObject *capi_state_tmp = NULL;
  int capi_state_intent = 0;
  static char *capi_kwlist[] = {"fname","ispin","ik","no_u","nwf",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_wfsx_index_2",\
    capi_kwlist,&fname_capi,&ispin_capi,&ik_capi,&no_u_capi,&nwf_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_wfsx_index_2 to C string");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_wfsx_index_2() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.read_wfsx_index_2() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_wfsx_index_2() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nwf */
    f2py_success = int_from_pyobj(&nwf,nwf_capi,"_siesta.read_wfsx_index_2() 5th argument (nwf) can't be converted to int");
  if (f2py_success) {
  /* Processing variable idx */
  idx_Dims[0]=nwf;
  capi_idx_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_idx_tmp = array_from_pyobj(NPY_INT,idx_Dims,idx_Rank,capi_idx_intent,Py_None);
  if (capi_idx_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `idx' of _siesta.read_wfsx_index_2 to C/Fortran array" );
  } else {
    idx = (int *)(PyArray_DATA(capi_idx_tmp));

  /* Processing variable eig */
  eig_Dims[0]=nwf;
  capi_eig_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_eig_tmp = array_from_pyobj(NPY_DOUBLE,eig_Dims,eig_Rank,capi_eig_intent,Py_None);
  if (capi_eig_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `eig' of _siesta.read_wfsx_index_2 to C/Fortran array" );
  } else {
    eig = (double *)(PyArray_DATA(capi_eig_tmp));

  /* Processing variable state */
  state_Dims[0]=no_u,state_Dims[1]=nwf;
  capi_state_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_state_tmp = array_from_pyobj(NPY_CFLOAT,state_Dims,state_Rank,capi_state_intent,Py_None);
  if (capi_state_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `state' of _siesta.read_wfsx_index_2 to C/Fortran array" );
  } else {
    state = (complex_float *)(PyArray_DATA(capi_state_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ispin,&ik,&no_u,&nwf,idx,eig,state,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_idx_tmp,capi_eig_tmp,capi_state_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_state_tmp == NULL) ... else of state*/
  /* End of cleaning variable state */
  }  /*if (capi_eig_tmp == NULL) ... else of eig*/
  /* End of cleaning variable eig */
  }  /*if (capi_idx_tmp == NULL) ... else of idx*/
  /* End of cleaning variable idx */
  } /*if (f2py_success) of nwf*/
  /* End of cleaning variable nwf */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************** end of read_wfsx_index_2 **************************/

/***************************** read_wfsx_index_4 *****************************/
static char doc_f2py_rout__siesta_read_wfsx_index_4[] = "\
idx,eig,state = read_wfsx_index_4(fname,ispin,ik,no_u,nwf)\n\nWrapper for ``read_wfsx_index_4``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"ispin : input int\n"
"ik : input int\n"
"no_u : input int\n"
"nwf : input int\n"
"\nReturns\n-------\n"
"idx : rank-1 array('i') with bounds (nwf)\n"
"eig : rank-1 array('d') with bounds (nwf)\n"
"state : rank-2 array('F') with bounds (2 * no_u,nwf)";
/* extern void F_FUNC_US(read_wfsx_index_4,READ_WFSX_INDEX_4)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t); */
static PyObject *f2py_rout__siesta_read_wfsx_index_4(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,int*,int*,int*,int*,double*,complex_float*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int ispin = 0;
  PyObject *ispin_capi = Py_None;
  int ik = 0;
  PyObject *ik_capi = Py_None;
  int no_u = 0;
  PyObject *no_u_capi = Py_None;
  int nwf = 0;
  PyObject *nwf_capi = Py_None;
  int *idx = NULL;
  npy_intp idx_Dims[1] = {-1};
  const int idx_Rank = 1;
  PyArrayObject *capi_idx_tmp = NULL;
  int capi_idx_intent = 0;
  double *eig = NULL;
  npy_intp eig_Dims[1] = {-1};
  const int eig_Rank = 1;
  PyArrayObject *capi_eig_tmp = NULL;
  int capi_eig_intent = 0;
  complex_float *state = NULL;
  npy_intp state_Dims[2] = {-1, -1};
  const int state_Rank = 2;
  PyArrayObject *capi_state_tmp = NULL;
  int capi_state_intent = 0;
  static char *capi_kwlist[] = {"fname","ispin","ik","no_u","nwf",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOOO:_siesta.read_wfsx_index_4",\
    capi_kwlist,&fname_capi,&ispin_capi,&ik_capi,&no_u_capi,&nwf_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.read_wfsx_index_4 to C string");
  if (f2py_success) {
  /* Processing variable ispin */
    f2py_success = int_from_pyobj(&ispin,ispin_capi,"_siesta.read_wfsx_index_4() 2nd argument (ispin) can't be converted to int");
  if (f2py_success) {
  /* Processing variable ik */
    f2py_success = int_from_pyobj(&ik,ik_capi,"_siesta.read_wfsx_index_4() 3rd argument (ik) can't be converted to int");
  if (f2py_success) {
  /* Processing variable no_u */
    f2py_success = int_from_pyobj(&no_u,no_u_capi,"_siesta.read_wfsx_index_4() 4th argument (no_u) can't be converted to int");
  if (f2py_success) {
  /* Processing variable nwf */
    f2py_success = int_from_pyobj(&nwf,nwf_capi,"_siesta.read_wfsx_index_4() 5th argument (nwf) can't be converted to int");
  if (f2py_success) {
  /* Processing variable idx */
  idx_Dims[0]=nwf;
  capi_idx_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_idx_tmp = array_from_pyobj(NPY_INT,idx_Dims,idx_Rank,capi_idx_intent,Py_None);
  if (capi_idx_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `idx' of _siesta.read_wfsx_index_4 to C/Fortran array" );
  } else {
    idx = (int *)(PyArray_DATA(capi_idx_tmp));

  /* Processing variable eig */
  eig_Dims[0]=nwf;
  capi_eig_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_eig_tmp = array_from_pyobj(NPY_DOUBLE,eig_Dims,eig_Rank,capi_eig_intent,Py_None);
  if (capi_eig_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `eig' of _siesta.read_wfsx_index_4 to C/Fortran array" );
  } else {
    eig = (double *)(PyArray_DATA(capi_eig_tmp));

  /* Processing variable state */
  state_Dims[0]=2 * no_u,state_Dims[1]=nwf;
  capi_state_intent |= F2PY_INTENT_OUT|F2PY_INTENT_HIDE;
  capi_state_tmp = array_from_pyobj(NPY_CFLOAT,state_Dims,state_Rank,capi_state_intent,Py_None);
  if (capi_state_tmp == NULL) {
    if (!PyErr_Occurred())
      PyErr_SetString(_siesta_error,"failed in converting hidden `state' of _siesta.read_wfsx_index_4 to C/Fortran array" );
  } else {
    state = (complex_float *)(PyArray_DATA(capi_state_tmp));

/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&ispin,&ik,&no_u,&nwf,idx,eig,state,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("NNN",capi_idx_tmp,capi_eig_tmp,capi_state_tmp);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  }  /*if (capi_state_tmp == NULL) ... else of state*/
  /* End of cleaning variable state */
  }  /*if (capi_eig_tmp == NULL) ... else of eig*/
  /* End of cleaning variable eig */
  }  /*if (capi_idx_tmp == NULL) ... else of idx*/
  /* End of cleaning variable idx */
  } /*if (f2py_success) of nwf*/
  /* End of cleaning variable nwf */
  } /*if (f2py_success) of no_u*/
  /* End of cleaning variable no_u */
  } /*if (f2py_success) of ik*/
  /* End of cleaning variable ik */
  } /*if (f2py_success) of ispin*/
  /* End of cleaning variable ispin */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/************************** end of read_wfsx_index_4 **************************/

/********************************* open_file *********************************/
static char doc_f2py_rout__siesta_io_m_open_file[] = "\
unit = open_file(file,action,status,form)\n\nWrapper for ``open_file``.\
\n\nParameters\n----------\n"
"file : input string(len=-1)\n"
"action : input string(len=-1)\n"
"status : input string(len=-1)\n"
"form : input string(len=-1)\n"
"\nReturns\n-------\n"
"unit : int";
/*  */
static PyObject *f2py_rout__siesta_io_m_open_file(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,string,string,string,int*,size_t,size_t,size_t,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string file = NULL;
  int slen(file);
  PyObject *file_capi = Py_None;
  string action = NULL;
  int slen(action);
  PyObject *action_capi = Py_None;
  string status = NULL;
  int slen(status);
  PyObject *status_capi = Py_None;
  string form = NULL;
  int slen(form);
  PyObject *form_capi = Py_None;
  int unit = 0;
  static char *capi_kwlist[] = {"file","action","status","form",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "OOOO:_siesta.io_m.open_file",\
    capi_kwlist,&file_capi,&action_capi,&status_capi,&form_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable file */
  slen(file) = -1;
  f2py_success = string_from_pyobj(&file,&slen(file),"",file_capi,"string_from_pyobj failed in converting 1st argument `file' of _siesta.io_m.open_file to C string");
  if (f2py_success) {
  /* Processing variable action */
  slen(action) = -1;
  f2py_success = string_from_pyobj(&action,&slen(action),"",action_capi,"string_from_pyobj failed in converting 2nd argument `action' of _siesta.io_m.open_file to C string");
  if (f2py_success) {
  /* Processing variable status */
  slen(status) = -1;
  f2py_success = string_from_pyobj(&status,&slen(status),"",status_capi,"string_from_pyobj failed in converting 3rd argument `status' of _siesta.io_m.open_file to C string");
  if (f2py_success) {
  /* Processing variable form */
  slen(form) = -1;
  f2py_success = string_from_pyobj(&form,&slen(form),"",form_capi,"string_from_pyobj failed in converting 4th argument `form' of _siesta.io_m.open_file to C string");
  if (f2py_success) {
  /* Processing variable unit */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(file,action,status,form,&unit,slen(file),slen(action),slen(status),slen(form));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",unit);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable unit */
    STRINGFREE(form);
  }  /*if (f2py_success) of form*/
  /* End of cleaning variable form */
    STRINGFREE(status);
  }  /*if (f2py_success) of status*/
  /* End of cleaning variable status */
    STRINGFREE(action);
  }  /*if (f2py_success) of action*/
  /* End of cleaning variable action */
    STRINGFREE(file);
  }  /*if (f2py_success) of file*/
  /* End of cleaning variable file */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/****************************** end of open_file ******************************/

/********************************* close_file *********************************/
static char doc_f2py_rout__siesta_io_m_close_file[] = "\
close_file(iu)\n\nWrapper for ``close_file``.\
\n\nParameters\n----------\n"
"iu : input int";
/*  */
static PyObject *f2py_rout__siesta_io_m_close_file(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  static char *capi_kwlist[] = {"iu",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.io_m.close_file",\
    capi_kwlist,&iu_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.io_m.close_file() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of close_file *****************************/

/******************************* open_file_read *******************************/
static char doc_f2py_rout__siesta_io_m_open_file_read[] = "\
iu = open_file_read(fname)\n\nWrapper for ``open_file_read``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"iu : int";
/*  */
static PyObject *f2py_rout__siesta_io_m_open_file_read(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int iu = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.io_m.open_file_read",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.io_m.open_file_read to C string");
  if (f2py_success) {
  /* Processing variable iu */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&iu,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",iu);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable iu */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of open_file_read ***************************/

/****************************** open_file_write ******************************/
static char doc_f2py_rout__siesta_io_m_open_file_write[] = "\
iu = open_file_write(fname)\n\nWrapper for ``open_file_write``.\
\n\nParameters\n----------\n"
"fname : input string(len=-1)\n"
"\nReturns\n-------\n"
"iu : int";
/*  */
static PyObject *f2py_rout__siesta_io_m_open_file_write(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(string,int*,size_t)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  string fname = NULL;
  int slen(fname);
  PyObject *fname_capi = Py_None;
  int iu = 0;
  static char *capi_kwlist[] = {"fname",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.io_m.open_file_write",\
    capi_kwlist,&fname_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable fname */
  slen(fname) = -1;
  f2py_success = string_from_pyobj(&fname,&slen(fname),"",fname_capi,"string_from_pyobj failed in converting 1st argument `fname' of _siesta.io_m.open_file_write to C string");
  if (f2py_success) {
  /* Processing variable iu */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(fname,&iu,slen(fname));
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",iu);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable iu */
    STRINGFREE(fname);
  }  /*if (f2py_success) of fname*/
  /* End of cleaning variable fname */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/*************************** end of open_file_write ***************************/

/******************************** rewind_file ********************************/
static char doc_f2py_rout__siesta_io_m_rewind_file[] = "\
rewind_file(iu)\n\nWrapper for ``rewind_file``.\
\n\nParameters\n----------\n"
"iu : input int";
/*  */
static PyObject *f2py_rout__siesta_io_m_rewind_file(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iu = 0;
  PyObject *iu_capi = Py_None;
  static char *capi_kwlist[] = {"iu",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.io_m.rewind_file",\
    capi_kwlist,&iu_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iu */
    f2py_success = int_from_pyobj(&iu,iu_capi,"_siesta.io_m.rewind_file() 1st argument (iu) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iu);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of iu*/
  /* End of cleaning variable iu */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/***************************** end of rewind_file *****************************/

/******************************** iostat_reset ********************************/
static char doc_f2py_rout__siesta_io_m_iostat_reset[] = "\
iostat_reset()\n\nWrapper for ``iostat_reset``.\
\n";
/*  */
static PyObject *f2py_rout__siesta_io_m_iostat_reset(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(void)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  static char *capi_kwlist[] = {NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    ":_siesta.io_m.iostat_reset",\
    capi_kwlist))
    return NULL;
/*frompyobj*/
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)();
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("");
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of iostat_reset ****************************/

/******************************* iostat_update *******************************/
static char doc_f2py_rout__siesta_io_m_iostat_update[] = "\
iostat = iostat_update(iostat)\n\nWrapper for ``iostat_update``.\
\n\nParameters\n----------\n"
"iostat : input int\n"
"\nReturns\n-------\n"
"iostat : int";
/*  */
static PyObject *f2py_rout__siesta_io_m_iostat_update(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iostat = 0;
  PyObject *iostat_capi = Py_None;
  static char *capi_kwlist[] = {"iostat",NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    "O:_siesta.io_m.iostat_update",\
    capi_kwlist,&iostat_capi))
    return NULL;
/*frompyobj*/
  /* Processing variable iostat */
    f2py_success = int_from_pyobj(&iostat,iostat_capi,"_siesta.io_m.iostat_update() 1st argument (iostat) can't be converted to int");
  if (f2py_success) {
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iostat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",iostat);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  } /*if (f2py_success) of iostat*/
  /* End of cleaning variable iostat */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of iostat_update ****************************/

/******************************** iostat_query ********************************/
static char doc_f2py_rout__siesta_io_m_iostat_query[] = "\
iostat = iostat_query()\n\nWrapper for ``iostat_query``.\
\n\nReturns\n-------\n"
"iostat : int";
/*  */
static PyObject *f2py_rout__siesta_io_m_iostat_query(const PyObject *capi_self,
                           PyObject *capi_args,
                           PyObject *capi_keywds,
                           void (*f2py_func)(int*)) {
  PyObject * volatile capi_buildvalue = NULL;
  volatile int f2py_success = 1;
/*decl*/

  int iostat = 0;
  static char *capi_kwlist[] = {NULL};

/*routdebugenter*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_clock();
#endif
  if (!PyArg_ParseTupleAndKeywords(capi_args,capi_keywds,\
    ":_siesta.io_m.iostat_query",\
    capi_kwlist))
    return NULL;
/*frompyobj*/
  /* Processing variable iostat */
/*end of frompyobj*/
#ifdef F2PY_REPORT_ATEXIT
f2py_start_call_clock();
#endif
/*callfortranroutine*/
        (*f2py_func)(&iostat);
if (PyErr_Occurred())
  f2py_success = 0;
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_call_clock();
#endif
/*end of callfortranroutine*/
    if (f2py_success) {
/*pyobjfrom*/
/*end of pyobjfrom*/
    CFUNCSMESS("Building return value.\n");
    capi_buildvalue = Py_BuildValue("i",iostat);
/*closepyobjfrom*/
/*end of closepyobjfrom*/
    } /*if (f2py_success) after callfortranroutine*/
/*cleanupfrompyobj*/
  /* End of cleaning variable iostat */
/*end of cleanupfrompyobj*/
  if (capi_buildvalue == NULL) {
/*routdebugfailure*/
  } else {
/*routdebugleave*/
  }
  CFUNCSMESS("Freeing memory.\n");
/*freemem*/
#ifdef F2PY_REPORT_ATEXIT
f2py_stop_clock();
#endif
  return capi_buildvalue;
}
/**************************** end of iostat_query ****************************/
/*eof body*/

/******************* See f2py2e/f90mod_rules.py: buildhooks *******************/

static FortranDataDef f2py_io_m_def[] = {
  {"open_file",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_open_file,doc_f2py_rout__siesta_io_m_open_file},
  {"close_file",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_close_file,doc_f2py_rout__siesta_io_m_close_file},
  {"open_file_read",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_open_file_read,doc_f2py_rout__siesta_io_m_open_file_read},
  {"open_file_write",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_open_file_write,doc_f2py_rout__siesta_io_m_open_file_write},
  {"rewind_file",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_rewind_file,doc_f2py_rout__siesta_io_m_rewind_file},
  {"iostat_reset",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_iostat_reset,doc_f2py_rout__siesta_io_m_iostat_reset},
  {"iostat_update",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_iostat_update,doc_f2py_rout__siesta_io_m_iostat_update},
  {"iostat_query",-1,{{-1}},0,NULL,(void *)f2py_rout__siesta_io_m_iostat_query,doc_f2py_rout__siesta_io_m_iostat_query},
  {NULL}
};

static void f2py_setup_io_m(char *open_file,char *close_file,char *open_file_read,char *open_file_write,char *rewind_file,char *iostat_reset,char *iostat_update,char *iostat_query) {
  int i_f2py=0;
  f2py_io_m_def[i_f2py++].data = open_file;
  f2py_io_m_def[i_f2py++].data = close_file;
  f2py_io_m_def[i_f2py++].data = open_file_read;
  f2py_io_m_def[i_f2py++].data = open_file_write;
  f2py_io_m_def[i_f2py++].data = rewind_file;
  f2py_io_m_def[i_f2py++].data = iostat_reset;
  f2py_io_m_def[i_f2py++].data = iostat_update;
  f2py_io_m_def[i_f2py++].data = iostat_query;
}
extern void F_FUNC_US(f2pyinitio_m,F2PYINITIO_M)(void (*)(char *,char *,char *,char *,char *,char *,char *,char *));
static void f2py_init_io_m(void) {
  F_FUNC_US(f2pyinitio_m,F2PYINITIO_M)(f2py_setup_io_m);
}

/*need_f90modhooks*/

/************** See f2py2e/rules.py: module_rules['modulebody'] **************/

/******************* See f2py2e/common_rules.py: buildhooks *******************/

/*need_commonhooks*/

/**************************** See f2py2e/rules.py ****************************/

static FortranDataDef f2py_routine_defs[] = {
  {"siesta_sc_off",-1,{{-1}},0,(char *)F_FUNC_US(siesta_sc_off,SIESTA_SC_OFF),(f2py_init_func)f2py_rout__siesta_siesta_sc_off,doc_f2py_rout__siesta_siesta_sc_off},
  {"read_hsx_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_hsx_sizes,READ_HSX_SIZES),(f2py_init_func)f2py_rout__siesta_read_hsx_sizes,doc_f2py_rout__siesta_read_hsx_sizes},
  {"read_hsx_hsx",-1,{{-1}},0,(char *)F_FUNC_US(read_hsx_hsx,READ_HSX_HSX),(f2py_init_func)f2py_rout__siesta_read_hsx_hsx,doc_f2py_rout__siesta_read_hsx_hsx},
  {"read_hsx_s",-1,{{-1}},0,(char *)F_FUNC_US(read_hsx_s,READ_HSX_S),(f2py_init_func)f2py_rout__siesta_read_hsx_s,doc_f2py_rout__siesta_read_hsx_s},
  {"write_hsx",-1,{{-1}},0,(char *)F_FUNC_US(write_hsx,WRITE_HSX),(f2py_init_func)f2py_rout__siesta_write_hsx,doc_f2py_rout__siesta_write_hsx},
  {"read_dm_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_dm_sizes,READ_DM_SIZES),(f2py_init_func)f2py_rout__siesta_read_dm_sizes,doc_f2py_rout__siesta_read_dm_sizes},
  {"read_dm",-1,{{-1}},0,(char *)F_FUNC_US(read_dm,READ_DM),(f2py_init_func)f2py_rout__siesta_read_dm,doc_f2py_rout__siesta_read_dm},
  {"write_dm",-1,{{-1}},0,(char *)F_FUNC_US(write_dm,WRITE_DM),(f2py_init_func)f2py_rout__siesta_write_dm,doc_f2py_rout__siesta_write_dm},
  {"read_tshs_version",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_version,READ_TSHS_VERSION),(f2py_init_func)f2py_rout__siesta_read_tshs_version,doc_f2py_rout__siesta_read_tshs_version},
  {"read_tshs_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_sizes,READ_TSHS_SIZES),(f2py_init_func)f2py_rout__siesta_read_tshs_sizes,doc_f2py_rout__siesta_read_tshs_sizes},
  {"read_tshs_ef",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_ef,READ_TSHS_EF),(f2py_init_func)f2py_rout__siesta_read_tshs_ef,doc_f2py_rout__siesta_read_tshs_ef},
  {"read_tshs_cell",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_cell,READ_TSHS_CELL),(f2py_init_func)f2py_rout__siesta_read_tshs_cell,doc_f2py_rout__siesta_read_tshs_cell},
  {"read_tshs_geom",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_geom,READ_TSHS_GEOM),(f2py_init_func)f2py_rout__siesta_read_tshs_geom,doc_f2py_rout__siesta_read_tshs_geom},
  {"read_tshs_hs",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_hs,READ_TSHS_HS),(f2py_init_func)f2py_rout__siesta_read_tshs_hs,doc_f2py_rout__siesta_read_tshs_hs},
  {"read_tshs_s",-1,{{-1}},0,(char *)F_FUNC_US(read_tshs_s,READ_TSHS_S),(f2py_init_func)f2py_rout__siesta_read_tshs_s,doc_f2py_rout__siesta_read_tshs_s},
  {"write_tshs_hs",-1,{{-1}},0,(char *)F_FUNC_US(write_tshs_hs,WRITE_TSHS_HS),(f2py_init_func)f2py_rout__siesta_write_tshs_hs,doc_f2py_rout__siesta_write_tshs_hs},
  {"read_grid_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_grid_sizes,READ_GRID_SIZES),(f2py_init_func)f2py_rout__siesta_read_grid_sizes,doc_f2py_rout__siesta_read_grid_sizes},
  {"read_grid_cell",-1,{{-1}},0,(char *)F_FUNC_US(read_grid_cell,READ_GRID_CELL),(f2py_init_func)f2py_rout__siesta_read_grid_cell,doc_f2py_rout__siesta_read_grid_cell},
  {"read_grid",-1,{{-1}},0,(char *)F_FUNC_US(read_grid,READ_GRID),(f2py_init_func)f2py_rout__siesta_read_grid,doc_f2py_rout__siesta_read_grid},
  {"write_grid",-1,{{-1}},0,(char *)F_FUNC_US(write_grid,WRITE_GRID),(f2py_init_func)f2py_rout__siesta_write_grid,doc_f2py_rout__siesta_write_grid},
  {"read_gf_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_gf_sizes,READ_GF_SIZES),(f2py_init_func)f2py_rout__siesta_read_gf_sizes,doc_f2py_rout__siesta_read_gf_sizes},
  {"read_gf_header",-1,{{-1}},0,(char *)F_FUNC_US(read_gf_header,READ_GF_HEADER),(f2py_init_func)f2py_rout__siesta_read_gf_header,doc_f2py_rout__siesta_read_gf_header},
  {"read_gf_find",-1,{{-1}},0,(char *)F_FUNC_US(read_gf_find,READ_GF_FIND),(f2py_init_func)f2py_rout__siesta_read_gf_find,doc_f2py_rout__siesta_read_gf_find},
  {"read_gf_hs",-1,{{-1}},0,(char *)F_FUNC_US(read_gf_hs,READ_GF_HS),(f2py_init_func)f2py_rout__siesta_read_gf_hs,doc_f2py_rout__siesta_read_gf_hs},
  {"read_gf_se",-1,{{-1}},0,(char *)F_FUNC_US(read_gf_se,READ_GF_SE),(f2py_init_func)f2py_rout__siesta_read_gf_se,doc_f2py_rout__siesta_read_gf_se},
  {"write_gf_header",-1,{{-1}},0,(char *)F_FUNC_US(write_gf_header,WRITE_GF_HEADER),(f2py_init_func)f2py_rout__siesta_write_gf_header,doc_f2py_rout__siesta_write_gf_header},
  {"write_gf_hs",-1,{{-1}},0,(char *)F_FUNC_US(write_gf_hs,WRITE_GF_HS),(f2py_init_func)f2py_rout__siesta_write_gf_hs,doc_f2py_rout__siesta_write_gf_hs},
  {"write_gf_se",-1,{{-1}},0,(char *)F_FUNC_US(write_gf_se,WRITE_GF_SE),(f2py_init_func)f2py_rout__siesta_write_gf_se,doc_f2py_rout__siesta_write_gf_se},
  {"read_tsde_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_tsde_sizes,READ_TSDE_SIZES),(f2py_init_func)f2py_rout__siesta_read_tsde_sizes,doc_f2py_rout__siesta_read_tsde_sizes},
  {"read_tsde_dm",-1,{{-1}},0,(char *)F_FUNC_US(read_tsde_dm,READ_TSDE_DM),(f2py_init_func)f2py_rout__siesta_read_tsde_dm,doc_f2py_rout__siesta_read_tsde_dm},
  {"read_tsde_ef",-1,{{-1}},0,(char *)F_FUNC_US(read_tsde_ef,READ_TSDE_EF),(f2py_init_func)f2py_rout__siesta_read_tsde_ef,doc_f2py_rout__siesta_read_tsde_ef},
  {"read_tsde_edm",-1,{{-1}},0,(char *)F_FUNC_US(read_tsde_edm,READ_TSDE_EDM),(f2py_init_func)f2py_rout__siesta_read_tsde_edm,doc_f2py_rout__siesta_read_tsde_edm},
  {"write_tsde_dm_edm",-1,{{-1}},0,(char *)F_FUNC_US(write_tsde_dm_edm,WRITE_TSDE_DM_EDM),(f2py_init_func)f2py_rout__siesta_write_tsde_dm_edm,doc_f2py_rout__siesta_write_tsde_dm_edm},
  {"read_hs_header",-1,{{-1}},0,(char *)F_FUNC_US(read_hs_header,READ_HS_HEADER),(f2py_init_func)f2py_rout__siesta_read_hs_header,doc_f2py_rout__siesta_read_hs_header},
  {"read_hs",-1,{{-1}},0,(char *)F_FUNC_US(read_hs,READ_HS),(f2py_init_func)f2py_rout__siesta_read_hs,doc_f2py_rout__siesta_read_hs},
  {"read_wfsx_sizes",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_sizes,READ_WFSX_SIZES),(f2py_init_func)f2py_rout__siesta_read_wfsx_sizes,doc_f2py_rout__siesta_read_wfsx_sizes},
  {"read_wfsx_index_info",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_index_info,READ_WFSX_INDEX_INFO),(f2py_init_func)f2py_rout__siesta_read_wfsx_index_info,doc_f2py_rout__siesta_read_wfsx_index_info},
  {"skip_wfsx_index",-1,{{-1}},0,(char *)F_FUNC_US(skip_wfsx_index,SKIP_WFSX_INDEX),(f2py_init_func)f2py_rout__siesta_skip_wfsx_index,doc_f2py_rout__siesta_skip_wfsx_index},
  {"read_wfsx_index_check",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_index_check,READ_WFSX_INDEX_CHECK),(f2py_init_func)f2py_rout__siesta_read_wfsx_index_check,doc_f2py_rout__siesta_read_wfsx_index_check},
  {"read_wfsx_index_1",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_index_1,READ_WFSX_INDEX_1),(f2py_init_func)f2py_rout__siesta_read_wfsx_index_1,doc_f2py_rout__siesta_read_wfsx_index_1},
  {"read_wfsx_index_2",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_index_2,READ_WFSX_INDEX_2),(f2py_init_func)f2py_rout__siesta_read_wfsx_index_2,doc_f2py_rout__siesta_read_wfsx_index_2},
  {"read_wfsx_index_4",-1,{{-1}},0,(char *)F_FUNC_US(read_wfsx_index_4,READ_WFSX_INDEX_4),(f2py_init_func)f2py_rout__siesta_read_wfsx_index_4,doc_f2py_rout__siesta_read_wfsx_index_4},

/*eof routine_defs*/
  {NULL}
};

static PyMethodDef f2py_module_methods[] = {

  {NULL,NULL}
};

#if PY_VERSION_HEX >= 0x03000000
static struct PyModuleDef moduledef = {
  PyModuleDef_HEAD_INIT,
  "_siesta",
  NULL,
  -1,
  f2py_module_methods,
  NULL,
  NULL,
  NULL,
  NULL
};
#endif

#if PY_VERSION_HEX >= 0x03000000
#define RETVAL m
PyMODINIT_FUNC PyInit__siesta(void) {
#else
#define RETVAL
PyMODINIT_FUNC init_siesta(void) {
#endif
  int i;
  PyObject *m,*d, *s, *tmp;
#if PY_VERSION_HEX >= 0x03000000
  m = _siesta_module = PyModule_Create(&moduledef);
#else
  m = _siesta_module = Py_InitModule("_siesta", f2py_module_methods);
#endif
  Py_TYPE(&PyFortran_Type) = &PyType_Type;
  import_array();
  if (PyErr_Occurred())
    {PyErr_SetString(PyExc_ImportError, "can't initialize module _siesta (failed to import numpy)"); return RETVAL;}
  d = PyModule_GetDict(m);
  s = PyString_FromString("$Revision: $");
  PyDict_SetItemString(d, "__version__", s);
#if PY_VERSION_HEX >= 0x03000000
  s = PyUnicode_FromString(
#else
  s = PyString_FromString(
#endif
    "This module '_siesta' is auto-generated with f2py (version:2).\nFunctions:\n"
"  isc = siesta_sc_off(nsa,nsb,nsc)\n"
"  gamma,nspin,no_u,no_s,maxnh = read_hsx_sizes(fname)\n"
"  numh,listh,h,s,xij = read_hsx_hsx(fname,gamma,nspin,no_u,no_s,maxnh)\n"
"  numh,listh,s = read_hsx_s(fname,gamma,nspin,no_u,no_s,maxnh)\n"
"  write_hsx(fname,gamma,no_s,numh,listhptr,listh,h,s,xij,qtot,temp,no_u=len(numh),nspin=shape(h,1),maxnh=len(listh))\n"
"  nspin,no_u,nsc,nnz = read_dm_sizes(fname)\n"
"  ncol,list_col,dm = read_dm(fname,nspin,no_u,nsc,nnz)\n"
"  write_dm(fname,nsc,ncol,list_col,dm,nspin=shape(dm,1),no_u=len(ncol),nnz=len(list_col))\n"
"  version = read_tshs_version(fname)\n"
"  nspin,na_u,no_u,n_s,nnz = read_tshs_sizes(fname)\n"
"  ef = read_tshs_ef(fname)\n"
"  nsc,cell,isc = read_tshs_cell(fname,n_s)\n"
"  xa,lasto = read_tshs_geom(fname,na_u)\n"
"  ncol,list_col,h,s = read_tshs_hs(fname,nspin,no_u,nnz)\n"
"  ncol,list_col,s = read_tshs_s(fname,no_u,nnz)\n"
"  write_tshs_hs(fname,nsc1,nsc2,nsc3,cell,xa,lasto,ncol,list_col,h,s,isc,nspin=shape(h,1),na_u=shape(xa,1),no_u=len(ncol),nnz=len(list_col))\n"
"  nspin,mesh = read_grid_sizes(fname)\n"
"  cell = read_grid_cell(fname)\n"
"  grid = read_grid(fname,nspin,mesh1,mesh2,mesh3)\n"
"  write_grid(fname,nspin,cell,grid,mesh1=shape(grid,0),mesh2=shape(grid,1),mesh3=shape(grid,2))\n"
"  nspin,no_u,nkpt,ne = read_gf_sizes(iu)\n"
"  kpt,e = read_gf_header(iu,nkpt,ne)\n"
"  read_gf_find(iu,nspin,nkpt,ne,cstate,cspin,ckpt,ce,cis_read,istate,ispin,ikpt,ie)\n"
"  h,s = read_gf_hs(iu,no_u)\n"
"  se = read_gf_se(iu,no_u,ie)\n"
"  write_gf_header(iu,nspin,cell,na_u,no_u,no_used,xa_used,lasto_used,bloch,pre_expand,mu,kpt,kw,e,na_used=shape(xa_used,1),nkpt=shape(kpt,1),ne=len(e))\n"
"  write_gf_hs(iu,ik,e,h,s,no_u=shape(h,0))\n"
"  write_gf_se(iu,ik,ie,e,se,no_u=shape(se,0))\n"
"  nspin,no_u,nsc,nnz = read_tsde_sizes(fname)\n"
"  ncol,list_col,dm = read_tsde_dm(fname,nspin,no_u,nsc,nnz)\n"
"  ef = read_tsde_ef(fname)\n"
"  ncol,list_col,edm = read_tsde_edm(fname,nspin,no_u,nsc,nnz)\n"
"  write_tsde_dm_edm(fname,nsc,ncol,list_col,dm,edm,ef,nspin=shape(dm,1),no_u=len(ncol),nnz=len(list_col))\n"
"  gamma,nspin,no_u,no_s,maxnh = read_hs_header(fname)\n"
"  numh,listhptr,listh,h,s,xij = read_hs(fname,gamma,nspin,no_u,no_s,maxnh)\n"
"  nspin,no_u,nk,gamma = read_wfsx_sizes(fname)\n"
"  k,kw,nwf = read_wfsx_index_info(fname,ispin,ik)\n"
"  skip_wfsx_index(iu,ispin,ik)\n"
"  read_wfsx_index_check(iu,ispin,ik,nwf,fail)\n"
"  idx,eig,state = read_wfsx_index_1(fname,ispin,ik,no_u,nwf)\n"
"  idx,eig,state = read_wfsx_index_2(fname,ispin,ik,no_u,nwf)\n"
"  idx,eig,state = read_wfsx_index_4(fname,ispin,ik,no_u,nwf)\n"
"Fortran 90/95 modules:\n""  io_m --- open_file(),close_file(),open_file_read(),open_file_write(),rewind_file(),iostat_reset(),iostat_update(),iostat_query()"".");
  PyDict_SetItemString(d, "__doc__", s);
  _siesta_error = PyErr_NewException ("_siesta.error", NULL, NULL);
  Py_DECREF(s);
  for(i=0;f2py_routine_defs[i].name!=NULL;i++) {
    tmp = PyFortranObject_NewAsAttr(&f2py_routine_defs[i]);
    PyDict_SetItemString(d, f2py_routine_defs[i].name, tmp);
    Py_DECREF(tmp);
  }


















































/*eof initf2pywraphooks*/
  PyDict_SetItemString(d, "io_m", PyFortranObject_New(f2py_io_m_def,f2py_init_io_m));
/*eof initf90modhooks*/

/*eof initcommonhooks*/


#ifdef F2PY_REPORT_ATEXIT
  if (! PyErr_Occurred())
    on_exit(f2py_report_on_exit,(void*)"_siesta");
#endif

  return RETVAL;
}
#ifdef __cplusplus
}
#endif
